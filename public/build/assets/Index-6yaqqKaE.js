import{d as G,v as U,m as S,p as h,I as J,s as R,W as g,c as f,o as n,w as a,a as i,b as t,u as r,g as K,T as O,x as H,f as m,t as p,G as Q,y as X,h as x,e as u,S as T,F as W,r as D,n as Z}from"./app-6YU8Xi1-.js";import{_ as c}from"./index-D6TYeKc9.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-qWJAS-0A.js";import{_ as k,a as b}from"./CardContent.vue_vue_type_script_setup_true_lang-BAUfZgnO.js";import{_ as $}from"./Icon.vue_vue_type_script_setup_true_lang-3sI8mG8C.js";import{S as y}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-CiBDiogE.js";import"./useForwardPropsEmits-DPtx9DKF.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-RKf3w3T5.js";import"./createLucideIcon-DCdQ-kDs.js";import"./Teleport-C6YKvALf.js";import"./RovingFocusGroup-CohizBQB.js";import"./VisuallyHidden-C0owPaWy.js";import"./x-BWKvW5SF.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-0XVZurPF.js";import"./circle-check-DxrVWMq-.js";import"./chevron-right-glct6d-_.js";import"./square-pen-C1R53Gtc.js";import"./calendar-B43ikrLR.js";import"./check-VbGlEKo-.js";import"./chevron-left-CKiBlpVv.js";import"./circle-alert-pPSrZYt_.js";import"./piggy-bank-c0jYiqwL.js";import"./circle-check-big-DDwSVI9t.js";import"./trophy-BTU5nViD.js";import"./circle-x-D0p3QzY6.js";import"./clock-DLsrY_I0.js";import"./dollar-sign-U1m7DACl.js";import"./eye-off-D6Lv2BUp.js";import"./eye-Cx-rfl_U.js";import"./loader-circle-B-IAuXpe.js";import"./mail-Bq8Xb3D9.js";import"./map-pin-XKYN_KPB.js";import"./message-square-Ch1uhfz1.js";import"./sun-WgkXngFM.js";import"./plus-CorCO1mY.js";import"./printer-CLW_A1GF.js";import"./search-CqU6Tyvj.js";import"./shopping-bag-A_xx6Cu6.js";import"./trash-2-CPxEOpm0.js";import"./trending-up-DobGIh_9.js";import"./user-cog-DaTz2SKl.js";const te={class:"grid grid-cols-1 lg:grid-cols-4 gap-6 mt-8 mb-6"},se={class:"flex items-center justify-between"},oe={class:"text-xl font-bold text-blue-600"},re={class:"flex items-center justify-between"},ne={class:"text-xl font-bold text-green-600"},le={class:"flex items-center justify-between"},ae={class:"text-xl font-bold text-yellow-600"},ie={class:"flex items-center justify-between"},ue={class:"text-xl font-bold text-emerald-600"},de={class:"flex items-center justify-between"},pe={class:"text-xl font-bold text-orange-600"},me={class:"flex items-center justify-between mt-4 mb-2"},fe={class:"flex gap-2 items-center"},ce={key:0,class:"ml-2 bg-white/20 px-2 py-0.5 rounded-full text-xs"},ve={key:0,class:"py-12 text-center"},xe={class:"mx-auto max-w-md"},he={key:1,class:"py-12 text-center"},ge={class:"mx-auto max-w-md"},ye={key:2,class:"min-w-full divide-y divide-border"},_e={key:0,class:"px-4 py-2 text-left"},we={class:"px-4 py-2 font-medium"},ke={key:1},be={class:"px-4 py-2"},Ce={class:"px-4 py-2"},Be={class:"px-4 py-2"},Ae={key:0,class:"px-4 py-2"},je={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800"},Se={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Te={class:"px-4 py-2"},$e={key:0,class:"flex gap-2"},ze={key:1,class:"text-sm text-muted-foreground"},Me={key:3,class:"flex items-center justify-between mt-6"},Ve={class:"text-sm text-gray-700"},Pe={class:"flex items-center gap-1"},Ne={key:1,class:"px-2 text-sm text-muted-foreground"},We={class:"fixed bottom-6 right-6 z-50"},Ee={key:0,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Re={key:1,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},St=G({__name:"Index",setup(He){const o=U(),A=S(o.props.filters?o.props.filters:{}),v=S(typeof A.value.search=="string"?A.value.search:""),_=S(typeof A.value.pending=="boolean"?A.value.pending:!1),C=S(!1),w=h(()=>{var l;return Array.isArray((l=o.props.auth)==null?void 0:l.userRoles)&&o.props.auth.userRoles.includes("Admin")});h(()=>{var l;return Array.isArray((l=o.props.auth)==null?void 0:l.userRoles)&&o.props.auth.userRoles.includes("Staff")&&!w.value});const j=h(()=>w.value),F=[{title:"Customers",href:"/customers"}];J(()=>{v.value=o.props.filters&&typeof o.props.filters.search=="string"?o.props.filters.search:""});let z=null;R(v,l=>{z&&clearTimeout(z),z=setTimeout(()=>{const e=(l??"").toString().trim(),s=o.props.filters&&typeof o.props.filters.search=="string"?o.props.filters.search:"";e!==s&&g.get("/customers",{search:e||void 0,pending:_.value||void 0},{preserveState:!0,replace:!0})},400)}),R(_,l=>{g.get("/customers",{search:v.value||void 0,pending:l||void 0},{preserveState:!0,replace:!0})});function M(l){g.get("/customers",{search:v.value,pending:_.value||void 0,page:l},{preserveState:!0,replace:!0})}async function Y(l){(await y.fire({title:"Approve Customer?",text:`Are you sure you want to approve ${l.name}? They will receive an email notification.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#8f5be8",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, approve",cancelButtonText:"Cancel"})).isConfirmed&&g.post(`/customers/${l.id}/approve`,{},{onSuccess:()=>{y.fire("Customer Approved","The customer has been approved and notified via email.","success")},onError:()=>{const s=o.props.flash,d=(s==null?void 0:s.error)??"Failed to approve customer.";y.fire("Error",d,"error")}})}const E=h(()=>o.props.customers),V=h(()=>E.value.current_page),I=h(()=>E.value.last_page),L=h(()=>{const l=I.value||1,e=V.value||1,s=2,d=[],B=Math.max(1,e-s),P=Math.min(l,e+s);for(let N=B;N<=P;N++)d.push(N);return B>1&&(B>2&&d.unshift("..."),d.unshift(1)),P<l&&(P<l-1&&d.push("..."),d.push(l)),d});async function q(l){(await y.fire({title:"Delete Customer?",text:"Are you sure you want to delete this customer? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#8f5be8",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete customer"})).isConfirmed&&g.delete(`/customers/${l}`,{onSuccess:()=>{const s=o.props.flash;if(s!=null&&s.error){y.fire({title:"Cannot delete",text:s.error,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(d=>{d.isConfirmed&&g.get("/deliveries",{customer_id:l},{preserveState:!0,replace:!0})});return}y.fire("Customer deleted","Customer deleted successfully.","success")},onError:()=>{const s=o.props.flash,d=(s==null?void 0:s.error)??"Cannot delete this customer because there are related records.";y.fire({title:"Cannot delete",text:d,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(B=>{B.isConfirmed&&g.get("/deliveries",{customer_id:l},{preserveState:!0,replace:!0})})}})}return(l,e)=>(n(),f(ee,{breadcrumbs:F},{default:a(()=>[i(r(K),{title:"Customers"}),i(O,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-4","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-4"},{default:a(()=>[H(t("div",te,[i(k,{class:"relative overflow-hidden"},{default:a(()=>[i(b,{class:"p-6"},{default:a(()=>{var s;return[t("div",se,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Total Customers",-1)),t("p",oe,p(((s=r(o).props.stats)==null?void 0:s.totalCustomers)||0),1)]),e[7]||(e[7]=t("div",{class:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})])],-1))])]}),_:1})]),_:1}),i(k,{class:"relative overflow-hidden"},{default:a(()=>[i(b,{class:"p-6"},{default:a(()=>{var s;return[t("div",re,[t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm font-medium text-muted-foreground"},"With Company",-1)),t("p",ne,p(((s=r(o).props.stats)==null?void 0:s.customersWithCompany)||0),1)]),e[9]||(e[9]=t("div",{class:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1))])]}),_:1})]),_:1}),i(k,{class:"relative overflow-hidden"},{default:a(()=>[i(b,{class:"p-6"},{default:a(()=>{var s;return[t("div",le,[t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm font-medium text-muted-foreground"},"With Phone",-1)),t("p",ae,p(((s=r(o).props.stats)==null?void 0:s.customersWithPhone)||0),1)]),e[11]||(e[11]=t("div",{class:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1))])]}),_:1})]),_:1}),i(k,{class:"relative overflow-hidden"},{default:a(()=>[i(b,{class:"p-6"},{default:a(()=>{var s;return[t("div",ie,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Recently Added",-1)),t("p",ue,p(((s=r(o).props.stats)==null?void 0:s.recentlyAdded)||0),1)]),e[13]||(e[13]=t("div",{class:"h-12 w-12 rounded-full bg-emerald-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]}),_:1})]),_:1}),w.value?(n(),f(k,{key:0,class:"relative overflow-hidden"},{default:a(()=>[i(b,{class:"p-6"},{default:a(()=>{var s;return[t("div",de,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Pending Approvals",-1)),t("p",pe,p(((s=r(o).props.stats)==null?void 0:s.pendingApprovals)||0),1)]),e[15]||(e[15]=t("div",{class:"h-12 w-12 rounded-full bg-orange-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]}),_:1})]),_:1})):m("",!0)],512),[[Q,C.value]])]),_:1}),t("div",me,[t("div",fe,[H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"text",placeholder:"Search customers by name, company, or email...",class:"rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[X,v.value]]),w.value?(n(),f(r(c),{key:0,variant:_.value?"default":"outline",onClick:e[1]||(e[1]=s=>_.value=!_.value)},{default:a(()=>{var s,d;return[i($,{name:"Clock",class:"h-4 w-4 mr-2"}),e[16]||(e[16]=x(" Pending Approvals ")),(s=r(o).props.stats)!=null&&s.pendingApprovals?(n(),u("span",ce,p((d=r(o).props.stats)==null?void 0:d.pendingApprovals),1)):m("",!0)]}),_:1,__:[16]},8,["variant"])):m("",!0)]),j.value?(n(),f(r(T),{key:0,href:l.route("customers.create")},{default:a(()=>[i(r(c),{variant:"default"},{default:a(()=>e[17]||(e[17]=[t("span",{class:"mr-2"},"+",-1),x(" Add New Customer ")])),_:1,__:[17]})]),_:1},8,["href"])):m("",!0)]),i(k,null,{default:a(()=>[i(b,null,{default:a(()=>[r(o).props.customers.total===0?(n(),u("div",ve,[t("div",xe,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold mb-2"},"No customers yet",-1)),e[20]||(e[20]=t("p",{class:"text-sm text-muted-foreground mb-6"}," Customers you add will appear here. You can create invoices faster when customers are saved. ",-1)),j.value?(n(),f(r(T),{key:0,href:l.route("customers.create")},{default:a(()=>[i(r(c),{variant:"default"},{default:a(()=>e[18]||(e[18]=[x(" Add your first customer ")])),_:1,__:[18]})]),_:1},8,["href"])):m("",!0)])])):r(o).props.customers.data.length===0&&v.value&&v.value.toString().trim().length?(n(),u("div",he,[t("div",ge,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold mb-2"},"No results found",-1)),e[23]||(e[23]=t("p",{class:"text-sm text-muted-foreground mb-6"}," We couldn't find any customers matching your search. ",-1)),i(r(c),{variant:"outline",onClick:e[2]||(e[2]=s=>v.value="")},{default:a(()=>e[21]||(e[21]=[x(" Clear search ")])),_:1,__:[21]})])])):(n(),u("table",ye,[t("thead",null,[t("tr",null,[e[24]||(e[24]=t("th",{class:"px-4 py-2 text-left"},"Name",-1)),e[25]||(e[25]=t("th",{class:"px-4 py-2 text-left"},"Company",-1)),e[26]||(e[26]=t("th",{class:"px-4 py-2 text-left"},"Email",-1)),e[27]||(e[27]=t("th",{class:"px-4 py-2 text-left"},"Phone",-1)),w.value?(n(),u("th",_e,"Status")):m("",!0),e[28]||(e[28]=t("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),t("tbody",null,[(n(!0),u(W,null,D(r(o).props.customers.data,s=>(n(),u("tr",{key:s.id,class:"hover:bg-muted"},[t("td",we,[j.value?(n(),f(r(T),{key:0,href:l.route("customers.edit",s.id),class:"underline underline-offset-4"},{default:a(()=>[x(p(s.name),1)]),_:2},1032,["href"])):(n(),u("span",ke,p(s.name),1))]),t("td",be,p(s.company_name||"-"),1),t("td",Ce,p(s.email),1),t("td",Be,p(s.phone||"-"),1),w.value?(n(),u("td",Ae,[s.approved_at?(n(),u("span",Se," Approved ")):(n(),u("span",je," Pending Approval "))])):m("",!0),t("td",Te,[j.value?(n(),u("div",$e,[s.approved_at?m("",!0):(n(),f(r(c),{key:0,variant:"default",size:"sm",onClick:d=>Y(s),class:"bg-green-600 hover:bg-green-700"},{default:a(()=>[i($,{name:"Check",class:"h-4 w-4 mr-1"}),e[29]||(e[29]=x(" Approve "))]),_:2,__:[29]},1032,["onClick"])),i(r(T),{href:l.route("customers.edit",s.id)},{default:a(()=>[i(r(c),{variant:"ghost",size:"sm"},{default:a(()=>[i($,{name:"edit",class:"h-4 w-4"})]),_:1})]),_:2},1032,["href"]),i(r(c),{variant:"ghost",size:"sm",onClick:d=>q(s.id)},{default:a(()=>[i($,{name:"trash",class:"h-4 w-4"})]),_:2},1032,["onClick"])])):(n(),u("span",ze,"View only"))])]))),128))])])),r(o).props.customers.last_page>1?(n(),u("div",Me,[t("div",Ve," Showing "+p(r(o).props.customers.from)+" to "+p(r(o).props.customers.to)+" of "+p(r(o).props.customers.total)+" results ",1),t("div",Pe,[r(o).props.customers.prev_page_url?(n(),f(r(c),{key:0,variant:"outline",size:"sm",onClick:e[3]||(e[3]=s=>M(r(o).props.customers.current_page-1))},{default:a(()=>e[30]||(e[30]=[x(" Previous ")])),_:1,__:[30]})):m("",!0),(n(!0),u(W,null,D(L.value,s=>(n(),u(W,{key:"p-"+s},[typeof s=="number"?(n(),f(r(c),{key:0,variant:s===V.value?"default":"outline",size:"sm",onClick:d=>s!==V.value&&M(s)},{default:a(()=>[x(p(s),1)]),_:2},1032,["variant","onClick"])):(n(),u("span",Ne,"â€¦"))],64))),128)),r(o).props.customers.next_page_url?(n(),f(r(c),{key:1,variant:"outline",size:"sm",onClick:e[4]||(e[4]=s=>M(r(o).props.customers.current_page-0+1))},{default:a(()=>e[31]||(e[31]=[x(" Next ")])),_:1,__:[31]})):m("",!0)])])):m("",!0)]),_:1})]),_:1}),t("div",We,[t("button",{onClick:e[5]||(e[5]=s=>C.value=!C.value),class:Z(["h-12 w-12 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center",C.value?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"])},[C.value?(n(),u("svg",Re,e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(n(),u("svg",Ee,e[32]||(e[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},null,-1)])))],2)])]),_:1}))}});export{St as default};
