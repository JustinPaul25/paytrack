import{d as j,v as B,m as D,c as _,o,w as r,a as p,b as t,f as l,h as u,u as i,g as N,t as n,W as g,e as v,F as P,r as V,S as w,l as z}from"./app-BPw9FW5W.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-CCrkwxQ7.js";import{_ as L,a as I}from"./CardContent.vue_vue_type_script_setup_true_lang-CqjqLeYt.js";import{_ as F,a as M}from"./CardTitle.vue_vue_type_script_setup_true_lang-CJOZJaTy.js";import{_ as m}from"./index-m5TJ7wif.js";import{S as R}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fe2f881_lang-99vuglkR.js";import"./RovingFocusGroup-C7wI3n6q.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BMK5AF-Z.js";import"./createLucideIcon-D0QdgWbF.js";import"./VisuallyHidden-DzC5HiGR.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DcNnTtmQ.js";import"./chevron-right-Dy4mwVyk.js";const Q={class:"flex items-center justify-between my-6"},W={class:"text-2xl font-bold"},E={class:"flex gap-2"},Y=["value"],G={key:0,class:"py-8 text-center text-sm text-gray-500"},H={key:0},J={class:"mt-3"},K={key:1},O={key:1},U={class:"min-w-full divide-y divide-border"},X={key:0,class:"px-4 py-2 text-left"},Z={class:"px-4 py-2"},ee={class:"font-medium"},te={key:0,class:"text-xs text-gray-500 truncate max-w-64"},se={class:"px-4 py-2"},ie={key:1,class:"text-sm"},oe={key:0,class:"px-4 py-2"},ne={class:"text-sm"},le={key:0,class:"text-xs text-gray-500"},ae={class:"px-4 py-2"},re={class:"px-4 py-2"},ue={class:"px-4 py-2 text-sm text-gray-500"},de={class:"px-4 py-2"},pe={class:"flex gap-2"},ve={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},fe={class:"relative bg-background rounded-lg shadow-lg w-[90%] max-w-lg p-6"},me={class:"flex items-center justify-between mb-3"},ce={class:"space-y-3"},_e={class:"font-medium"},xe={key:0},ye={class:"whitespace-pre-wrap"},ge={key:1},ke=["href"],be={class:"mt-6 flex justify-end"},ze=j({__name:"Index",setup(he){var b,h,C;const d=B(),x=d.props.filters||{},y=Array.isArray((b=d.props.auth)==null?void 0:b.userRoles)&&d.props.auth.userRoles.includes("Customer"),q=Array.isArray((h=d.props.auth)==null?void 0:h.userRoles)&&d.props.auth.userRoles.includes("Admin"),A=Array.isArray((C=d.props.auth)==null?void 0:C.userRoles)&&d.props.auth.userRoles.includes("Staff"),k=q||A,a=D(null);function S(f){R.fire({title:"Approve this refund request?",icon:"question",showCancelButton:!0,confirmButtonText:"Approve",confirmButtonColor:"#10b981",input:"textarea",inputLabel:"Approval notes (optional)",inputPlaceholder:"Notes for this approval...",inputAttributes:{"aria-label":"Approval notes (optional)"}}).then(e=>{e.isConfirmed&&g.post(route("refundRequests.approve",f),{review_notes:e.value||void 0},{preserveScroll:!0})})}function $(f){R.fire({title:"Decline this refund request?",text:"This will mark the request as rejected. You can’t undo this.",icon:"warning",showCancelButton:!0,confirmButtonText:"Decline",confirmButtonColor:"#ef4444",input:"textarea",inputLabel:"Reason (required)",inputPlaceholder:"Provide a reason for declining...",inputAttributes:{"aria-label":"Reason (required)"},inputValidator:e=>{if(!e||!e.trim())return"Please provide a brief reason."}}).then(e=>{e.isConfirmed&&g.post(route("refundRequests.reject",f),{review_notes:e.value},{preserveScroll:!0})})}return(f,e)=>(o(),_(T,null,{default:r(()=>[p(i(N),{title:"Refund Requests"}),t("div",Q,[t("h1",W,n(i(y)?"My Refund Requests":"Refund Requests"),1),t("div",E,[t("select",{class:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:i(x).status||"all",onChange:e[0]||(e[0]=s=>{const c=s.target.value==="all"?"":s.target.value;i(g).get(f.route("refundRequests.index"),c?{status:c}:{},{preserveState:!0,replace:!0})})},e[5]||(e[5]=[t("option",{value:"all"},"All",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"approved"},"Approved",-1),t("option",{value:"rejected"},"Rejected",-1),t("option",{value:"converted"},"Converted",-1)]),40,Y)])]),p(L,null,{default:r(()=>[p(F,null,{default:r(()=>[p(M,null,{default:r(()=>e[6]||(e[6]=[v("Requests")])),_:1,__:[6]})]),_:1}),p(I,null,{default:r(()=>[i(d).props.refundRequests.data.length?(o(),l("div",O,[t("table",U,[t("thead",null,[t("tr",null,[e[9]||(e[9]=t("th",{class:"px-4 py-2 text-left"},"Tracking",-1)),e[10]||(e[10]=t("th",{class:"px-4 py-2 text-left"},"Invoice",-1)),i(y)?u("",!0):(o(),l("th",X,"Customer")),e[11]||(e[11]=t("th",{class:"px-4 py-2 text-left"},"Qty",-1)),e[12]||(e[12]=t("th",{class:"px-4 py-2 text-left"},"Status",-1)),e[13]||(e[13]=t("th",{class:"px-4 py-2 text-left"},"Submitted",-1)),e[14]||(e[14]=t("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),t("tbody",null,[(o(!0),l(P,null,V(i(d).props.refundRequests.data,s=>(o(),l("tr",{key:s.id,class:"hover:bg-muted"},[t("td",Z,[t("div",ee,n(s.tracking_number),1),s.reason?(o(),l("div",te,n(s.reason),1)):u("",!0)]),t("td",se,[s.invoice_id?(o(),_(i(w),{key:0,href:f.route("invoices.show",s.invoice_id),class:"text-sm text-blue-600 hover:underline"},{default:r(()=>[v(n(s.invoice_reference||"#"+s.invoice_id),1)]),_:2},1032,["href"])):(o(),l("div",ie,n(s.invoice_reference||"#"+s.invoice_id),1))]),i(y)?u("",!0):(o(),l("td",oe,[t("div",ne,n(s.customer_name),1),s.email?(o(),l("div",le,n(s.email),1)):u("",!0)])),t("td",ae,n(s.quantity),1),t("td",re,[t("span",{class:z(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":s.status==="pending","bg-green-100 text-green-800":s.status==="approved"||s.status==="converted","bg-red-100 text-red-800":s.status==="rejected"}])},n(s.status),3)]),t("td",ue,n(new Date(s.created_at).toLocaleString()),1),t("td",de,[t("div",pe,[i(k)&&s.status==="pending"?(o(),_(i(m),{key:0,size:"sm",variant:"default",onClick:c=>S(s.id)},{default:r(()=>e[15]||(e[15]=[v(" Approve ")])),_:2,__:[15]},1032,["onClick"])):u("",!0),i(k)&&s.status==="pending"?(o(),_(i(m),{key:1,size:"sm",variant:"destructive",onClick:c=>$(s.id)},{default:r(()=>e[16]||(e[16]=[v(" Decline ")])),_:2,__:[16]},1032,["onClick"])):u("",!0),p(i(m),{size:"sm",variant:"outline",onClick:c=>a.value=s},{default:r(()=>e[17]||(e[17]=[v("View details")])),_:2,__:[17]},1032,["onClick"]),s.invoice_id&&!i(y)?(o(),_(i(w),{key:2,href:f.route("invoices.show",s.invoice_id)},{default:r(()=>[p(i(m),{size:"sm",variant:"ghost"},{default:r(()=>e[18]||(e[18]=[v("View Invoice")])),_:1,__:[18]})]),_:2},1032,["href"])):u("",!0)])])]))),128))])])])):(o(),l("div",G,[i(x).status&&i(x).status!==""&&i(x).status!=="all"?(o(),l("div",H,[e[8]||(e[8]=v(" No refund requests for the selected filter. ")),t("div",J,[p(i(m),{variant:"outline",onClick:e[1]||(e[1]=s=>i(g).get(f.route("refundRequests.index"),{},{preserveState:!0,replace:!0}))},{default:r(()=>e[7]||(e[7]=[v(" Clear filters ")])),_:1,__:[7]})])])):(o(),l("div",K," No refund requests. "))]))]),_:1})]),_:1}),a.value?(o(),l("div",ve,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[2]||(e[2]=s=>a.value=null)}),t("div",fe,[t("div",me,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold"},"Refund Request Details",-1)),t("button",{class:"text-sm text-gray-500",onClick:e[3]||(e[3]=s=>a.value=null)},"Close")]),t("div",ce,[t("div",null,[e[20]||(e[20]=t("div",{class:"text-xs text-gray-500"},"Tracking",-1)),t("div",_e,n(a.value.tracking_number),1)]),a.value.product_name?(o(),l("div",xe,[e[21]||(e[21]=t("div",{class:"text-xs text-gray-500"},"Product",-1)),t("div",null,n(a.value.product_name),1)])):u("",!0),t("div",null,[e[22]||(e[22]=t("div",{class:"text-xs text-gray-500"},"Quantity",-1)),t("div",null,n(a.value.quantity),1)]),t("div",null,[e[23]||(e[23]=t("div",{class:"text-xs text-gray-500"},"Description",-1)),t("div",ye,n(a.value.reason||"—"),1)]),a.value.media_link?(o(),l("div",ge,[e[24]||(e[24]=t("div",{class:"text-xs text-gray-500"},"Media Link",-1)),t("a",{href:a.value.media_link,target:"_blank",class:"text-blue-500 underline break-all"},n(a.value.media_link),9,ke)])):u("",!0)]),t("div",be,[p(i(m),{variant:"default",onClick:e[4]||(e[4]=s=>a.value=null)},{default:r(()=>e[25]||(e[25]=[v("Done")])),_:1,__:[25]})])])])):u("",!0)]),_:1}))}});export{ze as default};
