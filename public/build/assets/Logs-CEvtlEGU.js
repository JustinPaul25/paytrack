import{d as G,v as H,m as B,p as x,s as j,W as C,c as v,o,w as n,a as m,b as s,u as d,g as J,t as u,S as T,h as g,x as U,y as Q,e as a,F as $,r as D,D as R,f as _,n as X}from"./app-BJGGIgA8.js";import{_ as k}from"./index-riohrRak.js";import{_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-6OmCq4tp.js";import{_ as V,a as z}from"./CardContent.vue_vue_type_script_setup_true_lang-DPB8yWHX.js";import{_ as M}from"./Icon.vue_vue_type_script_setup_true_lang-DK3Ddpru.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-CX_goT8l.js";import"./useForwardPropsEmits-CZzI8B5e.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-MrJHOVsW.js";import"./Teleport-MSIji786.js";import"./RovingFocusGroup-gSG5KO_4.js";import"./VisuallyHidden-BC0AEIfW.js";import"./DialogPortal-Dpb7jdpY.js";import"./x-BjkU5bBK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DSD56j4j.js";import"./chevron-down-B83M1Caq.js";import"./chevron-right-CjvrEjDl.js";import"./square-pen-BALro00M.js";import"./calendar-C8vvPkHy.js";import"./check-CuaqBRk8.js";import"./chevron-left-Czs0_KEi.js";import"./circle-alert-C-R8aAcF.js";import"./piggy-bank-DQw4-LKJ.js";import"./circle-check-big-gvrLbzHW.js";import"./circle-check-BuF8fqTY.js";import"./trophy-B5vnFol2.js";import"./circle-x-C9HF6h3m.js";import"./clock-CUJ54ABb.js";import"./dollar-sign-BFWObhvv.js";import"./eye-off-dgfcsi04.js";import"./eye-BztToSRT.js";import"./loader-circle-ZvNwhMCX.js";import"./mail-tmHC_MiF.js";import"./map-pin-D8FvW8n7.js";import"./message-square-Cf895NaZ.js";import"./sun-Bomsfx5Q.js";import"./plus-CntaVqKq.js";import"./printer-_fQTJVRW.js";import"./search-BUl39vHB.js";import"./shopping-bag-DsL7THBq.js";import"./trash-2-DcMzLwyY.js";import"./trending-up-CSTqz3kz.js";const Z={class:"flex items-center justify-between mb-6"},ee={class:"text-2xl font-bold"},te={class:"flex gap-4 items-end"},se={class:"flex-1"},re={class:"w-48"},oe=["value"],ae={key:0,class:"py-12 text-center"},ie={class:"mx-auto max-w-md"},ue={class:"text-sm text-muted-foreground"},ne={key:1,class:"overflow-x-auto"},le={class:"min-w-full divide-y divide-border"},de={class:"bg-muted/50"},me={key:0,class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},pe={class:"bg-background divide-y divide-border"},ce={class:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground"},fe={class:"px-4 py-3 whitespace-nowrap"},ve={class:"px-4 py-3 text-sm"},ge={key:0,class:"mt-1 text-xs text-muted-foreground"},xe={key:0,class:"px-4 py-3 whitespace-nowrap text-sm"},_e={key:1,class:"text-muted-foreground"},ye={class:"px-4 py-3 whitespace-nowrap text-sm"},be={key:0},he={key:1,class:"text-muted-foreground italic"},ke={class:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground"},we={key:2,class:"flex items-center justify-between px-4 py-4 border-t border-border"},Ce={class:"text-sm text-muted-foreground"},$e={class:"flex items-center gap-1"},Se={key:1,class:"px-2 text-sm text-muted-foreground"},vt=G({__name:"Logs",setup(Ae){const y=H(),w=B(y.props.filters?y.props.filters:{}),p=B(typeof w.value.search=="string"?w.value.search:""),c=B(typeof w.value.action=="string"?w.value.action:""),i=x(()=>y.props.customer),F=x(()=>y.props.actions||[]),O=i.value?[{title:"Customers",href:"/customers"},{title:i.value.name,href:`/customers/${i.value.id}`},{title:"Logs",href:"#"}]:[{title:"Customers",href:"/customers"},{title:"Logs",href:"/customers/logs"}];let S=null;j(p,r=>{S&&clearTimeout(S),S=setTimeout(()=>{P()},400)}),j(c,()=>{P()});function P(){const r={};p.value&&(r.search=p.value),c.value&&(r.action=c.value),i.value?C.get(`/customers/${i.value.id}/logs`,r,{preserveState:!0,replace:!0}):C.get("/customers/logs",r,{preserveState:!0,replace:!0})}function A(r){const e={page:r};p.value&&(e.search=p.value),c.value&&(e.action=c.value),i.value?C.get(`/customers/${i.value.id}/logs`,e,{preserveState:!0,replace:!0}):C.get("/customers/logs",e,{preserveState:!0,replace:!0})}function K(r){return new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function W(r){switch(r.toLowerCase()){case"created":return"bg-green-100 text-green-800";case"updated":return"bg-blue-100 text-blue-800";case"verified":return"bg-purple-100 text-purple-800";case"deleted":return"bg-red-100 text-red-800";case"registered":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}}function E(r){return!r||Object.keys(r).length===0?"":Object.entries(r).map(([e,t])=>`${e.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())}: "${t.old}" → "${t.new}"`).join(", ")}const l=x(()=>y.props.logs),b=x(()=>{var r;return((r=l.value)==null?void 0:r.current_page)||1}),I=x(()=>{var r;return((r=l.value)==null?void 0:r.last_page)||1}),q=x(()=>{const r=I.value||1,e=b.value||1,t=2,f=[],h=Math.max(1,e-t),N=Math.min(r,e+t);for(let L=h;L<=N;L++)f.push(L);return h>1&&(h>2&&f.unshift("..."),f.unshift(1)),N<r&&(N<r-1&&f.push("..."),f.push(r)),f});return(r,e)=>(o(),v(Y,{breadcrumbs:d(O)},{default:n(()=>[m(d(J),{title:i.value?`${i.value.name} - Logs`:"Customer Logs"},null,8,["title"]),s("div",Z,[s("div",null,[s("h1",ee,u(i.value?`${i.value.name} - Activity Logs`:"Customer Activity Logs"),1),e[4]||(e[4]=s("p",{class:"text-sm text-muted-foreground mt-1"}," Track all customer-related activities and changes ",-1))]),i.value?(o(),v(d(T),{key:1,href:r.route("customers.edit",i.value.id)},{default:n(()=>[m(d(k),{variant:"outline"},{default:n(()=>[m(M,{name:"arrow-left",class:"h-4 w-4 mr-2"}),e[6]||(e[6]=g(" Back to Customer "))]),_:1,__:[6]})]),_:1},8,["href"])):(o(),v(d(T),{key:0,href:r.route("customers.index")},{default:n(()=>[m(d(k),{variant:"outline"},{default:n(()=>[m(M,{name:"arrow-left",class:"h-4 w-4 mr-2"}),e[5]||(e[5]=g(" Back to Customers "))]),_:1,__:[5]})]),_:1},8,["href"]))]),m(V,{class:"mb-6"},{default:n(()=>[m(z,{class:"p-4"},{default:n(()=>[s("div",te,[s("div",se,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium mb-1"},"Search",-1)),U(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),type:"text",placeholder:"Search by description, customer name, or user...",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[Q,p.value]])]),s("div",re,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium mb-1"},"Action",-1)),U(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[8]||(e[8]=s("option",{value:""},"All Actions",-1)),(o(!0),a($,null,D(F.value,t=>(o(),a("option",{key:t,value:t},u(t.charAt(0).toUpperCase()+t.slice(1)),9,oe))),128))],512),[[R,c.value]])])])]),_:1})]),_:1}),m(V,null,{default:n(()=>[m(z,{class:"p-0"},{default:n(()=>[l.value.total===0?(o(),a("div",ae,[s("div",ie,[e[10]||(e[10]=s("h3",{class:"text-lg font-semibold mb-2"},"No logs found",-1)),s("p",ue,u(p.value||c.value?"No logs match your filters.":"No customer activity logs have been recorded yet."),1)])])):(o(),a("div",ne,[s("table",le,[s("thead",de,[s("tr",null,[e[11]||(e[11]=s("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Date & Time",-1)),e[12]||(e[12]=s("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Action",-1)),e[13]||(e[13]=s("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Description",-1)),i.value?_("",!0):(o(),a("th",me,"Customer")),e[14]||(e[14]=s("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Performed By",-1)),e[15]||(e[15]=s("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"IP Address",-1))])]),s("tbody",pe,[(o(!0),a($,null,D(l.value.data,t=>(o(),a("tr",{key:t.id,class:"hover:bg-muted/50"},[s("td",ce,u(K(t.created_at)),1),s("td",fe,[s("span",{class:X(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",W(t.action)])},u(t.action.charAt(0).toUpperCase()+t.action.slice(1)),3)]),s("td",ve,[s("div",null,u(t.description),1),t.changes&&Object.keys(t.changes).length>0?(o(),a("div",ge,[e[16]||(e[16]=s("strong",null,"Changes:",-1)),g(" "+u(E(t.changes)),1)])):_("",!0)]),i.value?_("",!0):(o(),a("td",xe,[t.customer?(o(),v(d(T),{key:0,href:r.route("customers.edit",t.customer.id),class:"text-primary hover:underline"},{default:n(()=>[g(u(t.customer.name),1)]),_:2},1032,["href"])):(o(),a("span",_e,"N/A"))])),s("td",ye,[t.user?(o(),a("span",be,u(t.user.name),1)):(o(),a("span",he,"System / Self-registration"))]),s("td",ke,u(t.ip_address||"N/A"),1)]))),128))])])])),l.value.last_page>1?(o(),a("div",we,[s("div",Ce," Showing "+u(l.value.from)+" to "+u(l.value.to)+" of "+u(l.value.total)+" results ",1),s("div",$e,[l.value.prev_page_url?(o(),v(d(k),{key:0,variant:"outline",size:"sm",onClick:e[2]||(e[2]=t=>A(b.value-1))},{default:n(()=>e[17]||(e[17]=[g(" Previous ")])),_:1,__:[17]})):_("",!0),(o(!0),a($,null,D(q.value,t=>(o(),a($,{key:"p-"+t},[typeof t=="number"?(o(),v(d(k),{key:0,variant:t===b.value?"default":"outline",size:"sm",onClick:f=>t!==b.value&&A(t)},{default:n(()=>[g(u(t),1)]),_:2},1032,["variant","onClick"])):(o(),a("span",Se,"…"))],64))),128)),l.value.next_page_url?(o(),v(d(k),{key:1,variant:"outline",size:"sm",onClick:e[3]||(e[3]=t=>A(b.value+1))},{default:n(()=>e[18]||(e[18]=[g(" Next ")])),_:1,__:[18]})):_("",!0)])])):_("",!0)]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{vt as default};
