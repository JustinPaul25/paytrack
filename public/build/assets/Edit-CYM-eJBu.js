import{d as W,x as G,c as f,a as S,o as v,w as n,b as t,e as s,u as i,k as H,t as _,q as J,f as u,m as x,v as $,g as q,F as K,h as R,l as X,S as Y}from"./app-BiCwixa0.js";import{_ as g}from"./index-BGAd5Xxq.js";import{_ as w}from"./Select.vue_vue_type_script_setup_true_lang-By6A6a-p.js";import{_ as k}from"./SearchSelect.vue_vue_type_script_setup_true_lang-BixZF7tr.js";import{_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-hGn2CeUN.js";import{_ as V,a as C}from"./CardContent.vue_vue_type_script_setup_true_lang-BALGLL1E.js";import{a as U,_ as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-CCv22Oca.js";import{_ as ee}from"./CardFooter.vue_vue_type_script_setup_true_lang-HrXj85q0.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-BgXjDWvd.js";import{S as te}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang--VgOSz6n.js";import{T as oe}from"./trash-2-CdFODoJx.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D4teGCHk.js";import"./createLucideIcon-BpQzhPsZ.js";import"./RovingFocusGroup-BkEEw2sv.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_5601c0ff_lang-BWPt1fpK.js";import"./Input.vue_vue_type_script_setup_true_lang-Dk4U5pV5.js";import"./search-DG5kMy1j.js";import"./VisuallyHidden-BxoVLwJH.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CnwYsNMs.js";const se={class:"flex items-center justify-between mb-6"},ie={class:"text-2xl font-bold"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re={class:"flex justify-between items-center"},ae={class:"space-y-3"},ue={class:"flex justify-between items-center mb-3"},de={class:"font-medium text-sm"},me={class:"grid grid-cols-1 md:grid-cols-4 gap-3"},ce=["id","onUpdate:modelValue","onInput"],pe=["id","onUpdate:modelValue","onInput"],_e={class:"w-full rounded-md border border-input bg-transparent px-2 py-1 mt-1 text-sm text-foreground dark:bg-input/30 h-8 flex items-center"},fe={class:"mt-4 pt-3 border-t"},ve={class:"flex justify-end"},ge={class:"text-right space-y-1"},be={class:"text-sm text-muted-foreground"},ye={class:"text-sm text-muted-foreground"},he={class:"text-base font-medium"},Me=W({__name:"Edit",props:{invoice:{},customers:{},products:{}},setup(F){const d=F,l=G({customer_id:d.invoice.customer_id,status:d.invoice.status,payment_method:d.invoice.payment_method,notes:d.invoice.notes||"",invoice_items:d.invoice.invoice_items.map(o=>({id:o.id,product_id:o.product_id,quantity:o.quantity,price:o.price,total:o.total}))}),P=[{title:"Invoices",href:"/invoices"},{title:"Edit Invoice",href:`/invoices/${d.invoice.id}/edit`}],b=f(()=>l.invoice_items.reduce((o,e)=>o+e.total,0)),I=f(()=>b.value*.12),B=f(()=>b.value+I.value);function E(){l.invoice_items.push({id:void 0,product_id:null,quantity:1,price:0,total:0})}function j(o){l.invoice_items.length>1&&l.invoice_items.splice(o,1)}function y(o){const e=l.invoice_items[o];e.product_id&&e.quantity&&e.price?e.total=e.quantity*e.price:e.total=0}function A(o){const e=l.invoice_items[o];if(e.product_id){const r=d.products.find(a=>a.id===e.product_id);r&&(e.price=r.selling_price,y(o))}}function N(o){y(o)}function O(o){y(o)}function D(){l.post(route("invoices.update",d.invoice.id),{preserveScroll:!0,onSuccess:()=>{te.fire({toast:!0,position:"top-end",icon:"success",title:"Invoice updated successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},method:"post"})}function h(o){return l.errors[o]}const M=f(()=>[{value:null,label:"Select customer"},...d.customers.map(o=>({value:o.id,label:`${o.name}${o.company_name?` (${o.company_name})`:""}`}))]),Q=[{value:"draft",label:"Draft"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],z=[{value:"cash",label:"Cash"},{value:"bank_transfer",label:"Bank Transfer"},{value:"e-wallet",label:"E-Wallet"},{value:"other",label:"Other"}];function L(){return[{value:null,label:"Select product"},...d.products.map(o=>({value:o.id,label:`${o.name} - ₱${o.selling_price.toFixed(2)}`}))]}return(o,e)=>(v(),S(Z,{breadcrumbs:P},{default:n(()=>[t(i(H),{title:"Edit Invoice"}),s("div",se,[s("h1",ie,"Edit Invoice #"+_(d.invoice.id),1)]),s("form",{onSubmit:J(D,["prevent"]),class:"space-y-6"},[t(V,null,{default:n(()=>[t(U,null,{default:n(()=>[t(T,null,{default:n(()=>e[4]||(e[4]=[u("Invoice Details")])),_:1,__:[4]})]),_:1}),t(C,{class:"space-y-6"},{default:n(()=>[s("div",ne,[s("div",null,[t(c,{for:"customer_id"},{default:n(()=>e[5]||(e[5]=[u("Customer")])),_:1,__:[5]}),t(i(k),{modelValue:i(l).customer_id,"onUpdate:modelValue":e[0]||(e[0]=r=>i(l).customer_id=r),options:M.value,placeholder:"Select customer","search-placeholder":"Search customers...",class:"mt-1",required:""},null,8,["modelValue","options"]),t(p,{message:i(l).errors.customer_id},null,8,["message"])]),s("div",null,[t(c,{for:"status"},{default:n(()=>e[6]||(e[6]=[u("Status")])),_:1,__:[6]}),t(i(w),{modelValue:i(l).status,"onUpdate:modelValue":e[1]||(e[1]=r=>i(l).status=r),options:Q,placeholder:"Select status",class:"mt-1",required:""},null,8,["modelValue"]),t(p,{message:i(l).errors.status},null,8,["message"])])]),s("div",le,[s("div",null,[t(c,{for:"payment_method"},{default:n(()=>e[7]||(e[7]=[u("Payment Method")])),_:1,__:[7]}),t(i(w),{modelValue:i(l).payment_method,"onUpdate:modelValue":e[2]||(e[2]=r=>i(l).payment_method=r),options:z,placeholder:"Select payment method",class:"mt-1",required:""},null,8,["modelValue"]),t(p,{message:i(l).errors.payment_method},null,8,["message"])])]),s("div",null,[t(c,{for:"notes"},{default:n(()=>e[8]||(e[8]=[u("Notes")])),_:1,__:[8]}),x(s("textarea",{id:"notes","onUpdate:modelValue":e[3]||(e[3]=r=>i(l).notes=r),class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3"},null,512),[[$,i(l).notes]]),t(p,{message:i(l).errors.notes},null,8,["message"])])]),_:1})]),_:1}),t(V,null,{default:n(()=>[t(U,null,{default:n(()=>[s("div",re,[t(T,null,{default:n(()=>e[9]||(e[9]=[u("Invoice Items")])),_:1,__:[9]}),t(i(g),{type:"button",variant:"outline",onClick:E},{default:n(()=>e[10]||(e[10]=[s("span",{class:"mr-2"},"+",-1),u(" Add Item ")])),_:1,__:[10]})])]),_:1}),t(C,null,{default:n(()=>[s("div",ae,[(v(!0),q(K,null,R(i(l).invoice_items,(r,a)=>(v(),q("div",{key:a,class:"border rounded-md p-3"},[s("div",ue,[s("h4",de,"Item "+_(a+1),1),i(l).invoice_items.length>1?(v(),S(i(g),{key:0,type:"button",variant:"ghost",size:"sm",class:"h-7 w-7 p-0 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/20",onClick:m=>j(a)},{default:n(()=>[t(i(oe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):X("",!0)]),s("div",me,[s("div",null,[t(c,{for:`product_id_${a}`,class:"text-xs"},{default:n(()=>e[11]||(e[11]=[u("Product")])),_:2,__:[11]},1032,["for"]),t(i(k),{modelValue:r.product_id,"onUpdate:modelValue":[m=>r.product_id=m,m=>A(a)],options:L(),placeholder:"Select product","search-placeholder":"Search products...",class:"mt-1 h-8",required:""},null,8,["modelValue","onUpdate:modelValue","options"]),t(p,{message:h(`invoice_items.${a}.product_id`)},null,8,["message"])]),s("div",null,[t(c,{for:`quantity_${a}`,class:"text-xs"},{default:n(()=>e[12]||(e[12]=[u("Quantity")])),_:2,__:[12]},1032,["for"]),x(s("input",{id:`quantity_${a}`,"onUpdate:modelValue":m=>r.quantity=m,type:"number",min:"1",class:"w-full rounded-md border border-input bg-transparent px-2 py-1 mt-1 text-sm text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none h-8",onInput:m=>N(a),required:""},null,40,ce),[[$,r.quantity,void 0,{number:!0}]]),t(p,{message:h(`invoice_items.${a}.quantity`)},null,8,["message"])]),s("div",null,[t(c,{for:`price_${a}`,class:"text-xs"},{default:n(()=>e[13]||(e[13]=[u("Price")])),_:2,__:[13]},1032,["for"]),x(s("input",{id:`price_${a}`,"onUpdate:modelValue":m=>r.price=m,type:"number",min:"0",step:"0.01",class:"w-full rounded-md border border-input bg-transparent px-2 py-1 mt-1 text-sm text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none h-8",onInput:m=>O(a),required:""},null,40,pe),[[$,r.price,void 0,{number:!0}]]),t(p,{message:h(`invoice_items.${a}.price`)},null,8,["message"])]),s("div",null,[t(c,{class:"text-xs"},{default:n(()=>e[14]||(e[14]=[u("Total")])),_:1,__:[14]}),s("div",_e," ₱"+_(r.total.toFixed(2)),1)])])]))),128))]),s("div",fe,[s("div",ve,[s("div",ge,[s("div",be,"Subtotal: ₱"+_(b.value.toFixed(2)),1),s("div",ye,"VAT (12%): ₱"+_(I.value.toFixed(2)),1),s("div",he,"Total Amount: ₱"+_(B.value.toFixed(2)),1)])])])]),_:1})]),_:1}),t(V,null,{default:n(()=>[t(ee,{class:"flex gap-2 justify-end"},{default:n(()=>[t(i(g),{type:"submit",variant:"default"},{default:n(()=>e[15]||(e[15]=[u("Update Invoice")])),_:1,__:[15]}),t(i(Y),{href:o.route("invoices.index")},{default:n(()=>[t(i(g),{type:"button",variant:"ghost"},{default:n(()=>e[16]||(e[16]=[u("Cancel")])),_:1,__:[16]})]),_:1},8,["href"])]),_:1})]),_:1})],32)]),_:1}))}});export{Me as default};
