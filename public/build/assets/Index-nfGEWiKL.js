import{d as L,v as Y,m as V,p as f,I as G,s as U,W as g,c as v,o as a,w as l,a as i,b as e,u as r,g as q,T as J,x as W,t as d,G as K,f as _,y as O,S as C,h,e as u,F as A,r as R,n as Q}from"./app-qILHOVOR.js";import{_ as c}from"./index-CwKxeFAr.js";import{_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-GpGFHloG.js";import{_ as w,a as b}from"./CardContent.vue_vue_type_script_setup_true_lang-Cli7n1dX.js";import{_ as E}from"./Icon.vue_vue_type_script_setup_true_lang-Byvv1A7d.js";import{S as B}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fdfc5f8_lang-qOUWYnwy.js";import"./useForwardPropsEmits-DOl1PTJP.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DhBISZBL.js";import"./createLucideIcon-BnHCfrxd.js";import"./Teleport-C3FR6f0f.js";import"./RovingFocusGroup-DXnuhdVJ.js";import"./VisuallyHidden-CZgjK68G.js";import"./x-C0sfuU9f.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CKzHIYx1.js";import"./square-pen-rdASobpV.js";import"./calendar-Bp4SsuYv.js";import"./check-sjrOsK-V.js";import"./chevron-left-CUV_-SXb.js";import"./circle-alert-CCgqp-QG.js";import"./piggy-bank-DDQQ8mIV.js";import"./circle-check-big-BEie_gpu.js";import"./message-square-DH42JBLu.js";import"./trophy-CvqaEBFO.js";import"./plus-K7YZF6lG.js";import"./clock-AwD5ihkZ.js";import"./dollar-sign-Dl_zLhNe.js";import"./eye-off-D9-ltPip.js";import"./eye-DxCmWbNw.js";import"./loader-circle-D5ykgVj6.js";import"./map-pin-eK1N-d1g.js";import"./sun-CIqaw_cR.js";import"./printer-8uigOg4T.js";import"./search-OTMfk3H7.js";import"./shopping-bag-Ki-72Y8p.js";import"./trash-2-BzhUgiYC.js";import"./trending-up-BSBKmyGC.js";import"./user-cog-5rKgEpUK.js";const Z={class:"grid grid-cols-1 lg:grid-cols-4 gap-6 mt-8 mb-6"},ee={class:"flex items-center justify-between"},te={class:"text-xl font-bold text-blue-600"},se={class:"flex items-center justify-between"},oe={class:"text-xl font-bold text-green-600"},re={class:"flex items-center justify-between"},le={class:"text-xl font-bold text-yellow-600"},ne={class:"flex items-center justify-between"},ae={class:"text-xl font-bold text-emerald-600"},ie={class:"flex items-center justify-between mt-4 mb-2"},ue={class:"flex gap-2 items-center"},de={key:0,class:"py-12 text-center"},me={class:"mx-auto max-w-md"},pe={key:1,class:"py-12 text-center"},ce={class:"mx-auto max-w-md"},fe={key:2,class:"min-w-full divide-y divide-border"},ve={class:"px-4 py-2 font-medium"},he={key:1},xe={class:"px-4 py-2"},ye={class:"px-4 py-2"},ge={class:"px-4 py-2"},_e={class:"px-4 py-2"},we={key:0,class:"flex gap-2"},be={key:1,class:"text-sm text-muted-foreground"},ke={key:3,class:"flex items-center justify-between mt-6"},Ce={class:"text-sm text-gray-700"},Be={class:"flex items-center gap-1"},je={key:1,class:"px-2 text-sm text-muted-foreground"},Se={class:"fixed bottom-6 right-6 z-50"},Te={key:0,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ze={key:1,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vt=L({__name:"Index",setup(Me){const o=Y(),$=V(o.props.filters?o.props.filters:{}),p=V(typeof $.value.search=="string"?$.value.search:""),x=V(!1),N=f(()=>{var n;return Array.isArray((n=o.props.auth)==null?void 0:n.userRoles)&&o.props.auth.userRoles.includes("Admin")});f(()=>{var n;return Array.isArray((n=o.props.auth)==null?void 0:n.userRoles)&&o.props.auth.userRoles.includes("Staff")&&!N.value});const k=f(()=>N.value),H=[{title:"Customers",href:"/customers"}];G(()=>{p.value=o.props.filters&&typeof o.props.filters.search=="string"?o.props.filters.search:""});let j=null;U(p,n=>{j&&clearTimeout(j),j=setTimeout(()=>{const t=(n??"").toString().trim(),s=o.props.filters&&typeof o.props.filters.search=="string"?o.props.filters.search:"";t!==s&&g.get("/customers",{search:t||void 0},{preserveState:!0,replace:!0})},400)});function S(n){g.get("/customers",{search:p.value,page:n},{preserveState:!0,replace:!0})}const P=f(()=>o.props.customers),T=f(()=>P.value.current_page),D=f(()=>P.value.last_page),F=f(()=>{const n=D.value||1,t=T.value||1,s=2,m=[],y=Math.max(1,t-s),z=Math.min(n,t+s);for(let M=y;M<=z;M++)m.push(M);return y>1&&(y>2&&m.unshift("..."),m.unshift(1)),z<n&&(z<n-1&&m.push("..."),m.push(n)),m});async function I(n){(await B.fire({title:"Delete Customer?",text:"Are you sure you want to delete this customer? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#8f5be8",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete customer"})).isConfirmed&&g.delete(`/customers/${n}`,{onSuccess:()=>{const s=o.props.flash;if(s!=null&&s.error){B.fire({title:"Cannot delete",text:s.error,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(m=>{m.isConfirmed&&g.get("/deliveries",{customer_id:n},{preserveState:!0,replace:!0})});return}B.fire("Customer deleted","Customer deleted successfully.","success")},onError:()=>{const s=o.props.flash,m=(s==null?void 0:s.error)??"Cannot delete this customer because there are related records.";B.fire({title:"Cannot delete",text:m,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(y=>{y.isConfirmed&&g.get("/deliveries",{customer_id:n},{preserveState:!0,replace:!0})})}})}return(n,t)=>(a(),v(X,{breadcrumbs:H},{default:l(()=>[i(r(q),{title:"Customers"}),i(J,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-4","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-4"},{default:l(()=>[W(e("div",Z,[i(w,{class:"relative overflow-hidden"},{default:l(()=>[i(b,{class:"p-6"},{default:l(()=>{var s;return[e("div",ee,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-muted-foreground"},"Total Customers",-1)),e("p",te,d(((s=r(o).props.stats)==null?void 0:s.totalCustomers)||0),1)]),t[6]||(t[6]=e("div",{class:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center"},[e("svg",{class:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})])],-1))])]}),_:1})]),_:1}),i(w,{class:"relative overflow-hidden"},{default:l(()=>[i(b,{class:"p-6"},{default:l(()=>{var s;return[e("div",se,[e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-muted-foreground"},"With Company",-1)),e("p",oe,d(((s=r(o).props.stats)==null?void 0:s.customersWithCompany)||0),1)]),t[8]||(t[8]=e("div",{class:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center"},[e("svg",{class:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1))])]}),_:1})]),_:1}),i(w,{class:"relative overflow-hidden"},{default:l(()=>[i(b,{class:"p-6"},{default:l(()=>{var s;return[e("div",re,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-muted-foreground"},"With Phone",-1)),e("p",le,d(((s=r(o).props.stats)==null?void 0:s.customersWithPhone)||0),1)]),t[10]||(t[10]=e("div",{class:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center"},[e("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1))])]}),_:1})]),_:1}),i(w,{class:"relative overflow-hidden"},{default:l(()=>[i(b,{class:"p-6"},{default:l(()=>{var s;return[e("div",ne,[e("div",null,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-muted-foreground"},"Recently Added",-1)),e("p",ae,d(((s=r(o).props.stats)==null?void 0:s.recentlyAdded)||0),1)]),t[12]||(t[12]=e("div",{class:"h-12 w-12 rounded-full bg-emerald-100 flex items-center justify-center"},[e("svg",{class:"h-6 w-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]}),_:1})]),_:1})],512),[[K,x.value]])]),_:1}),e("div",ie,[e("div",ue,[W(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),type:"text",placeholder:"Search customers by name, company, or email...",class:"rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[O,p.value]])]),k.value?(a(),v(r(C),{key:0,href:n.route("customers.create")},{default:l(()=>[i(r(c),{variant:"default"},{default:l(()=>t[13]||(t[13]=[e("span",{class:"mr-2"},"+",-1),h(" Add New Customer ")])),_:1,__:[13]})]),_:1},8,["href"])):_("",!0)]),i(w,null,{default:l(()=>[i(b,null,{default:l(()=>[r(o).props.customers.total===0?(a(),u("div",de,[e("div",me,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold mb-2"},"No customers yet",-1)),t[16]||(t[16]=e("p",{class:"text-sm text-muted-foreground mb-6"}," Customers you add will appear here. You can create invoices faster when customers are saved. ",-1)),k.value?(a(),v(r(C),{key:0,href:n.route("customers.create")},{default:l(()=>[i(r(c),{variant:"default"},{default:l(()=>t[14]||(t[14]=[h(" Add your first customer ")])),_:1,__:[14]})]),_:1},8,["href"])):_("",!0)])])):r(o).props.customers.data.length===0&&p.value&&p.value.toString().trim().length?(a(),u("div",pe,[e("div",ce,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold mb-2"},"No results found",-1)),t[19]||(t[19]=e("p",{class:"text-sm text-muted-foreground mb-6"}," We couldn't find any customers matching your search. ",-1)),i(r(c),{variant:"outline",onClick:t[1]||(t[1]=s=>p.value="")},{default:l(()=>t[17]||(t[17]=[h(" Clear search ")])),_:1,__:[17]})])])):(a(),u("table",fe,[t[20]||(t[20]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Name"),e("th",{class:"px-4 py-2 text-left"},"Company"),e("th",{class:"px-4 py-2 text-left"},"Email"),e("th",{class:"px-4 py-2 text-left"},"Phone"),e("th",{class:"px-4 py-2 text-left"},"Actions")])],-1)),e("tbody",null,[(a(!0),u(A,null,R(r(o).props.customers.data,s=>(a(),u("tr",{key:s.id,class:"hover:bg-muted"},[e("td",ve,[k.value?(a(),v(r(C),{key:0,href:n.route("customers.edit",s.id),class:"underline underline-offset-4"},{default:l(()=>[h(d(s.name),1)]),_:2},1032,["href"])):(a(),u("span",he,d(s.name),1))]),e("td",xe,d(s.company_name||"-"),1),e("td",ye,d(s.email),1),e("td",ge,d(s.phone||"-"),1),e("td",_e,[k.value?(a(),u("div",we,[i(r(C),{href:n.route("customers.edit",s.id)},{default:l(()=>[i(r(c),{variant:"ghost",size:"sm"},{default:l(()=>[i(E,{name:"edit",class:"h-4 w-4"})]),_:1})]),_:2},1032,["href"]),i(r(c),{variant:"ghost",size:"sm",onClick:m=>I(s.id)},{default:l(()=>[i(E,{name:"trash",class:"h-4 w-4"})]),_:2},1032,["onClick"])])):(a(),u("span",be,"View only"))])]))),128))])])),r(o).props.customers.last_page>1?(a(),u("div",ke,[e("div",Ce," Showing "+d(r(o).props.customers.from)+" to "+d(r(o).props.customers.to)+" of "+d(r(o).props.customers.total)+" results ",1),e("div",Be,[r(o).props.customers.prev_page_url?(a(),v(r(c),{key:0,variant:"outline",size:"sm",onClick:t[2]||(t[2]=s=>S(r(o).props.customers.current_page-1))},{default:l(()=>t[21]||(t[21]=[h(" Previous ")])),_:1,__:[21]})):_("",!0),(a(!0),u(A,null,R(F.value,s=>(a(),u(A,{key:"p-"+s},[typeof s=="number"?(a(),v(r(c),{key:0,variant:s===T.value?"default":"outline",size:"sm",onClick:m=>s!==T.value&&S(s)},{default:l(()=>[h(d(s),1)]),_:2},1032,["variant","onClick"])):(a(),u("span",je,"â€¦"))],64))),128)),r(o).props.customers.next_page_url?(a(),v(r(c),{key:1,variant:"outline",size:"sm",onClick:t[3]||(t[3]=s=>S(r(o).props.customers.current_page-0+1))},{default:l(()=>t[22]||(t[22]=[h(" Next ")])),_:1,__:[22]})):_("",!0)])])):_("",!0)]),_:1})]),_:1}),e("div",Se,[e("button",{onClick:t[4]||(t[4]=s=>x.value=!x.value),class:Q(["h-12 w-12 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center",x.value?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"])},[x.value?(a(),u("svg",ze,t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(a(),u("svg",Te,t[23]||(t[23]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},null,-1)])))],2)])]),_:1}))}});export{vt as default};
