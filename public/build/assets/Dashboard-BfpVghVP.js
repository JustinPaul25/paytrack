import{d as q,c as X,o as b,u as o,j as Ce,k as De,w as r,l as ge,e as h,n as ee,m as B,p as m,q as fe,a,b as e,h as x,t as p,r as z,F as W,i as ae,s as Pe,v as Me,W as ie,g as Te,f as de,x as ce,y as ue}from"./app-CEhKJ09n.js";import{_ as le}from"./Select.vue_vue_type_script_setup_true_lang-pnoe4ZD9.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-BX7_UtG3.js";import{a as Be,C as oe,P as J,b as Y,c as E,d as U,F as pe,S as Ae,_ as He}from"./AppLayout.vue_vue_type_script_setup_true_lang-DP5J-o3h.js";import{_ as P,a as M}from"./CardContent.vue_vue_type_script_setup_true_lang-CcR04WAx.js";import{a as j,_ as I}from"./CardTitle.vue_vue_type_script_setup_true_lang-UyguUcT6.js";import{c as Fe}from"./index-DDy6xMSo.js";import{C as ye,a as be,L as he,P as ve,b as _e,p as xe,c as we,d as ke,i as $e,e as Se,_ as me}from"./BaseChart.vue_vue_type_script_setup_true_lang-Qdbu10KT.js";import{T as V}from"./trending-up-C7mtoknh.js";import{T as Le,C as O}from"./trophy-B18kaOyR.js";import{_ as Ve,a as Re,b as te,c as se}from"./TabsContent.vue_vue_type_script_setup_true_lang-CnNdpwdP.js";import{S as je}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{C as Ie}from"./calendar-CG2u_FIW.js";import{C as Ne}from"./clock-DBhHlNdl.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DcSblUwu.js";import"./useForwardPropsEmits-BqVmhJ7B.js";import"./Teleport-BwopUFce.js";import"./RovingFocusGroup-D6ZGXjiS.js";import"./chevron-down-NjHhClp-.js";import"./VisuallyHidden-Cv_WHr3c.js";import"./DialogPortal-Dn5cMPvX.js";import"./x-C1_ahknI.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C1xkcekv.js";import"./circle-check-CS2zu9nk.js";import"./chevron-right-BebvM6nV.js";import"./RovingFocusItem-BkZX53Th.js";const Ke=q({__name:"TooltipProvider",props:{delayDuration:{default:0},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(A){const g=A;return(v,y)=>(b(),X(o(Be),Ce(De(g)),{default:r(()=>[ge(v.$slots,"default")]),_:3},16))}}),G=q({__name:"CardDescription",props:{class:{}},setup(A){const g=A;return(v,y)=>(b(),h("p",{"data-slot":"card-description",class:ee(o(Fe)("text-muted-foreground text-sm",g.class))},[ge(v.$slots,"default")],2))}}),Ye={class:"flex items-center justify-between"},Ee={class:"space-y-6"},Ue={class:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 rounded-lg p-6"},Oe={class:"flex items-center justify-between"},ze={class:"text-3xl font-bold text-blue-600"},We={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},qe={class:"text-right"},Ze={class:"text-2xl font-bold text-green-600"},Qe={class:"space-y-3"},Ge={class:"flex items-center gap-3"},Je={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center"},Xe={class:"text-sm font-medium text-blue-600"},et={class:"font-medium text-gray-900 dark:text-gray-100"},tt={class:"text-sm text-gray-600 dark:text-gray-400"},st={class:"text-right"},at={class:"font-semibold text-gray-900 dark:text-gray-100"},lt={class:"flex items-center gap-1 mt-1"},ot={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",style:{width:"60px"}},rt={class:"flex items-center justify-between mb-4"},nt={class:"flex items-center gap-2"},it={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},dt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},ct={class:"flex items-center justify-between mb-3"},ut={class:"font-semibold text-gray-900 dark:text-gray-100"},pt={class:"flex items-center gap-2"},mt={class:"text-green-600 text-sm font-medium"},gt={class:"border-t pt-4"},ft={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},yt={key:0},bt={key:1},ht=q({__name:"SalesPredictionWidget",props:{salesData:{}},setup(A){ye.register(be,he,ve,_e,xe,we,ke,$e);const g=A,v=B(!1),y=B("monthly"),H=m(()=>{const s=new Date;return s.setDate(s.getDate()+1),s}),f=B([]),R=m(()=>f.value.length?f.value.reduce((t,l)=>t+(l.confidence??.7),0)/f.value.length:.7),k=m(()=>f.value.slice(0,7).map(s=>s.predicted_sales)),N=m(()=>{var s;return((s=f.value[0])==null?void 0:s.predicted_sales)??0}),F=m(()=>f.value.length>=30?f.value.slice(0,30).reduce((s,t)=>s+t.predicted_sales,0):f.value.length>0?f.value.reduce((t,l)=>t+l.predicted_sales,0)/f.value.length*30:0),K=m(()=>Math.max(0,Math.min(25,(R.value-.6)*100))),i=B(!1),d=m(()=>{if(!g.salesData||g.salesData.length===0)return new Map;const s=new Map;return g.salesData.forEach(t=>{let l;if(typeof t.date=="string"?t.date.includes("T")?l=new Date(t.date):l=new Date(t.date+"T00:00:00"):l=new Date(t.date),isNaN(l.getTime()))return;const n=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,u=l.toLocaleDateString("en-US",{month:"short",year:"numeric"});if(s.has(n)){const w=s.get(n);w.sales+=t.sales}else s.set(n,{sales:t.sales,date:u,sortKey:n,isHistorical:!0})}),s}),c=m(()=>{if(y.value==="yearly"){const s=new Map;return f.value.forEach((t,l)=>{const u=L(l).getFullYear().toString(),w=u;if(s.has(u)){const _=s.get(u);_.sales+=t.predicted_sales}else s.set(u,{sales:t.predicted_sales,date:u,sortKey:w,isHistorical:!1})}),Array.from(s.values()).sort((t,l)=>t.sortKey.localeCompare(l.sortKey)).map(t=>({label:t.date,sales:t.sales,isHistorical:t.isHistorical}))}else{const s=new Map;d.value.forEach((n,u)=>{s.set(u,{...n})}),f.value.forEach((n,u)=>{const w=L(u),_=`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}`,Q=w.toLocaleDateString("en-US",{month:"short",year:"numeric"});if(!s.has(_))s.set(_,{sales:n.predicted_sales,date:Q,sortKey:_,isHistorical:!1});else{const ne=s.get(_);ne.isHistorical||(ne.sales+=n.predicted_sales)}});const t=new Date().getFullYear();return[{key:`${t}-09`,label:"Sep "+t},{key:`${t}-10`,label:"Oct "+t},{key:`${t}-11`,label:"Nov "+t}].forEach(n=>{s.has(n.key)||s.set(n.key,{sales:0,date:n.label,sortKey:n.key,isHistorical:!0})}),Array.from(s.values()).sort((n,u)=>n.sortKey.localeCompare(u.sortKey)).map(n=>({label:n.date,sales:n.sales,isHistorical:n.isHistorical}))}}),$=m(()=>y.value==="yearly"||y.value==="monthly"?(c.value.filter(s=>s.isHistorical),c.value.filter(s=>!s.isHistorical),{labels:c.value.map(s=>s.label),datasets:[{label:y.value==="yearly"?"Historical & Predicted Yearly Sales":"Historical & Predicted Monthly Sales",data:c.value.map(s=>s.sales),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4,pointBackgroundColor:c.value.map(s=>s.isHistorical?"rgb(16, 185, 129)":"rgb(59, 130, 246)"),pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5},{label:"Confidence Range",data:c.value.map(s=>s.isHistorical?s.sales:s.sales*.95),borderColor:"rgba(59, 130, 246, 0.3)",backgroundColor:"rgba(59, 130, 246, 0.05)",fill:!1,tension:.4,borderDash:[5,5],pointRadius:0}]}):{labels:k.value.map((s,t)=>{const l=L(t);return T(l).split(" ")[1]}),datasets:[{label:"Predicted Sales",data:k.value,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(59, 130, 246)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5},{label:"Confidence Range",data:k.value.map(s=>s*.95),borderColor:"rgba(59, 130, 246, 0.3)",backgroundColor:"rgba(59, 130, 246, 0.05)",fill:!1,tension:.4,borderDash:[5,5],pointRadius:0}]}),S=m(()=>{const s=y.value==="yearly"||y.value==="monthly"?c.value.map(t=>t.sales):k.value;return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(t){return`${t.dataset.label}: ${C(t.parsed.y)}`}}}},scales:{y:{beginAtZero:!1,min:Math.min(...s,0),max:Math.max(...s,1)*1.1,grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{callback:function(t){return C(t)},font:{size:11}}},x:{grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{font:{size:11}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}}),D=m(()=>Math.max(...k.value,0));m(()=>k.value.map((t,l)=>{const n=l/6*100,u=100-t/D.value*100;return`${n},${u}`}).join(" ")),m(()=>k.value.map((s,t)=>{const l=t/6*100,n=100-s/D.value*100;return{x:l,y:n}}));function C(s){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}function T(s){return s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function re(s){return s.toLocaleDateString("en-US",{weekday:"short"})}function L(s){const t=new Date;return t.setDate(t.getDate()+s+1),t}function Z(s){const t=Math.max(...k.value,0);return t>0?s/t*100:0}return fe(async()=>{var s;try{const t=await fetch("/sales/predictions?period=month&days_ahead=30",{headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`Failed to fetch predictions: ${t.status}`);const l=await t.json();i.value=!!((s=l==null?void 0:l.model_info)!=null&&s.note),f.value=Array.isArray(l==null?void 0:l.predictions)?l.predictions:[]}catch(t){i.value=!0,f.value=[],console.error(t)}}),(s,t)=>(b(),X(o(P),null,{default:r(()=>[a(o(I),null,{default:r(()=>[e("div",Ye,[a(o(j),{class:"flex items-center gap-2"},{default:r(()=>[a(o(V),{class:"w-5 h-5 text-blue-600"}),t[1]||(t[1]=x(" Sales Prediction "))]),_:1,__:[1]})])]),_:1}),e("div",{class:ee(["overflow-hidden transition-all duration-300 ease-in-out",{"max-h-0":v.value,"max-h-[2000px]":!v.value}])},[a(o(M),null,{default:r(()=>[e("div",Ee,[e("div",Ue,[e("div",Oe,[e("div",null,[t[2]||(t[2]=e("h4",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," Tomorrow's Prediction ",-1)),e("p",ze,p(C(N.value)),1),e("p",We," Expected sales for "+p(T(H.value)),1)]),e("div",qe,[t[3]||(t[3]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Confidence",-1)),e("div",Ze,p((R.value*100).toFixed(0))+"% ",1)])])]),e("div",null,[t[4]||(t[4]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Next 7 Days Forecast",-1)),e("div",Qe,[(b(!0),h(W,null,z(k.value,(l,n)=>(b(),h("div",{key:n,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[e("div",Ge,[e("div",Je,[e("span",Xe,p(n+1),1)]),e("div",null,[e("p",et,p(T(L(n))),1),e("p",tt,p(re(L(n))),1)])]),e("div",st,[e("p",at,p(C(l)),1),e("div",lt,[e("div",ot,[e("div",{class:"h-full bg-blue-500 rounded-full transition-all duration-300",style:ae({width:Z(l)+"%"})},null,4)])])])]))),128))])]),e("div",null,[e("div",rt,[t[5]||(t[5]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100"},"Sales Forecast Trend",-1)),e("div",nt,[a(o(oe),{class:"w-4 h-4 text-muted-foreground"}),a(o(le),{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=l=>y.value=l),options:[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],placeholder:"Select period",class:"w-32"},null,8,["modelValue"])])]),e("div",it,[a(o(Se),{data:$.value,options:S.value,height:"200px"},null,8,["data","options"])])]),e("div",null,[t[7]||(t[7]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Monthly Trend",-1)),e("div",dt,[e("div",ct,[t[6]||(t[6]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Predicted Monthly Revenue",-1)),e("span",ut,p(C(F.value)),1)]),e("div",pt,[a(o(V),{class:"w-4 h-4 text-green-600"}),e("span",mt," +"+p(K.value.toFixed(1))+"% vs current month ",1)])])]),e("div",gt,[e("div",ft,[i.value?(b(),h("span",yt,"Using sample data")):(b(),h("span",bt,"Live predictions")),t[8]||(t[8]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),e("span",null,"Ready")],-1))])])])]),_:1})],2)]),_:1}))}}),vt={class:"flex items-center justify-between"},_t={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},xt={class:"bg-indigo-50 dark:bg-indigo-950/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-4"},wt={class:"flex items-center justify-between"},kt={class:"bg-emerald-50 dark:bg-emerald-950/20 border border-emerald-200 dark:border-emerald-800 rounded-lg p-4"},$t={class:"flex items-center justify-between"},St={class:"bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4"},Ct={class:"flex items-center justify-between"},Dt={class:"mb-6"},Pt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Mt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Tt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Bt={class:"space-y-3"},At={class:"flex items-center gap-3"},Ht={class:"w-8 h-8 bg-indigo-100 dark:bg-indigo-900/20 rounded-full flex items-center justify-center"},Ft={class:"text-sm font-medium text-indigo-600"},Lt={class:"font-medium text-gray-900 dark:text-gray-100"},Vt={class:"text-right"},Rt={class:"font-semibold text-gray-900 dark:text-gray-100"},jt={class:"text-sm text-gray-600 dark:text-gray-400"},It={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Nt={class:"space-y-3"},Kt={class:"flex items-center gap-2"},Yt={class:"text-sm text-gray-700 dark:text-gray-300"},Et={class:"flex items-center gap-2"},Ut={class:"w-16 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Ot={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},zt=q({__name:"ProductSalesTrendWidget",props:{salesByDate:{},topProducts:{}},setup(A){ye.register(be,he,ve,_e,xe,we,ke,$e);const g=B(!1),v=A,y=m(()=>{const i=new Date,d=[];for(let c=6;c>=0;c--){const $=new Date(i);$.setDate($.getDate()-c);const S=$.toISOString().split("T")[0],D=v.salesByDate.find(C=>C.date===S);d.push({date:S,dateObj:$,sales:D?D.sales:0})}return d}),H=m(()=>({labels:y.value.map(i=>i.dateObj.toLocaleDateString("en-US",{weekday:"short"})),datasets:[{label:"Daily Sales",data:y.value.map(i=>i.sales),borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(99, 102, 241)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5}]})),f=m(()=>{const i=Math.max(...y.value.map(c=>c.sales),0);if(i===0)return 100;const d=Math.ceil(i/50)*50;return Math.max(d,100)}),R=m(()=>{const i=Math.max(...y.value.map(c=>c.sales),0);return i===0?50:Math.ceil(i/50)*50>=400?100:50}),k=m(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(i){return i.datasetIndex===0?`${i.dataset.label}: ${i.parsed.y} units`:`${i.dataset.label}: ${i.parsed.y} units`}}}},scales:{y:{beginAtZero:!0,min:0,suggestedMax:f.value,grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{stepSize:R.value,font:{size:11}}},x:{grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{font:{size:11}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}})),N=m(()=>v.topProducts.map(i=>({name:i.name,units:i.total_quantity,revenue:i.total_revenue}))),F=[{name:"High Performance",percentage:35,color:"#10B981"},{name:"Medium Performance",percentage:45,color:"#3B82F6"},{name:"Low Performance",percentage:20,color:"#F59E0B"}];m(()=>{const i=y.value,d=Math.max(...i.map(S=>S.sales),1),c=0;return i.map((S,D)=>{const C=D/Math.max(1,i.length-1)*100,T=100-((S.sales-c)/(d-c)*80+10);return`${C},${T}`}).join(" ")}),m(()=>{const i=y.value,d=Math.max(...i.map($=>$.sales),1),c=0;return i.map(($,S)=>{const D=S/Math.max(1,i.length-1)*100,C=100-(($.sales-c)/(d-c)*80+10);return{x:D,y:C}})});function K(i){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(i)}return(i,d)=>(b(),X(o(P),null,{default:r(()=>[a(o(I),null,{default:r(()=>[e("div",vt,[a(o(j),{class:"flex items-center gap-2"},{default:r(()=>[a(o(J),{class:"w-5 h-5 text-indigo-600"}),d[0]||(d[0]=x(" Product Sales Trend "))]),_:1,__:[0]})])]),_:1}),e("div",{class:ee(["overflow-hidden transition-all duration-300 ease-in-out",{"max-h-0":g.value,"max-h-[2000px]":!g.value}])},[a(o(M),null,{default:r(()=>[e("div",_t,[e("div",xt,[e("div",wt,[d[1]||(d[1]=e("div",null,[e("p",{class:"text-sm font-medium text-indigo-600 dark:text-indigo-400"},"Total Products Sold"),e("p",{class:"text-2xl font-bold text-indigo-700 dark:text-indigo-300"},"8,456")],-1)),a(o(J),{class:"w-8 h-8 text-indigo-600"})]),d[2]||(d[2]=e("p",{class:"text-xs text-indigo-600 dark:text-indigo-400 mt-1"},"+15% from last month",-1))]),e("div",kt,[e("div",$t,[d[3]||(d[3]=e("div",null,[e("p",{class:"text-sm font-medium text-emerald-600 dark:text-emerald-400"},"Top Product"),e("p",{class:"text-lg font-bold text-emerald-700 dark:text-emerald-300"},"Ink Cartridge")],-1)),a(o(Le),{class:"w-8 h-8 text-emerald-600"})]),d[4]||(d[4]=e("p",{class:"text-xs text-emerald-600 dark:text-emerald-400 mt-1"},"1,247 units sold",-1))]),e("div",St,[e("div",Ct,[d[5]||(d[5]=e("div",null,[e("p",{class:"text-sm font-medium text-amber-600 dark:text-amber-400"},"Avg Daily Sales"),e("p",{class:"text-2xl font-bold text-amber-700 dark:text-amber-300"},"282")],-1)),a(o(V),{class:"w-8 h-8 text-amber-600"})]),d[6]||(d[6]=e("p",{class:"text-xs text-amber-600 dark:text-amber-400 mt-1"},"+8% from last week",-1))])]),e("div",Dt,[d[7]||(d[7]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Product Sales Trend (Last 7 Days)",-1)),e("div",Pt,[a(o(Se),{data:H.value,options:k.value,height:"200px"},null,8,["data","options"])])]),e("div",Mt,[e("div",null,[d[8]||(d[8]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Top Selling Products",-1)),e("div",Tt,[e("div",Bt,[(b(!0),h(W,null,z(N.value,c=>(b(),h("div",{key:c.name,class:"flex items-center justify-between"},[e("div",At,[e("div",Ht,[e("span",Ft,p(c.name.charAt(0)),1)]),e("div",null,[e("p",Lt,p(c.name),1)])]),e("div",Vt,[e("p",Rt,p(c.units)+" units",1),e("p",jt,p(K(c.revenue)),1)])]))),128))])])]),e("div",null,[d[9]||(d[9]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Product Performance",-1)),e("div",It,[e("div",Nt,[(b(),h(W,null,z(F,c=>e("div",{key:c.name,class:"flex items-center justify-between"},[e("div",Kt,[e("div",{class:"w-3 h-3 rounded-full",style:ae({backgroundColor:c.color})},null,4),e("span",Yt,p(c.name),1)]),e("div",Et,[e("div",Ut,[e("div",{class:"h-full rounded-full transition-all duration-300",style:ae({width:c.percentage+"%",backgroundColor:c.color})},null,4)]),e("span",Ot,p(c.percentage)+"%",1)])])),64))])])])])]),_:1})],2)]),_:1}))}}),Wt={class:"dashboard-wrapper"},qt={class:"dashboard-header"},Zt={class:"dashboard-filters"},Qt={class:"filter-group"},Gt={class:"filter-label"},Jt={key:0,class:"date-range-group"},Xt={class:"date-input-group"},es={class:"date-input-group"},ts={class:"metrics-grid",style:{"grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))"}},ss={class:"metric-header"},as={class:"metric-info"},ls={class:"metric-label-group"},os={class:"metric-value"},rs={class:"metric-header"},ns={class:"metric-info"},is={class:"metric-label-group"},ds={class:"metric-value"},cs={class:"metric-icon-wrapper metric-icon-green"},us={class:"metric-header"},ps={class:"metric-info"},ms={class:"metric-label-group"},gs={class:"metric-value"},fs={class:"metric-icon-wrapper metric-icon-yellow"},ys={class:"metric-header"},bs={class:"metric-info"},hs={class:"metric-label-group"},vs={class:"metric-value"},_s={class:"metric-icon-wrapper metric-icon-orange"},xs={class:"metric-header"},ws={class:"metric-info"},ks={class:"metric-label-group"},$s={class:"metric-value"},Ss={class:"metric-icon-wrapper metric-icon-purple"},Cs={class:"analytics-section"},Ds={class:"section-header",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem"}},Ps={class:"filter-group",style:{display:"flex","align-items":"center",gap:"0.5rem"}},Ms={class:"filter-label",style:{display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.875rem","font-weight":"500",color:"var(--foreground)"}},Ts={class:"analytics-tabs-wrapper"},Bs={class:"category-section"},As={key:0,class:"empty-state"},Hs={key:1},Fs={key:0,class:"text-xs text-muted-foreground text-center mt-2"},Ls={class:"tables-grid"},Vs={class:"table-wrapper"},Rs={class:"data-table"},js={class:"table-cell table-cell-bold"},Is={class:"table-cell table-cell-right"},Ns={class:"table-cell table-cell-right table-cell-highlight"},Ks={class:"table-wrapper"},Ys={class:"data-table"},Es={class:"table-cell"},Us=["href"],Os={class:"table-cell"},zs={class:"table-cell table-cell-right table-cell-bold"},Ws={class:"table-cell table-cell-center"},_a=q({__name:"Dashboard",props:{salesData:{},topProducts:{},salesByDate:{},salesByCategory:{},recentInvoices:{},filters:{},lowStockProducts:{}},setup(A){var L,Z;const g=A,v=B(g.filters.period),y=B(g.filters.start_date),H=B(g.filters.end_date),f=B("monthly"),R=[{title:"Dashboard",href:"/dashboard"}],k=[{value:"week",label:"Last 7 Days"},{value:"month",label:"Last 30 Days"},{value:"quarter",label:"Last 3 Months"},{value:"year",label:"Last 12 Months"},{value:"custom",label:"Choose Dates"}];function N(){ie.get("/dashboard",{period:v.value,start_date:y.value,end_date:H.value},{preserveState:!0,replace:!0})}Pe([v,y,H],()=>{N()});const F=Me(),K=Array.isArray((L=F.props.auth)==null?void 0:L.userRoles)&&F.props.auth.userRoles.includes("Admin"),i=Array.isArray((Z=F.props.auth)==null?void 0:Z.userRoles)&&F.props.auth.userRoles.includes("Staff")&&!K;fe(()=>{const s=new Date().toISOString().split("T")[0],t=localStorage.getItem("lowStockAlertLastShown");if(i&&g.lowStockProducts&&g.lowStockProducts.length>0&&t!==s){const l=g.lowStockProducts.slice(0,10),n=g.lowStockProducts.length>10?g.lowStockProducts.length-10:0,u=l.map(_=>`
                <tr style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 8px 12px; font-weight: 600;">${_.name}</td>
                    <td style="padding: 8px 12px; color: #6b7280;">${_.category}</td>
                    <td style="padding: 8px 12px; color: #6b7280;">${_.SKU||"N/A"}</td>
                    <td style="padding: 8px 12px; text-align: center;">
                        <span style="color: #dc2626; font-weight: bold; font-size: 14px;">${_.stock}</span>
                    </td>
                </tr>
            `).join(""),w=n>0?`<p style="margin-top: 10px; text-align: center; color: #6b7280;"><strong>And ${n} more product(s) with low stock.</strong></p>`:"";je.fire({icon:"warning",title:"Low Stock Alert",html:`
                <p style="margin-bottom: 15px;">There are <strong>${g.lowStockProducts.length}</strong> product(s) with low stock (≤10 units):</p>
                <div style="max-height: 400px; overflow-y: auto; margin: 15px 0;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                        <thead>
                            <tr style="background-color: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">Product Name</th>
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">Category</th>
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">SKU</th>
                                <th style="padding: 10px 12px; text-align: center; font-weight: 600; color: #374151;">Stock</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${u}
                        </tbody>
                    </table>
                </div>
                ${w}
                <p style="margin-top: 15px; color: #6b7280;">Please review and restock these items soon.</p>
            `,confirmButtonText:"View Products",confirmButtonColor:"#8f5be8",showCancelButton:!0,cancelButtonText:"Dismiss",cancelButtonColor:"#6b7280",width:"700px"}).then(_=>{localStorage.setItem("lowStockAlertLastShown",s),_.isConfirmed&&ie.visit("/products?low_stock=1")})}});const d=m(()=>{if(f.value==="yearly"){const s=new Map;return g.salesByDate.forEach(t=>{const n=new Date(t.date).getFullYear().toString();if(s.has(n)){const u=s.get(n);u.sales+=t.sales,u.invoices+=t.invoices}else s.set(n,{sales:t.sales,invoices:t.invoices,date:n,sortKey:n})}),Array.from(s.values()).sort((t,l)=>t.sortKey.localeCompare(l.sortKey))}else{const s=new Map;g.salesByDate.forEach(n=>{let u;if(typeof n.date=="string"?n.date.includes("T")?u=new Date(n.date):u=new Date(n.date+"T00:00:00"):u=new Date(n.date),isNaN(u.getTime())){console.warn("Invalid date:",n.date);return}const w=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`,_=u.toLocaleDateString("en-US",{month:"short",year:"numeric"});if(s.has(w)){const Q=s.get(w);Q.sales+=n.sales,Q.invoices+=n.invoices}else s.set(w,{sales:n.sales,invoices:n.invoices,date:_,sortKey:w})});const t=new Date().getFullYear();return[{key:`${t}-09`,label:"Sep "+t},{key:`${t}-10`,label:"Oct "+t},{key:`${t}-11`,label:"Nov "+t}].forEach(n=>{s.has(n.key)||s.set(n.key,{sales:0,invoices:0,date:n.label,sortKey:n.key})}),Array.from(s.values()).sort((n,u)=>n.sortKey.localeCompare(u.sortKey))}}),c=m(()=>({labels:d.value.map(s=>s.date),datasets:[{label:f.value==="yearly"?"Yearly Sales":"Monthly Sales",data:d.value.map(s=>s.sales),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:f.value==="yearly"?"Yearly Invoices":"Monthly Invoices",data:d.value.map(s=>s.invoices),borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!1,tension:.4,yAxisID:"y1"}]})),$=m(()=>({plugins:{title:{display:!0,text:"Sales Trend"},legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Sales Amount (₱)"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Number of Invoices"},grid:{drawOnChartArea:!1}}}})),S=m(()=>[...g.salesByCategory].sort((s,t)=>t.total_revenue-s.total_revenue).slice(0,5)),D=m(()=>({labels:S.value.map(s=>s.category_name),datasets:[{data:S.value.map(s=>s.total_revenue),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]})),C=m(()=>({plugins:{title:{display:!0,text:"Sales by Category"},legend:{position:"bottom"}}}));m(()=>({labels:g.topProducts.map(s=>s.name),datasets:[{label:"Revenue",data:g.topProducts.map(s=>s.total_revenue),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgb(59, 130, 246)",borderWidth:1}]})),m(()=>({plugins:{title:{display:!0,text:"Top Products by Revenue"},legend:{display:!1}},scales:{y:{title:{display:!0,text:"Revenue (₱)"}}}}));function T(s){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(s)}return B(!1),[{id:1,title:"New Order Received",message:"Order #1234 has been placed for ₱2,500",time:"2 minutes ago",type:"order",read:!1},{id:2,title:"Low Stock Alert",message:"Ink (brother 500 C, Cyan) is running low on stock",time:"15 minutes ago",type:"alert",read:!1},{id:3,title:"Sales Target Achieved",message:"Congratulations! You've reached 85% of your monthly sales target",time:"1 hour ago",type:"success",read:!0},{id:4,title:"Payment Received",message:"Payment of ₱1,800 has been received for Invoice #5678",time:"2 hours ago",type:"payment",read:!0}].filter(s=>!s.read).length,(s,t)=>(b(),X(He,{breadcrumbs:R},{default:r(()=>[a(o(Te),{title:"Dashboard"}),a(o(Ke),null,{default:r(()=>[e("div",Wt,[e("div",qt,[t[7]||(t[7]=e("div",null,[e("h1",{class:"dashboard-title"},"Dashboard"),e("p",{class:"dashboard-subtitle"},"View your business performance at a glance")],-1)),e("div",Zt,[e("div",Qt,[e("label",Gt,[a(o(Ie),{class:"w-4 h-4"}),t[4]||(t[4]=x(" View Period "))]),a(o(le),{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),options:k,placeholder:"Choose time period",class:"period-select"},null,8,["modelValue"])]),v.value==="custom"?(b(),h("div",Jt,[e("div",Xt,[t[5]||(t[5]=e("label",{class:"date-label"},"Start Date",-1)),ce(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>y.value=l),type:"date",class:"date-input"},null,512),[[ue,y.value]])]),e("div",es,[t[6]||(t[6]=e("label",{class:"date-label"},"End Date",-1)),ce(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>H.value=l),type:"date",class:"date-input"},null,512),[[ue,H.value]])])])):de("",!0)])]),t[39]||(t[39]=e("div",{class:"metrics-section"},[e("h2",{class:"section-title"},"Your Business Overview"),e("p",{class:"section-description"},"Quick summary of your sales performance")],-1)),e("div",ts,[a(P,{class:"metric-card"},{default:r(()=>[a(M,{class:"metric-card-content"},{default:r(()=>[e("div",ss,[e("div",as,[e("div",ls,[t[9]||(t[9]=e("span",{class:"metric-label"},"Total Revenue",-1)),a(o(Y),null,{default:r(()=>[a(o(E),{"as-child":""},{default:r(()=>[a(o(O),{class:"help-icon"})]),_:1}),a(o(U),null,{default:r(()=>t[8]||(t[8]=[e("p",null,"The total amount of money you've earned from all sales",-1)])),_:1,__:[8]})]),_:1})]),e("p",os,p(T(s.salesData.total_sales)),1),t[10]||(t[10]=e("p",{class:"metric-description"},"All sales combined",-1))]),t[11]||(t[11]=e("div",{class:"metric-icon-wrapper metric-icon-blue"},[e("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 119.43 122.88",class:"metric-icon"},[e("path",{d:"M118.45,51l1,1-.74,9.11H99A40.52,40.52,0,0,1,81.88,78.43q-11.44,6.28-27.71,7h-15l.5,37.43H21.42l.74-36.94-.24-24.87H1L0,59.84.74,51H21.92l-.25-15.26H1l-1-1,.74-9.11H21.67L21.42.25,63.29,0Q78.8,0,88.65,6.53T102,25.61h16.5l1,1.23-.74,8.87h-15v3.94A53.17,53.17,0,0,1,102.44,51ZM39.65,25.61H81.26Q74.85,14,58.61,13.3L39.89,14l-.24,11.57ZM39.4,51H83.23a39.51,39.51,0,0,0,1.23-9.6,46.17,46.17,0,0,0-.24-5.66H39.65L39.4,51ZM58.61,71.91q12.56-2.72,19.21-10.84H39.4l-.25,10.1,19.46.74Z"})])],-1))])]),_:1})]),_:1}),a(P,{class:"metric-card"},{default:r(()=>[a(M,{class:"metric-card-content"},{default:r(()=>[e("div",rs,[e("div",ns,[e("div",is,[t[13]||(t[13]=e("span",{class:"metric-label"},"Total Invoices",-1)),a(o(Y),null,{default:r(()=>[a(o(E),{"as-child":""},{default:r(()=>[a(o(O),{class:"help-icon"})]),_:1}),a(o(U),null,{default:r(()=>t[12]||(t[12]=[e("p",null,"The number of sales transactions you've completed",-1)])),_:1,__:[12]})]),_:1})]),e("p",ds,p(s.salesData.total_invoices),1),t[14]||(t[14]=e("p",{class:"metric-description"},"Sales transactions",-1))]),e("div",cs,[a(o(pe),{class:"metric-icon"})])])]),_:1})]),_:1}),a(P,{class:"metric-card"},{default:r(()=>[a(M,{class:"metric-card-content"},{default:r(()=>[e("div",us,[e("div",ps,[e("div",ms,[t[16]||(t[16]=e("span",{class:"metric-label"},"Average Sale Amount",-1)),a(o(Y),null,{default:r(()=>[a(o(E),{"as-child":""},{default:r(()=>[a(o(O),{class:"help-icon"})]),_:1}),a(o(U),null,{default:r(()=>t[15]||(t[15]=[e("p",null,"The average amount customers spend per transaction",-1)])),_:1,__:[15]})]),_:1})]),e("p",gs,p(T(s.salesData.average_order_value)),1),t[17]||(t[17]=e("p",{class:"metric-description"},"Per transaction",-1))]),e("div",fs,[a(o(V),{class:"metric-icon"})])])]),_:1})]),_:1}),a(P,{class:"metric-card"},{default:r(()=>[a(M,{class:"metric-card-content"},{default:r(()=>[e("div",ys,[e("div",bs,[e("div",hs,[t[19]||(t[19]=e("span",{class:"metric-label"},"Awaiting Payment",-1)),a(o(Y),null,{default:r(()=>[a(o(E),{"as-child":""},{default:r(()=>[a(o(O),{class:"help-icon"})]),_:1}),a(o(U),null,{default:r(()=>t[18]||(t[18]=[e("p",null,"Invoices that are still waiting to be paid",-1)])),_:1,__:[18]})]),_:1})]),e("p",vs,p(s.salesData.pending_invoices),1),t[20]||(t[20]=e("p",{class:"metric-description"},"Need attention",-1))]),e("div",_s,[a(o(Ne),{class:"metric-icon"})])])]),_:1})]),_:1}),a(P,{class:"metric-card"},{default:r(()=>[a(M,{class:"metric-card-content"},{default:r(()=>[e("div",xs,[e("div",ws,[e("div",ks,[t[22]||(t[22]=e("span",{class:"metric-label"},"Pending Orders",-1)),a(o(Y),null,{default:r(()=>[a(o(E),{"as-child":""},{default:r(()=>[a(o(O),{class:"help-icon"})]),_:1}),a(o(U),null,{default:r(()=>t[21]||(t[21]=[e("p",null,"Customer orders waiting for staff approval",-1)])),_:1,__:[21]})]),_:1})]),e("p",$s,p(s.salesData.pending_orders),1),t[23]||(t[23]=e("p",{class:"metric-description"},"Require review",-1))]),e("div",Ss,[a(o(Ae),{class:"metric-icon"})])])]),_:1})]),_:1})]),e("div",Cs,[e("div",Ds,[t[25]||(t[25]=e("div",null,[e("h2",{class:"section-title"},"Sales Trends & Insights"),e("p",{class:"section-description"},"Track how your sales are performing over time")],-1)),e("div",Ps,[e("label",Ms,[a(o(oe),{class:"w-4 h-4"}),t[24]||(t[24]=x(" View Period "))]),a(o(le),{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=l=>f.value=l),options:[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],placeholder:"Select period",class:"period-select",style:{"min-width":"120px"}},null,8,["modelValue"])])])]),e("div",Ts,[a(o(Ve),{defaultValue:"sales-trend",class:"analytics-tabs-full"},{default:r(()=>[a(o(Re),{class:"tabs-list-full"},{default:r(()=>[a(o(te),{value:"sales-trend",class:"tab-trigger-full"},{default:r(()=>[a(o(V),{class:"tab-icon"}),t[26]||(t[26]=x(" Your Sales Trend "))]),_:1,__:[26]}),a(o(te),{value:"sales-prediction",class:"tab-trigger-full"},{default:r(()=>[a(o(V),{class:"tab-icon"}),t[27]||(t[27]=x(" Sales Prediction "))]),_:1,__:[27]}),a(o(te),{value:"product-trend",class:"tab-trigger-full"},{default:r(()=>[a(o(oe),{class:"tab-icon"}),t[28]||(t[28]=x(" Product Sales Trend "))]),_:1,__:[28]})]),_:1}),a(o(se),{value:"sales-trend",class:"tab-content-full"},{default:r(()=>[a(P,{class:"chart-card"},{default:r(()=>[a(I,null,{default:r(()=>[a(j,{class:"chart-title"},{default:r(()=>[a(o(V),{class:"chart-title-icon"}),t[29]||(t[29]=x(" Your Sales Trend "))]),_:1,__:[29]}),a(G,null,{default:r(()=>[x(" See how your "+p(f.value==="yearly"?"yearly":"monthly")+" sales and number of transactions change over time ",1)]),_:1})]),_:1}),a(M,null,{default:r(()=>[a(me,{type:"line",data:c.value,options:$.value,height:"350px"},null,8,["data","options"])]),_:1})]),_:1})]),_:1}),a(o(se),{value:"sales-prediction",class:"tab-content-full"},{default:r(()=>[a(ht,{"sales-data":s.salesByDate},null,8,["sales-data"])]),_:1}),a(o(se),{value:"product-trend",class:"tab-content-full"},{default:r(()=>[a(zt,{"sales-by-date":s.salesByDate,"top-products":s.topProducts},null,8,["sales-by-date","top-products"])]),_:1})]),_:1})]),e("div",Bs,[a(P,{class:"chart-card"},{default:r(()=>[a(I,null,{default:r(()=>[a(j,{class:"chart-title"},{default:r(()=>[a(o(J),{class:"chart-title-icon"}),t[30]||(t[30]=x(" Sales by Product Category "))]),_:1,__:[30]}),a(G,null,{default:r(()=>t[31]||(t[31]=[x(" See which product categories bring in the most revenue ")])),_:1,__:[31]})]),_:1}),a(M,null,{default:r(()=>[g.salesByCategory.length===0?(b(),h("div",As,t[32]||(t[32]=[e("p",{class:"empty-title"},"No category data for the selected period",-1),e("p",{class:"empty-subtitle"},"Try expanding the date range or confirming there are paid invoices.",-1)]))):(b(),h("div",Hs,[a(me,{type:"doughnut",data:D.value,options:C.value,height:"300px"},null,8,["data","options"]),g.salesByCategory.length>5?(b(),h("p",Fs," Showing top 5 categories ("+p(g.salesByCategory.length)+" total) ",1)):de("",!0)]))]),_:1})]),_:1})]),t[40]||(t[40]=e("div",{class:"section-header"},[e("h2",{class:"section-title"},"Product Performance & Recent Activity"),e("p",{class:"section-description"},"Your best-selling products and latest transactions")],-1)),e("div",Ls,[a(P,{class:"table-card"},{default:r(()=>[a(I,null,{default:r(()=>[a(j,{class:"table-title"},{default:r(()=>[a(o(J),{class:"table-title-icon"}),t[33]||(t[33]=x(" Best-Selling Products "))]),_:1,__:[33]}),a(G,null,{default:r(()=>t[34]||(t[34]=[x(" Products that have generated the most revenue ")])),_:1,__:[34]})]),_:1}),a(M,null,{default:r(()=>[e("div",Vs,[e("table",Rs,[t[35]||(t[35]=e("thead",null,[e("tr",{class:"table-header-row"},[e("th",{class:"table-header"},"Product Name"),e("th",{class:"table-header table-header-right"},"Units Sold"),e("th",{class:"table-header table-header-right"},"Revenue")])],-1)),e("tbody",null,[(b(!0),h(W,null,z(s.topProducts,l=>(b(),h("tr",{key:l.id,class:"table-row"},[e("td",js,p(l.name),1),e("td",Is,p(l.total_quantity.toLocaleString()),1),e("td",Ns,p(T(l.total_revenue)),1)]))),128))])])])]),_:1})]),_:1}),a(P,{class:"table-card"},{default:r(()=>[a(I,null,{default:r(()=>[a(j,{class:"table-title"},{default:r(()=>[a(o(pe),{class:"table-title-icon"}),t[36]||(t[36]=x(" Recent Transactions "))]),_:1,__:[36]}),a(G,null,{default:r(()=>t[37]||(t[37]=[x(" Your most recent sales and invoices ")])),_:1,__:[37]})]),_:1}),a(M,null,{default:r(()=>[e("div",Ks,[e("table",Ys,[t[38]||(t[38]=e("thead",null,[e("tr",{class:"table-header-row"},[e("th",{class:"table-header"},"Invoice #"),e("th",{class:"table-header"},"Customer"),e("th",{class:"table-header table-header-right"},"Amount"),e("th",{class:"table-header table-header-center"},"Status")])],-1)),e("tbody",null,[(b(!0),h(W,null,z(s.recentInvoices,l=>(b(),h("tr",{key:l.id,class:"table-row"},[e("td",Es,[e("a",{href:`/invoices/${l.id}`,class:"invoice-link"}," #"+p(l.id),9,Us)]),e("td",Os,p(l.customer_name),1),e("td",zs,p(T(l.total_amount)),1),e("td",Ws,[e("span",{class:ee({"status-badge":!0,"status-paid":l.status==="paid","status-pending":l.status==="pending","status-cancelled":l.status==="cancelled"})},p(l.status.charAt(0).toUpperCase()+l.status.slice(1)),3)])]))),128))])])])]),_:1})]),_:1})])])]),_:1})]),_:1}))}});export{_a as default};
