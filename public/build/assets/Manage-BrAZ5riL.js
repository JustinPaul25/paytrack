import{d as w,v as B,c as _,o as a,w as r,a as i,b as s,u as n,g as $,W as c,h as d,e as u,F as R,r as S,t as p,S as z,f as v,n as N}from"./app-BJGGIgA8.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-6OmCq4tp.js";import{_ as I,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-DPB8yWHX.js";import{_ as A,a as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-DvxTgNYv.js";import{_ as y}from"./index-riohrRak.js";import{S as b}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-CX_goT8l.js";import"./useForwardPropsEmits-CZzI8B5e.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-MrJHOVsW.js";import"./Teleport-MSIji786.js";import"./RovingFocusGroup-gSG5KO_4.js";import"./VisuallyHidden-BC0AEIfW.js";import"./DialogPortal-Dpb7jdpY.js";import"./x-BjkU5bBK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DSD56j4j.js";import"./chevron-down-B83M1Caq.js";import"./chevron-right-CjvrEjDl.js";const T={class:"flex items-center justify-between my-6"},V={class:"flex gap-2"},q=["value"],F={key:0,class:"py-8 text-center text-sm text-gray-500"},M={key:0},H={class:"mt-3"},L={key:1},W={key:1},j={class:"min-w-full divide-y divide-border"},Q={class:"px-4 py-2 font-medium"},G={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"flex items-center gap-2"},O={key:0,class:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",title:"Damaged items will not be returned to stock"},U={class:"px-4 py-2"},X={class:"px-4 py-2 font-medium"},Y={class:"px-4 py-2"},Z={class:"px-4 py-2"},ee={class:"flex gap-2"},be=w({__name:"Manage",setup(te){const f=B(),m=f.props.filters||{};function g(l){b.fire({title:"Mark as Processed",html:`
        <div style="text-align:left">
            <label style="display:block;margin-bottom:4px;font-size:12px">Method</label>
            <select id="method" class="swal2-input" style="width:100%">
                <option value="cash">cash</option>
                <option value="bank_transfer">bank_transfer</option>
                <option value="e-wallet">e-wallet</option>
                <option value="credit_note">credit_note</option>
            </select>
            <label style="display:block;margin:10px 0 4px;font-size:12px">Reference #</label>
            <input id="ref" class="swal2-input" placeholder="Reference number (optional)" />
            <label style="display:block;margin:10px 0 4px;font-size:12px">Notes</label>
            <textarea id="notes" class="swal2-textarea" placeholder="Notes (optional)"></textarea>
        </div>
        `,showCancelButton:!0,confirmButtonText:"Save",preConfirm:()=>{const e=document.getElementById("method").value,t=document.getElementById("ref").value,o=document.getElementById("notes").value;return{refund_method:e,reference_number:t||void 0,notes:o||void 0}}}).then(e=>{e.isConfirmed&&c.post(route("refunds.process",l),e.value,{preserveScroll:!0})})}function h(l){const e=f.props.refunds.data.find(o=>o.id===l),t=(e==null?void 0:e.is_damaged)??!1;b.fire({title:"Complete refund",html:`
        <div style="text-align:left">
            ${t?'<div style="background:#fef3c7;border:1px solid #fbbf24;padding:8px;border-radius:4px;margin-bottom:12px;font-size:13px;color:#92400e;"><strong>⚠️ Damaged Items:</strong> These items will not be returned to inventory stock.</div>':""}
            <label style="display:flex;align-items:center;gap:8px;">
                <input id="return" type="checkbox" ${t?"":"checked"} ${t?"disabled":""} />
                Return to stock
            </label>
            ${t?'<p style="font-size:11px;color:#6b7280;margin-top:4px;margin-left:24px;">Disabled for damaged items</p>':""}
            <label style="display:block;margin:10px 0 4px;font-size:12px">Inspection notes</label>
            <textarea id="notes" class="swal2-textarea" placeholder="Notes (optional)"></textarea>
        </div>
        `,showCancelButton:!0,confirmButtonText:"Complete",confirmButtonColor:"#10b981",preConfirm:()=>{const o=t?!1:document.getElementById("return").checked,x=document.getElementById("notes").value;return{return_to_stock:o,notes:x||void 0}}}).then(o=>{o.isConfirmed&&c.post(route("refunds.complete",l),o.value,{preserveScroll:!0})})}function k(l){b.fire({title:"Cancel this refund?",text:"This will mark the refund as cancelled. A short reason is required.",icon:"warning",showCancelButton:!0,confirmButtonText:"Cancel refund",confirmButtonColor:"#ef4444",input:"textarea",inputLabel:"Reason (required)",inputPlaceholder:"Provide a brief reason...",inputAttributes:{"aria-label":"Reason (required)"},inputValidator:e=>{if(!e||!e.trim())return"Please provide a brief reason."}}).then(e=>{e.isConfirmed&&c.post(route("refunds.cancel",l),{review_notes:e.value},{preserveScroll:!0})})}function C(l){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(l)}return(l,e)=>(a(),_(P,null,{default:r(()=>[i(n($),{title:"Refunds"}),s("div",T,[e[3]||(e[3]=s("h1",{class:"text-2xl font-bold"},"Refunds",-1)),s("div",V,[s("select",{class:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:n(m).status||"all",onChange:e[0]||(e[0]=t=>{const o=t.target.value==="all"?"":t.target.value;n(c).get(l.route("refunds.index"),o?{status:o}:{},{preserveState:!0,replace:!0})})},e[2]||(e[2]=[s("option",{value:"all"},"All",-1),s("option",{value:"approved"},"Approved",-1),s("option",{value:"processed"},"Processed",-1),s("option",{value:"completed"},"Completed",-1),s("option",{value:"cancelled"},"Cancelled",-1)]),40,q)])]),i(I,null,{default:r(()=>[i(A,null,{default:r(()=>[i(E,null,{default:r(()=>e[4]||(e[4]=[d("Refunds")])),_:1,__:[4]})]),_:1}),i(D,null,{default:r(()=>[n(f).props.refunds.data.length?(a(),u("div",W,[s("table",j,[e[10]||(e[10]=s("thead",null,[s("tr",null,[s("th",{class:"px-4 py-2 text-left"},"Refund #"),s("th",{class:"px-4 py-2 text-left"},"Invoice"),s("th",{class:"px-4 py-2 text-left"},"Product"),s("th",{class:"px-4 py-2 text-left"},"Qty"),s("th",{class:"px-4 py-2 text-left"},"Amount"),s("th",{class:"px-4 py-2 text-left"},"Status"),s("th",{class:"px-4 py-2 text-left"},"Actions")])],-1)),s("tbody",null,[(a(!0),u(R,null,S(n(f).props.refunds.data,t=>{var o;return a(),u("tr",{key:t.id,class:"hover:bg-muted"},[s("td",Q,p(t.refund_number),1),s("td",G,[i(n(z),{href:l.route("invoices.show",t.invoice_id),class:"text-blue-500 underline"},{default:r(()=>[d("#"+p(t.invoice_id),1)]),_:2},1032,["href"])]),s("td",J,[s("div",K,[s("span",null,p(((o=t.product)==null?void 0:o.name)||"—"),1),t.is_damaged?(a(),u("span",O," ⚠️ Damaged ")):v("",!0)])]),s("td",U,p(t.quantity_refunded),1),s("td",X,p(C(t.refund_amount)),1),s("td",Y,[s("span",{class:N(["px-2 py-1 rounded-full text-xs font-medium",{"bg-blue-100 text-blue-800":t.status==="approved","bg-yellow-100 text-yellow-800":t.status==="processed","bg-green-100 text-green-800":t.status==="completed","bg-red-100 text-red-800":t.status==="cancelled"}])},p(t.status),3)]),s("td",Z,[s("div",ee,[t.status==="approved"||t.status==="processed"?(a(),_(n(y),{key:0,size:"sm",variant:"outline",onClick:x=>g(t.id)},{default:r(()=>e[7]||(e[7]=[d(" Process ")])),_:2,__:[7]},1032,["onClick"])):v("",!0),t.status==="approved"||t.status==="processed"?(a(),_(n(y),{key:1,size:"sm",variant:"default",onClick:x=>h(t.id)},{default:r(()=>e[8]||(e[8]=[d(" Complete ")])),_:2,__:[8]},1032,["onClick"])):v("",!0),t.status!=="completed"&&t.status!=="cancelled"?(a(),_(n(y),{key:2,size:"sm",variant:"destructive",onClick:x=>k(t.id)},{default:r(()=>e[9]||(e[9]=[d(" Cancel ")])),_:2,__:[9]},1032,["onClick"])):v("",!0)])])])}),128))])])])):(a(),u("div",F,[n(m).status&&n(m).status!==""&&n(m).status!=="all"?(a(),u("div",M,[e[6]||(e[6]=d(" No refunds found for the selected filter. ")),s("div",H,[i(n(y),{variant:"outline",onClick:e[1]||(e[1]=t=>n(c).get(l.route("refunds.index"),{},{preserveState:!0,replace:!0}))},{default:r(()=>e[5]||(e[5]=[d(" Clear filters ")])),_:1,__:[5]})])])):(a(),u("div",L," No refunds found. "))]))]),_:1})]),_:1})]),_:1}))}});export{be as default};
