import{d as re,D as de,m as H,p as D,s as te,c as k,o as m,u,w as l,a as i,b as e,h as p,t as r,e as c,f,x as I,y as T,E as ue,v as me,g as ce,F as L,S as ee,n as V,r as Q,W as pe}from"./app-D813Jm8L.js";import{_ as h}from"./index-CviG3rkw.js";import{p as fe,q as ve,r as _e,_ as ye}from"./AppLayout.vue_vue_type_script_setup_true_lang-BXVphV0c.js";import{_ as $,a as M}from"./CardContent.vue_vue_type_script_setup_true_lang-Bd0-TUSa.js";import{_ as B,a as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-CWkeiFc_.js";import{_ as ge}from"./Select.vue_vue_type_script_setup_true_lang-CPhyC29e.js";import{_ as xe}from"./SearchSelect.vue_vue_type_script_setup_true_lang-Qi6ME5Qz.js";import{e as be,a as ke,b as we,c as he,d as De,_ as Ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CY3VMW03.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-BknKjZ5m.js";import{_ as Pe}from"./PhoneInput.vue_vue_type_script_setup_true_lang-DATLNVih.js";import{S as X}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as F}from"./InputError.vue_vue_type_script_setup_true_lang-CtJMeWTd.js";import{D as Re}from"./DeliveryRouteMap-GWeKhJkT.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fdfc5f8_lang-CV5BHZq7.js";import"./useForwardPropsEmits-HaL_en7z.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CNZgJ1qe.js";import"./createLucideIcon-DbTVWaVY.js";import"./Teleport-DZRgFwKg.js";import"./RovingFocusGroup-CmZI1JuB.js";import"./VisuallyHidden-CSeGT6UP.js";import"./x-Bm3VYXWf.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-JzmBcxvg.js";import"./chevron-right-By_NXETe.js";import"./Input.vue_vue_type_script_setup_true_lang-BEc-VNKq.js";import"./search-DpmRAyJc.js";import"./vue-leaflet.es-BkjkFR40.js";import"./marker-icon-2x-1TirABJh.js";import"./marker-icon-B6h-nX3D.js";import"./marker-shadow-B9CpECYs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Se={class:"space-y-4"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Me=["min"],Be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Fe={class:"relative"},qe={key:0,class:"text-xs text-muted-foreground mt-1"},Ve={key:0},oe=50,ie=10,le=50,Ee=re({__name:"DeliveryFormModal",props:{open:{type:Boolean},invoice:{},customers:{}},emits:["update:open"],setup(K,{emit:n}){var W,x,N;const _=K,q=n,a=de({customer_id:_.invoice.customer_id,invoice_id:_.invoice.id,delivery_address:((W=_.invoice.customer)==null?void 0:W.address)||"",contact_person:((x=_.invoice.customer)==null?void 0:x.name)||"",contact_phone:P((N=_.invoice.customer)==null?void 0:N.phone)||"",delivery_date:"",delivery_time:"",status:"pending",notes:"",delivery_fee:""}),C=H(null),E=H(!1);function S(v){if(!v||v<=0)return le;const s=oe+v*ie;return Math.max(s,le)}function w(v){if(C.value=v,!a.delivery_fee||a.delivery_fee==="0"||a.delivery_fee==="0.00"){E.value=!0;const s=S(v);a.delivery_fee=s.toFixed(2),E.value=!1}}const U=new Date().toISOString().split("T")[0];function P(v){if(!v)return"";let s=v.replace(/[^0-9]/g,"");return s.startsWith("63")?s=s.substring(2):s.startsWith("0")&&(s=s.substring(1)),s=s.substring(0,10),s.length===10?"+63"+s:v}const Y=D(()=>[{value:null,label:"Select customer"},..._.customers.map(v=>({value:v.id,label:`${v.name}${v.company_name?` (${v.company_name})`:""}`}))]),j=[{value:"09:00 AM - 12:00 PM",label:"09:00 AM - 12:00 PM"},{value:"12:00 PM - 03:00 PM",label:"12:00 PM - 03:00 PM"},{value:"03:00 PM - 06:00 PM",label:"03:00 PM - 06:00 PM"},{value:"06:00 PM - 09:00 PM",label:"06:00 PM - 09:00 PM"},{value:"Custom",label:"Custom"}],O=D(()=>{if(!a.customer_id)return null;const v=_.customers.find(g=>g.id===a.customer_id);if(!(v!=null&&v.location))return null;let s=v.location;if(typeof s=="string")try{s=JSON.parse(s)}catch{return console.warn("Failed to parse customer location string:",s),null}let y=s.lat,b=s.lng;return typeof y=="string"&&(y=parseFloat(y)),typeof b=="string"&&(b=parseFloat(b)),typeof y=="number"&&typeof b=="number"&&!isNaN(y)&&!isNaN(b)&&y>=-90&&y<=90&&b>=-180&&b<=180&&(y!=0||b!=0)?{lat:y,lng:b}:null}),z=D(()=>a.customer_id&&_.customers.find(v=>v.id===a.customer_id)||null);te(()=>a.customer_id,v=>{if(v){const s=_.customers.find(y=>y.id===v);s!=null&&s.address&&!a.delivery_address&&(a.delivery_address=s.address),C.value=null,E.value===!1&&(a.delivery_fee="")}}),te(()=>_.open,v=>{var s,y,b;v&&(a.reset(),a.customer_id=_.invoice.customer_id,a.invoice_id=_.invoice.id,a.delivery_address=((s=_.invoice.customer)==null?void 0:s.address)||"",a.contact_person=((y=_.invoice.customer)==null?void 0:y.name)||"",a.contact_phone=P((b=_.invoice.customer)==null?void 0:b.phone)||"",a.clearErrors(),C.value=null)});function J(){a.contact_phone&&(a.contact_phone=P(a.contact_phone));const v=/^\+63\d{10}$/;if(a.contact_phone&&!v.test(a.contact_phone)){a.setError("contact_phone","Enter a valid 10-digit Philippine mobile number.");return}a.status="pending",a.post(route("deliveries.store"),{preserveScroll:!0,onSuccess:()=>{X.fire({toast:!0,position:"top-end",icon:"success",title:"Delivery created successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),q("update:open",!1),a.reset()}})}function G(){q("update:open",!1),a.clearErrors()}return(v,s)=>(m(),k(u(be),{open:v.open,"onUpdate:open":s[10]||(s[10]=y=>q("update:open",y))},{default:l(()=>[i(u(Ce),{class:"max-w-4xl max-h-[90vh] overflow-y-auto"},{default:l(()=>{var y,b;return[i(u(ke),null,{default:l(()=>[i(u(we),null,{default:l(()=>s[11]||(s[11]=[p("Create Delivery")])),_:1,__:[11]}),i(u(he),null,{default:l(()=>[p(" Create a delivery for invoice "+r(v.invoice.reference_number),1)]),_:1})]),_:1}),e("form",{onSubmit:s[9]||(s[9]=ue(g=>J(),["prevent"])),class:"space-y-6"},[e("div",Se,[e("div",$e,[e("div",null,[i(R,{for:"customer_id"},{default:l(()=>s[12]||(s[12]=[p("Customer")])),_:1,__:[12]}),i(u(xe),{modelValue:u(a).customer_id,"onUpdate:modelValue":s[0]||(s[0]=g=>u(a).customer_id=g),options:Y.value,placeholder:"Select customer","search-placeholder":"Search customers...",class:"mt-1",required:""},null,8,["modelValue","options"]),i(F,{message:u(a).errors.customer_id},null,8,["message"])]),e("div",null,[i(R,{for:"delivery_date"},{default:l(()=>s[13]||(s[13]=[p("Delivery Date")])),_:1,__:[13]}),I(e("input",{"onUpdate:modelValue":s[1]||(s[1]=g=>u(a).delivery_date=g),type:"date",id:"delivery_date",min:u(U),class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",required:""},null,8,Me),[[T,u(a).delivery_date]]),i(F,{message:u(a).errors.delivery_date},null,8,["message"])])]),e("div",null,[i(R,{for:"delivery_address"},{default:l(()=>s[14]||(s[14]=[p("Delivery Address")])),_:1,__:[14]}),I(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=g=>u(a).delivery_address=g),id:"delivery_address",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter complete delivery address",required:""},null,512),[[T,u(a).delivery_address]]),i(F,{message:u(a).errors.delivery_address},null,8,["message"])]),e("div",Be,[e("div",null,[i(R,{for:"contact_person"},{default:l(()=>s[15]||(s[15]=[p("Contact Person")])),_:1,__:[15]}),I(e("input",{"onUpdate:modelValue":s[3]||(s[3]=g=>u(a).contact_person=g),type:"text",id:"contact_person",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"Enter contact person name",required:""},null,512),[[T,u(a).contact_person]]),i(F,{message:u(a).errors.contact_person},null,8,["message"])]),e("div",null,[i(R,{for:"contact_phone"},{default:l(()=>s[16]||(s[16]=[p("Contact Phone")])),_:1,__:[16]}),i(Pe,{modelValue:u(a).contact_phone,"onUpdate:modelValue":s[4]||(s[4]=g=>u(a).contact_phone=g),id:"contact_phone",placeholder:"XXXXXXXXXX",required:"",class:"mt-1"},null,8,["modelValue"]),i(F,{message:u(a).errors.contact_phone},null,8,["message"])])]),e("div",Ae,[e("div",null,[i(R,{for:"delivery_time"},{default:l(()=>s[17]||(s[17]=[p("Delivery Time")])),_:1,__:[17]}),i(u(ge),{modelValue:u(a).delivery_time,"onUpdate:modelValue":s[5]||(s[5]=g=>u(a).delivery_time=g),options:j,placeholder:"Select delivery time",class:"mt-1",required:""},null,8,["modelValue"]),i(F,{message:u(a).errors.delivery_time},null,8,["message"])]),e("div",null,[i(R,{for:"delivery_fee"},{default:l(()=>s[18]||(s[18]=[p("Delivery Fee")])),_:1,__:[18]}),e("div",Fe,[I(e("input",{"onUpdate:modelValue":s[6]||(s[6]=g=>u(a).delivery_fee=g),type:"number",id:"delivery_fee",min:"0",step:"0.01",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"0.00",required:""},null,512),[[T,u(a).delivery_fee]]),C.value!==null?(m(),c("button",{key:0,type:"button",onClick:s[7]||(s[7]=g=>u(a).delivery_fee=S(C.value).toFixed(2)),class:"absolute right-2 top-[calc(0.25rem+1px)] px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",title:"Recalculate based on distance"}," Recalculate ")):f("",!0)]),C.value!==null?(m(),c("div",qe," Distance: "+r(C.value)+" km • Fee: ₱"+r(oe.toFixed(2))+" base + ₱"+r(ie.toFixed(2))+"/km ",1)):f("",!0),i(F,{message:u(a).errors.delivery_fee},null,8,["message"])])]),e("div",null,[i(R,{for:"notes"},{default:l(()=>s[19]||(s[19]=[p("Notes")])),_:1,__:[19]}),I(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=g=>u(a).notes=g),id:"notes",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter any additional notes"},null,512),[[T,u(a).notes]]),i(F,{message:u(a).errors.notes},null,8,["message"])])]),O.value||u(a).delivery_address||(y=z.value)!=null&&y.address?(m(),c("div",Ve,[i(R,{class:"mb-2 block"},{default:l(()=>s[20]||(s[20]=[p("Delivery Route")])),_:1,__:[20]}),i(Re,{"customer-location":O.value,"delivery-address":u(a).delivery_address||((b=z.value)==null?void 0:b.address),"map-height":"300px",onDistanceCalculated:w},null,8,["customer-location","delivery-address"])])):f("",!0),i(u(De),{class:"gap-2"},{default:l(()=>[i(u(h),{type:"button",variant:"ghost",onClick:G},{default:l(()=>s[21]||(s[21]=[p("Cancel")])),_:1,__:[21]}),i(u(h),{type:"submit",variant:"default",disabled:u(a).processing},{default:l(()=>s[22]||(s[22]=[p(" Create Delivery ")])),_:1,__:[22]},8,["disabled"])]),_:1})],32)]}),_:1})]),_:1},8,["open"]))}}),Ue={key:0,class:"mb-4 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-md"},je={class:"flex items-start"},Ne={class:"ml-3 flex-1"},Ie={class:"mt-2 text-sm text-blue-700"},Te={class:"font-semibold"},Le={class:"flex items-center justify-between my-6"},Xe={class:"text-2xl font-bold"},Oe={class:"flex gap-2"},ze={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},We={class:"lg:col-span-2 space-y-6"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},He={class:"text-lg font-semibold"},Ke={key:0},Ye={key:1},Je={key:0,class:"text-xs font-normal text-green-600 ml-2"},Ge={key:2},Ze={key:3},et={key:0,class:"mt-4"},tt={class:"mt-1"},st={class:"overflow-x-auto"},nt={class:"min-w-full divide-y divide-border"},ot={class:"px-4 py-2"},it={class:"font-medium"},lt={class:"text-sm text-gray-500"},rt={class:"px-4 py-2"},at={class:"px-4 py-2"},dt={class:"px-4 py-2 font-medium"},ut={class:"border-t"},mt={class:"px-4 py-2 font-medium"},ct={key:0},pt={colspan:"3",class:"px-4 py-2 text-right text-sm text-gray-500 italic"},ft={class:"border-t"},vt={class:"px-4 py-2 font-bold text-lg"},_t={key:1,class:"border-t bg-yellow-50"},yt={class:"px-4 py-2 font-medium text-orange-700"},gt={key:2,class:"border-t-2 border-blue-500 bg-blue-50"},xt={colspan:"3",class:"px-4 py-2 text-right font-bold text-lg text-blue-700"},bt={class:"flex items-center justify-end gap-2"},kt={key:0},wt={key:1},ht={class:"px-4 py-2 font-bold text-lg text-blue-700"},Dt={class:"space-y-6"},Ct={class:"flex justify-between items-center"},Pt={class:"font-medium"},Rt={class:"flex justify-between items-center"},St={class:"font-medium text-orange-600"},$t={class:"border-t pt-3 mt-3"},Mt={class:"flex justify-between items-center"},Bt={key:0,class:"mt-2 text-xs text-green-600 flex items-center gap-1"},At={class:"space-y-3"},Ft={class:"flex items-center justify-between mb-2"},qt={class:"font-medium"},Vt={class:"text-sm text-gray-600 space-y-1"},Et={key:0},Ut={key:1},jt={class:"text-xs mt-0.5"},Nt={key:2},It={key:3},Tt={key:4},Lt={key:5,class:"mt-2 pt-2 border-t"},Xt={class:"text-xs mt-0.5"},Ot={key:6,class:"text-xs text-gray-500 mt-2"},zt={key:7,class:"mt-2 pt-2 border-t"},Wt={class:"space-y-3"},Qt={class:"flex items-center justify-between"},Ht={class:"font-medium"},Kt={class:"text-sm text-gray-600"},Yt={key:0},Jt={class:"text-xs text-gray-500"},Gt={key:1,class:"mt-1 text-xs text-red-500"},Zt={key:2,class:"text-xs"},es=["href"],ts={class:"space-y-3"},ss={class:"flex items-center justify-between"},ns={class:"font-medium"},os={class:"text-sm text-gray-600"},is={key:0},ls={class:"text-xs text-gray-500"},rs={class:"space-y-3"},as={class:"flex items-center gap-3"},ds={class:"font-medium"},us={key:0},ms={key:1},cs={key:2},ps={class:"text-sm"},fs={class:"mt-3"},vs={class:"text-sm"},Ws=re({__name:"Show",props:{invoice:{},refunds:{},refundRequests:{},deliveries:{},customers:{},netBalance:{},totalRefunded:{}},setup(K){var se,ne;const n=K,_=me(),q=Array.isArray((se=_.props.auth)==null?void 0:se.userRoles)&&_.props.auth.userRoles.includes("Customer"),a=Array.isArray((ne=_.props.auth)==null?void 0:ne.userRoles)&&_.props.auth.userRoles.includes("Staff"),C=D(()=>Array.isArray(n.refundRequests)&&n.refundRequests.some(d=>d.status==="pending")),E=D(()=>{var d;return a&&((d=n.invoice.customer)==null?void 0:d.email)&&n.invoice.payment_status!=="paid"}),S=H(!1),w=D(()=>n.netBalance!==void 0?n.netBalance:n.invoice.total_amount),U=D(()=>n.totalRefunded!==void 0?n.totalRefunded:0),P=D(()=>U.value>0),Y=D(()=>P.value&&Math.abs(w.value-n.invoice.total_amount)>.01),j=D(()=>n.invoice.payment_method==="credit"),O=[{title:"Invoices",href:"/invoices"},{title:n.invoice.reference_number,href:`/invoices/${n.invoice.id}`}];function z(d){switch(d){case"draft":return"bg-gray-100 text-gray-800";case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function J(d){if(d==="pending"&&n.deliveries&&n.deliveries.length>0&&n.deliveries.some(o=>o.status==="pending"))return"Out for Delivery";switch(d){case"draft":return"Draft";case"pending":return"Pending";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return d.charAt(0).toUpperCase()+d.slice(1)}}function G(d){switch(d){case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function W(d){switch(d){case"pending":return"Out for Delivery";case"completed":return"Delivered";case"cancelled":return"Cancelled";default:return d.charAt(0).toUpperCase()+d.slice(1)}}function x(d){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(d)}function N(d){return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function v(d){return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function s(d){const t=[];return d.address&&t.push(d.address),d.purok&&t.push(`Purok ${d.purok}`),d.barangay&&t.push(`Barangay ${d.barangay}`),d.city_municipality&&t.push(d.city_municipality),d.province&&t.push(d.province),t.length>0?t.join(", "):""}function y(){window.print()}function b(d){if(!d.media||d.media.length===0)return null;const t=d.media.find(o=>o.mime_type.startsWith("image/"));return t?t.thumb_url||t.original_url:null}function g(d){return d.name.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().slice(0,2)}const Z=H(!1);function ae(){!E.value||S.value||(S.value=!0,pe.post(route("invoices.sendPaymentReminder",n.invoice.id),{},{preserveScroll:!0,onSuccess:()=>{const d=_.props.flash;d!=null&&d.success&&X.fire({toast:!0,position:"top-end",icon:"success",title:d.success,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},onError:d=>{const t=_.props.flash,o=(t==null?void 0:t.error)||"Failed to send payment reminder. Please try again.";X.fire({toast:!0,position:"top-end",icon:"error",title:o,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},onFinish:()=>{S.value=!1}}))}return te(()=>_.props.flash,d=>{d!=null&&d.success?X.fire({toast:!0,position:"top-end",icon:"success",title:d.success,showConfirmButton:!1,timer:3e3,timerProgressBar:!0}):d!=null&&d.error&&X.fire({toast:!0,position:"top-end",icon:"error",title:d.error,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}),(d,t)=>(m(),k(ye,{breadcrumbs:O},{default:l(()=>[i(u(ce),{title:n.invoice.reference_number},null,8,["title"]),Y.value&&j.value?(m(),c("div",Ue,[e("div",je,[t[7]||(t[7]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Ne,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-blue-800"},"Credit Invoice with Refunds",-1)),e("div",Ie,[e("p",null,[t[2]||(t[2]=p(" Original invoice amount: ")),e("strong",null,r(x(n.invoice.total_amount)),1),t[3]||(t[3]=e("br",null,null,-1)),t[4]||(t[4]=p(" Total refunded: ")),e("strong",null,r(x(U.value)),1),t[5]||(t[5]=e("br",null,null,-1)),e("span",Te,"Amount Due: "+r(x(w.value)),1)])])])])])):f("",!0),e("div",Le,[e("h1",Xe,r(n.invoice.reference_number),1),e("div",Oe,[i(u(h),{variant:"outline",onClick:y},{default:l(()=>t[8]||(t[8]=[p("Download PDF")])),_:1,__:[8]}),i(u(h),{variant:"outline",onClick:y},{default:l(()=>t[9]||(t[9]=[p("Print")])),_:1,__:[9]}),E.value?(m(),k(u(h),{key:0,variant:"default",onClick:ae,disabled:S.value},{default:l(()=>[p(r(S.value?"Sending...":"Send Payment Reminder"),1)]),_:1},8,["disabled"])):f("",!0),!u(q)&&n.invoice.status!=="completed"?(m(),k(u(h),{key:1,variant:"default",onClick:t[0]||(t[0]=o=>Z.value=!0)},{default:l(()=>t[10]||(t[10]=[p("Create Delivery")])),_:1,__:[10]})):f("",!0),u(q)&&n.invoice.status==="completed"?(m(),c(L,{key:2},[C.value?(m(),k(u(h),{key:1,variant:"outline",disabled:"",title:"You already have a pending refund request for this invoice."},{default:l(()=>t[12]||(t[12]=[p(" Request Pending ")])),_:1,__:[12]})):(m(),k(u(ee),{key:0,href:d.route("refundRequests.create",n.invoice.id)},{default:l(()=>[i(u(h),{variant:"default"},{default:l(()=>t[11]||(t[11]=[p("Request Refund")])),_:1,__:[11]})]),_:1},8,["href"]))],64)):f("",!0),i(u(ee),{href:d.route("invoices.index")},{default:l(()=>[i(u(h),{variant:"ghost"},{default:l(()=>t[13]||(t[13]=[p("Back")])),_:1,__:[13]})]),_:1},8,["href"])])]),e("div",ze,[e("div",We,[i($,null,{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[14]||(t[14]=[p("Invoice Information")])),_:1,__:[14]})]),_:1}),i(M,null,{default:l(()=>[e("div",Qe,[e("div",null,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-gray-500"},"Reference Number",-1)),e("p",He,r(n.invoice.reference_number),1)]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-gray-500"},"Date Created",-1)),e("p",null,r(N(n.invoice.created_at)),1)]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),e("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",z(n.invoice.status)])},r(J(n.invoice.status)),3)]),e("div",null,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Method",-1)),e("p",null,r(n.invoice.payment_method.replace("_"," ")),1)]),n.invoice.payment_status?(m(),c("div",Ke,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Status",-1)),e("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",n.invoice.payment_status==="paid"?"bg-green-100 text-green-800":n.invoice.payment_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},r(n.invoice.payment_status),3)])):f("",!0),P.value&&j.value?(m(),c("div",Ye,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-gray-500"},"Amount Due",-1)),e("p",{class:V(["font-semibold text-lg",w.value<=0?"text-green-600":"text-orange-600"])},[p(r(x(w.value))+" ",1),w.value<=0?(m(),c("span",Je,"(Fully Settled)")):f("",!0)],2)])):f("",!0),n.invoice.due_date?(m(),c("div",Ge,[t[21]||(t[21]=e("label",{class:"text-sm font-medium text-gray-500"},"Due Date",-1)),e("p",null,r(v(n.invoice.due_date)),1)])):f("",!0),n.invoice.payment_reference?(m(),c("div",Ze,[t[22]||(t[22]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Reference",-1)),e("p",null,r(n.invoice.payment_reference),1)])):f("",!0)]),n.invoice.notes?(m(),c("div",et,[t[23]||(t[23]=e("label",{class:"text-sm font-medium text-gray-500"},"Notes",-1)),e("p",tt,r(n.invoice.notes),1)])):f("",!0)]),_:1})]),_:1}),i($,null,{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[24]||(t[24]=[p("Invoice Items")])),_:1,__:[24]})]),_:1}),i(M,null,{default:l(()=>[e("div",st,[e("table",nt,[t[30]||(t[30]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Product"),e("th",{class:"px-4 py-2 text-left"},"Quantity"),e("th",{class:"px-4 py-2 text-left"},"Price"),e("th",{class:"px-4 py-2 text-left"},"Total")])],-1)),e("tbody",null,[(m(!0),c(L,null,Q(n.invoice.invoice_items,o=>(m(),c("tr",{key:o.id,class:"hover:bg-muted"},[e("td",ot,[e("div",null,[e("div",it,r(o.product.name),1),e("div",lt,"SKU: "+r(o.product.id),1)])]),e("td",rt,r(o.quantity),1),e("td",at,r(x(o.price)),1),e("td",dt,r(x(o.total)),1)]))),128))]),e("tfoot",null,[e("tr",ut,[t[25]||(t[25]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-medium"},"Subtotal:",-1)),e("td",mt,r(x(n.invoice.subtotal_amount)),1)]),n.invoice.vat_rate>0?(m(),c("tr",ct,[e("td",pt," VAT ("+r(n.invoice.vat_rate)+"%) included in prices ",1),t[26]||(t[26]=e("td",{class:"px-4 py-2 text-sm text-gray-500 italic"},"—",-1))])):f("",!0),e("tr",ft,[t[27]||(t[27]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-bold text-lg"},"Total Amount:",-1)),e("td",vt,r(x(n.invoice.total_amount)),1)]),P.value?(m(),c("tr",_t,[t[28]||(t[28]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-medium text-orange-700"},[e("div",{class:"flex items-center justify-end gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),p(" Total Refunded: ")])],-1)),e("td",yt,"-"+r(x(U.value)),1)])):f("",!0),P.value?(m(),c("tr",gt,[e("td",xt,[e("div",bt,[t[29]||(t[29]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),j.value?(m(),c("span",kt,"Amount Due:")):(m(),c("span",wt,"Net Balance:"))])]),e("td",ht,r(x(w.value)),1)])):f("",!0)])])])]),_:1})]),_:1})]),e("div",Dt,[P.value&&j.value?(m(),k($,{key:0,class:"border-blue-200 bg-blue-50"},{default:l(()=>[i(B,null,{default:l(()=>[i(A,{class:"text-blue-800"},{default:l(()=>t[31]||(t[31]=[p("Payment Summary")])),_:1,__:[31]})]),_:1}),i(M,{class:"space-y-3"},{default:l(()=>[e("div",Ct,[t[32]||(t[32]=e("span",{class:"text-sm text-gray-600"},"Original Amount:",-1)),e("span",Pt,r(x(n.invoice.total_amount)),1)]),e("div",Rt,[t[33]||(t[33]=e("span",{class:"text-sm text-gray-600"},"Total Refunded:",-1)),e("span",St,"-"+r(x(U.value)),1)]),e("div",$t,[e("div",Mt,[t[34]||(t[34]=e("span",{class:"text-sm font-semibold text-blue-800"},"Amount Due:",-1)),e("span",{class:V(["text-lg font-bold",w.value<=0?"text-green-600":"text-blue-700"])},r(x(w.value)),3)]),w.value<=0?(m(),c("div",Bt,t[35]||(t[35]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),p(" Fully settled ")]))):f("",!0)])]),_:1})]),_:1})):f("",!0),n.deliveries&&n.deliveries.length?(m(),k($,{key:1},{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[36]||(t[36]=[p("Deliveries")])),_:1,__:[36]})]),_:1}),i(M,null,{default:l(()=>[e("div",At,[(m(!0),c(L,null,Q(n.deliveries,o=>(m(),c("div",{key:o.id,class:"border rounded-md p-3"},[e("div",Ft,[e("div",qt,"Delivery #"+r(o.id),1),e("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",G(o.status)])},r(W(o.status)),3)]),e("div",Vt,[o.delivery_date?(m(),c("div",Et,[t[37]||(t[37]=e("span",{class:"font-medium"},"Date:",-1)),p(" "+r(o.delivery_date),1)])):f("",!0),o.delivery_time?(m(),c("div",Ut,[t[38]||(t[38]=e("span",{class:"font-medium"},"Time:",-1)),p(" "+r(o.delivery_time),1)])):f("",!0),e("div",null,[t[39]||(t[39]=e("span",{class:"font-medium"},"Address:",-1)),e("p",jt,r(o.delivery_address),1)]),o.contact_person?(m(),c("div",Nt,[t[40]||(t[40]=e("span",{class:"font-medium"},"Contact:",-1)),p(" "+r(o.contact_person),1)])):f("",!0),o.contact_phone?(m(),c("div",It,[t[41]||(t[41]=e("span",{class:"font-medium"},"Phone:",-1)),p(" "+r(o.contact_phone),1)])):f("",!0),o.delivery_fee>0?(m(),c("div",Tt,[t[42]||(t[42]=e("span",{class:"font-medium"},"Fee:",-1)),p(" "+r(x(o.delivery_fee)),1)])):f("",!0),o.notes?(m(),c("div",Lt,[t[43]||(t[43]=e("span",{class:"font-medium"},"Notes:",-1)),e("p",Xt,r(o.notes),1)])):f("",!0),o.created_at?(m(),c("div",Ot," Created: "+r(o.created_at),1)):f("",!0),u(q)?f("",!0):(m(),c("div",zt,[i(u(ee),{href:d.route("deliveries.show",o.id)},{default:l(()=>[i(u(h),{variant:"outline",size:"sm",class:"w-full"},{default:l(()=>t[44]||(t[44]=[p(" View Delivery Details ")])),_:1,__:[44]})]),_:2},1032,["href"])]))])]))),128))])]),_:1})]),_:1})):f("",!0),n.refundRequests&&n.refundRequests.length?(m(),k($,{key:2},{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[45]||(t[45]=[p("Refund Requests")])),_:1,__:[45]})]),_:1}),i(M,null,{default:l(()=>[e("div",Wt,[(m(!0),c(L,null,Q(n.refundRequests,o=>(m(),c("div",{key:o.id,class:"border rounded-md p-3"},[e("div",Qt,[e("div",Ht,r(o.tracking_number),1),e("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":o.status==="pending","bg-green-100 text-green-800":o.status==="approved"||o.status==="converted","bg-red-100 text-red-800":o.status==="rejected"}])},r(o.status),3)]),e("div",Kt,[o.product_name?(m(),c("div",Yt,"Product: "+r(o.product_name),1)):f("",!0),e("div",null,"Qty: "+r(o.quantity),1),e("div",Jt,"Date: "+r(o.created_at),1),o.status==="rejected"&&o.review_notes?(m(),c("div",Gt," Reason: "+r(o.review_notes),1)):f("",!0),o.media_link?(m(),c("div",Zt,[e("a",{href:o.media_link,target:"_blank",class:"text-blue-500 underline"},"Media",8,es)])):f("",!0)])]))),128))])]),_:1})]),_:1})):f("",!0),n.refunds&&n.refunds.length?(m(),k($,{key:3},{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[46]||(t[46]=[p("Refunds")])),_:1,__:[46]})]),_:1}),i(M,null,{default:l(()=>[e("div",ts,[(m(!0),c(L,null,Q(n.refunds,o=>(m(),c("div",{key:o.id,class:"border rounded-md p-3"},[e("div",ss,[e("div",ns,r(o.refund_number),1),e("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":o.status==="approved"||o.status==="completed","bg-yellow-100 text-yellow-800":o.status==="pending","bg-red-100 text-red-800":o.status==="cancelled"}])},r(o.status),3)]),e("div",os,[o.product_name?(m(),c("div",is,"Product: "+r(o.product_name),1)):f("",!0),e("div",null,"Qty: "+r(o.quantity_refunded),1),e("div",null,"Amount: "+r(x(o.refund_amount)),1),e("div",ls,"Date: "+r(o.created_at),1)])]))),128))])]),_:1})]),_:1})):f("",!0),i($,null,{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[47]||(t[47]=[p("Customer Information")])),_:1,__:[47]})]),_:1}),i(M,null,{default:l(()=>[e("div",rs,[e("div",as,[i(fe,{class:"size-12"},{default:l(()=>[b(n.invoice.customer)?(m(),k(ve,{key:0,src:b(n.invoice.customer),alt:n.invoice.customer.name},null,8,["src","alt"])):(m(),k(_e,{key:1},{default:l(()=>[p(r(g(n.invoice.customer)),1)]),_:1}))]),_:1}),e("div",null,[t[48]||(t[48]=e("label",{class:"text-sm font-medium text-gray-500"},"Name",-1)),e("p",ds,r(n.invoice.customer.name),1)])]),n.invoice.customer.company_name?(m(),c("div",us,[t[49]||(t[49]=e("label",{class:"text-sm font-medium text-gray-500"},"Company",-1)),e("p",null,r(n.invoice.customer.company_name),1)])):f("",!0),e("div",null,[t[50]||(t[50]=e("label",{class:"text-sm font-medium text-gray-500"},"Email",-1)),e("p",null,r(n.invoice.customer.email),1)]),n.invoice.customer.phone?(m(),c("div",ms,[t[51]||(t[51]=e("label",{class:"text-sm font-medium text-gray-500"},"Phone",-1)),e("p",null,r(n.invoice.customer.phone),1)])):f("",!0),s(n.invoice.customer)?(m(),c("div",cs,[t[52]||(t[52]=e("label",{class:"text-sm font-medium text-gray-500"},"Address",-1)),e("p",ps,r(s(n.invoice.customer)),1)])):f("",!0)])]),_:1})]),_:1}),i($,null,{default:l(()=>[i(B,null,{default:l(()=>[i(A,null,{default:l(()=>t[53]||(t[53]=[p("Created By")])),_:1,__:[53]})]),_:1}),i(M,null,{default:l(()=>[e("div",null,[t[54]||(t[54]=e("label",{class:"text-sm font-medium text-gray-500"},"User",-1)),e("p",null,r(n.invoice.user.name),1)]),e("div",fs,[t[55]||(t[55]=e("label",{class:"text-sm font-medium text-gray-500"},"Last Updated",-1)),e("p",vs,r(N(n.invoice.updated_at)),1)])]),_:1})]),_:1})])]),n.customers?(m(),k(Ee,{key:1,open:Z.value,"onUpdate:open":t[1]||(t[1]=o=>Z.value=o),invoice:n.invoice,customers:n.customers},null,8,["open","invoice","customers"])):f("",!0)]),_:1}))}});export{Ws as default};
