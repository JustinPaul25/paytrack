import{d as P,x as Q,c as T,a as U,o as A,w as i,b as t,e as r,u,k as C,t as p,q as j,f as a,m as _,v as g,S as E}from"./app-WiUpeBwz.js";import{_ as c}from"./index-Cn_g6VzM.js";import{_ as x}from"./Select.vue_vue_type_script_setup_true_lang-C6cCdH76.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_5601c0ff_lang-DTIP4i8X.js";import{_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-asCoNTCN.js";import{_ as b,a as q}from"./CardContent.vue_vue_type_script_setup_true_lang-C1Ro3lXn.js";import{a as w,_ as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-CL8KIKUs.js";import{_ as N}from"./CardFooter.vue_vue_type_script_setup_true_lang-BpozAbEV.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-CyKS2_tF.js";import{S as y}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as m}from"./InputError.vue_vue_type_script_setup_true_lang--EdPhFmS.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BUpirRbf.js";import"./createLucideIcon-DXTUwZoB.js";import"./RovingFocusGroup-DA_UrK7F.js";import"./VisuallyHidden-CHKbz_EY.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-4xCIPFzj.js";const D={class:"flex items-center justify-between mb-6"},O={class:"text-2xl font-bold"},h={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H=["max"],I={class:"text-xs text-gray-500 mt-1"},K=["disabled"],z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},J={class:"text-lg font-semibold"},L={class:"text-lg font-semibold"},W={class:"text-lg font-semibold"},pe=P({__name:"Edit",props:{refund:{},refundTypes:{},refundMethods:{}},setup(R){const d=R,n=Q({quantity_refunded:d.refund.quantity_refunded,refund_amount:d.refund.refund_amount,refund_type:d.refund.refund_type,refund_method:d.refund.refund_method,reason:d.refund.reason||"",notes:d.refund.notes||"",reference_number:d.refund.reference_number||""}),V=[{title:"Refunds",href:"/refunds"},{title:`Refund ${d.refund.refund_number}`,href:`/refunds/${d.refund.id}`},{title:"Edit Refund",href:`/refunds/${d.refund.id}/edit`}],o=T(()=>{var e;if(!((e=d.refund.invoice)!=null&&e.invoice_items)||!Array.isArray(d.refund.invoice.invoice_items))return 0;const l=d.refund.invoice.invoice_items.find(s=>s.product_id===d.refund.product.id);return(l==null?void 0:l.quantity)||0});function v(){if(n.quantity_refunded){const l=d.refund.product.selling_price;n.refund_amount=n.quantity_refunded*l,n.quantity_refunded>o.value&&(n.quantity_refunded=o.value,n.refund_amount=o.value*l,y.fire({icon:"info",title:"Quantity Adjusted",text:`Quantity has been adjusted to the maximum available (${o.value} units).`,confirmButtonText:"OK",toast:!0,position:"top-end",timer:3e3,timerProgressBar:!0}))}}function S(){n.refund_type==="full"?(n.quantity_refunded=o.value,n.refund_amount=o.value*d.refund.product.selling_price):n.refund_type==="partial"||n.refund_type==="exchange"&&(n.quantity_refunded=o.value,n.refund_amount=0)}function k(){n.quantity_refunded>o.value&&(n.quantity_refunded=o.value,v(),y.fire({icon:"warning",title:"Quantity Auto-Adjusted",text:`Quantity was automatically adjusted to ${o.value} units due to limitations.`,confirmButtonText:"OK"})),n.put(route("refunds.update",d.refund.id),{preserveScroll:!0,onSuccess:()=>{y.fire({toast:!0,position:"top-end",icon:"success",title:"Refund updated successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}})}function B(l){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(l)}return(l,e)=>(A(),U(M,{breadcrumbs:V},{default:i(()=>[t(u(C),{title:"Edit Refund"}),r("div",D,[r("h1",O,"Edit Refund "+p(d.refund.refund_number),1)]),r("form",{onSubmit:e[7]||(e[7]=j(s=>k(),["prevent"])),class:"space-y-6"},[t(b,null,{default:i(()=>[t(w,null,{default:i(()=>[t($,null,{default:i(()=>e[8]||(e[8]=[a("Refund Details")])),_:1,__:[8]})]),_:1}),t(q,{class:"space-y-6"},{default:i(()=>[r("div",h,[r("div",null,[t(f,{for:"refund_type"},{default:i(()=>e[9]||(e[9]=[a("Refund Type")])),_:1,__:[9]}),t(u(x),{modelValue:u(n).refund_type,"onUpdate:modelValue":[e[0]||(e[0]=s=>u(n).refund_type=s),S],options:l.refundTypes,placeholder:"Select refund type",class:"mt-1",required:""},null,8,["modelValue","options"]),t(m,{message:u(n).errors.refund_type},null,8,["message"])]),r("div",null,[t(f,{for:"refund_method"},{default:i(()=>e[10]||(e[10]=[a("Refund Method")])),_:1,__:[10]}),t(u(x),{modelValue:u(n).refund_method,"onUpdate:modelValue":e[1]||(e[1]=s=>u(n).refund_method=s),options:l.refundMethods,placeholder:"Select refund method",class:"mt-1",required:""},null,8,["modelValue","options"]),t(m,{message:u(n).errors.refund_method},null,8,["message"])])]),r("div",F,[r("div",null,[t(f,{for:"quantity_refunded"},{default:i(()=>e[11]||(e[11]=[a("Quantity to Refund")])),_:1,__:[11]}),_(r("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>u(n).quantity_refunded=s),type:"number",id:"quantity_refunded",min:"1",max:o.value,class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",onInput:v,required:""},null,40,H),[[g,u(n).quantity_refunded,void 0,{number:!0}]]),r("div",I," Maximum available: "+p(o.value),1),t(m,{message:u(n).errors.quantity_refunded},null,8,["message"])]),r("div",null,[t(f,{for:"refund_amount"},{default:i(()=>e[12]||(e[12]=[a("Refund Amount")])),_:1,__:[12]}),_(r("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>u(n).refund_amount=s),type:"number",id:"refund_amount",min:"0",step:"0.01",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",disabled:u(n).refund_type==="exchange",required:""},null,8,K),[[g,u(n).refund_amount,void 0,{number:!0}]]),t(m,{message:u(n).errors.refund_amount},null,8,["message"])])]),r("div",z,[r("div",null,[t(f,{for:"reference_number"},{default:i(()=>e[13]||(e[13]=[a("Reference Number")])),_:1,__:[13]}),_(r("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>u(n).reference_number=s),type:"text",id:"reference_number",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"Enter reference number"},null,512),[[g,u(n).reference_number]]),t(m,{message:u(n).errors.reference_number},null,8,["message"])]),r("div",null,[t(f,{for:"reason"},{default:i(()=>e[14]||(e[14]=[a("Reason")])),_:1,__:[14]}),_(r("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>u(n).reason=s),type:"text",id:"reason",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"Enter refund reason",required:""},null,512),[[g,u(n).reason]]),t(m,{message:u(n).errors.reason},null,8,["message"])])]),r("div",null,[t(f,{for:"notes"},{default:i(()=>e[15]||(e[15]=[a("Notes")])),_:1,__:[15]}),_(r("textarea",{id:"notes","onUpdate:modelValue":e[6]||(e[6]=s=>u(n).notes=s),class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Additional notes..."},null,512),[[g,u(n).notes]]),t(m,{message:u(n).errors.notes},null,8,["message"])])]),_:1})]),_:1}),t(b,null,{default:i(()=>[t(w,null,{default:i(()=>[t($,null,{default:i(()=>e[16]||(e[16]=[a("Original Item Details")])),_:1,__:[16]})]),_:1}),t(q,null,{default:i(()=>[r("div",G,[r("div",null,[e[17]||(e[17]=r("label",{class:"text-sm font-medium text-gray-500"},"Product",-1)),r("p",J,p(d.refund.product.name),1)]),r("div",null,[e[18]||(e[18]=r("label",{class:"text-sm font-medium text-gray-500"},"Original Quantity",-1)),r("p",L,p(o.value),1)]),r("div",null,[e[19]||(e[19]=r("label",{class:"text-sm font-medium text-gray-500"},"Original Price",-1)),r("p",W,p(B(d.refund.product.selling_price)),1)])])]),_:1})]),_:1}),t(b,null,{default:i(()=>[t(N,{class:"flex gap-2 justify-end"},{default:i(()=>[t(u(c),{type:"submit",variant:"default"},{default:i(()=>e[20]||(e[20]=[a("Update Refund")])),_:1,__:[20]}),t(u(E),{href:l.route("refunds.show",d.refund.id)},{default:i(()=>[t(u(c),{type:"button",variant:"ghost"},{default:i(()=>e[21]||(e[21]=[a("Cancel")])),_:1,__:[21]})]),_:1},8,["href"])]),_:1})]),_:1})],32)]),_:1}))}});export{pe as default};
