import{d as X,D as N,p as v,s as k,c as E,o as O,w as o,a as r,b as i,u as t,g as B,E as T,e as d,x as p,y as f,S as I}from"./app-DLGUJSur.js";import{_ as g}from"./index-CbeL7bQp.js";import{_ as c}from"./Select.vue_vue_type_script_setup_true_lang-BmMAiM-x.js";import{_ as A}from"./SearchSelect.vue_vue_type_script_setup_true_lang-DODuTYTX.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-TGItx7cK.js";import{_,a as b}from"./CardContent.vue_vue_type_script_setup_true_lang-DGEoivaK.js";import{_ as y,a as x}from"./CardTitle.vue_vue_type_script_setup_true_lang-CA3flqiV.js";import{_ as j}from"./CardFooter.vue_vue_type_script_setup_true_lang-ArF0VZWS.js";import{_ as a}from"./Label.vue_vue_type_script_setup_true_lang-s53qzNoi.js";import{_ as F}from"./PhoneInput.vue_vue_type_script_setup_true_lang-DIcpvEul.js";import{S as J}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as u}from"./InputError.vue_vue_type_script_setup_true_lang-Biwlb9eG.js";import{D as L}from"./DeliveryRouteMap-gJbZXGmH.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-0k-ecodo.js";import"./createLucideIcon-DFeQ1_P7.js";import"./RovingFocusGroup-B2V0LqPJ.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fe2f881_lang-fGrSInQY.js";import"./Input.vue_vue_type_script_setup_true_lang-BhSvFCK4.js";import"./search-DX6CV7Ks.js";import"./VisuallyHidden-e3nHpJ_I.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CCqgexjF.js";import"./chevron-right-BFHvTSNm.js";import"./vue-leaflet.es-Dv-ZYNQx.js";import"./marker-icon-2x-1TirABJh.js";import"./marker-icon-B6h-nX3D.js";import"./marker-shadow-B9CpECYs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},K=["min"],Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De=X({__name:"Create",props:{customers:{},invoices:{}},setup(V){const m=V,l=N({customer_id:null,invoice_id:null,delivery_address:"",contact_person:"",contact_phone:"",delivery_date:"",delivery_time:"",status:"pending",notes:"",delivery_fee:""}),M=[{title:"Deliveries",href:"/deliveries"},{title:"Create Delivery",href:"/deliveries/create"}];function D(){if(!l.invoice_id){l.setError("invoice_id","Invoice is required.");return}const n=/^\+63\d{10}$/;if(l.contact_phone&&!n.test(l.contact_phone)){l.setError("contact_phone","Enter a valid 10-digit Philippine mobile number.");return}l.post(route("deliveries.store"),{preserveScroll:!0,onSuccess:()=>{J.fire({toast:!0,position:"top-end",icon:"success",title:"Delivery created successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}})}const P=v(()=>[{value:null,label:"Select customer"},...m.customers.map(n=>({value:n.id,label:`${n.name}${n.company_name?` (${n.company_name})`:""}`}))]),S=v(()=>{if(!l.customer_id)return[{value:null,label:"Select invoice (select customer first)"}];const n=m.invoices.filter(e=>e.customer_id===l.customer_id);return[{value:null,label:"Select invoice"},...n.map(e=>({value:e.id,label:`${e.reference_number}`}))]}),$=[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],w=[{value:"09:00 AM - 12:00 PM",label:"09:00 AM - 12:00 PM"},{value:"12:00 PM - 03:00 PM",label:"12:00 PM - 03:00 PM"},{value:"03:00 PM - 06:00 PM",label:"03:00 PM - 06:00 PM"},{value:"06:00 PM - 09:00 PM",label:"06:00 PM - 09:00 PM"},{value:"Custom",label:"Custom"}],C=new Date().toISOString().split("T")[0],q=v(()=>{if(!l.customer_id)return null;const n=m.customers.find(s=>s.id===l.customer_id);if(!(n!=null&&n.location))return null;let e=n.location;if(typeof e=="string")try{e=JSON.parse(e)}catch{return console.warn("Failed to parse customer location string:",e),null}return e&&typeof e.lat=="number"&&typeof e.lng=="number"&&!isNaN(e.lat)&&!isNaN(e.lng)&&e.lat>=-90&&e.lat<=90&&e.lng>=-180&&e.lng<=180?e:(console.warn("Invalid customer location data:",n.location),null)}),U=v(()=>l.customer_id&&m.customers.find(n=>n.id===l.customer_id)||null);return k(()=>l.customer_id,n=>{if(n){const e=m.customers.find(s=>s.id===n);e!=null&&e.address&&!l.delivery_address&&(l.delivery_address=e.address)}}),(n,e)=>(O(),E(R,{breadcrumbs:M},{default:o(()=>[r(t(B),{title:"Create Delivery"}),e[25]||(e[25]=i("div",{class:"flex items-center justify-between mb-6"},[i("h1",{class:"text-2xl font-bold"},"Create Delivery")],-1)),i("form",{onSubmit:e[10]||(e[10]=T(s=>D(),["prevent"])),class:"space-y-6"},[r(_,null,{default:o(()=>[r(y,null,{default:o(()=>[r(x,null,{default:o(()=>e[11]||(e[11]=[d("Delivery Details")])),_:1,__:[11]})]),_:1}),r(b,{class:"space-y-6"},{default:o(()=>[i("div",z,[i("div",null,[r(a,{for:"customer_id"},{default:o(()=>e[12]||(e[12]=[d("Customer")])),_:1,__:[12]}),r(t(A),{modelValue:t(l).customer_id,"onUpdate:modelValue":e[0]||(e[0]=s=>t(l).customer_id=s),options:P.value,placeholder:"Select customer","search-placeholder":"Search customers...",class:"mt-1",required:""},null,8,["modelValue","options"]),r(u,{message:t(l).errors.customer_id},null,8,["message"])]),i("div",null,[r(a,{for:"invoice_id"},{default:o(()=>e[13]||(e[13]=[d("Invoice")])),_:1,__:[13]}),r(t(c),{modelValue:t(l).invoice_id,"onUpdate:modelValue":e[1]||(e[1]=s=>t(l).invoice_id=s),options:S.value,placeholder:"Select invoice",class:"mt-1",required:""},null,8,["modelValue","options"]),r(u,{message:t(l).errors.invoice_id},null,8,["message"])])]),i("div",null,[r(a,{for:"delivery_address"},{default:o(()=>e[14]||(e[14]=[d("Delivery Address")])),_:1,__:[14]}),p(i("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>t(l).delivery_address=s),id:"delivery_address",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter complete delivery address",required:""},null,512),[[f,t(l).delivery_address]]),r(u,{message:t(l).errors.delivery_address},null,8,["message"])]),i("div",G,[i("div",null,[r(a,{for:"contact_person"},{default:o(()=>e[15]||(e[15]=[d("Contact Person")])),_:1,__:[15]}),p(i("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t(l).contact_person=s),type:"text",id:"contact_person",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"Enter contact person name",required:""},null,512),[[f,t(l).contact_person]]),r(u,{message:t(l).errors.contact_person},null,8,["message"])]),i("div",null,[r(a,{for:"contact_phone"},{default:o(()=>e[16]||(e[16]=[d("Contact Phone")])),_:1,__:[16]}),r(F,{modelValue:t(l).contact_phone,"onUpdate:modelValue":e[4]||(e[4]=s=>t(l).contact_phone=s),id:"contact_phone",placeholder:"XXXXXXXXXX",required:"",class:"mt-1"},null,8,["modelValue"]),r(u,{message:t(l).errors.contact_phone},null,8,["message"])])]),i("div",H,[i("div",null,[r(a,{for:"delivery_date"},{default:o(()=>e[17]||(e[17]=[d("Delivery Date")])),_:1,__:[17]}),p(i("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>t(l).delivery_date=s),type:"date",id:"delivery_date",min:t(C),class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",required:""},null,8,K),[[f,t(l).delivery_date]]),r(u,{message:t(l).errors.delivery_date},null,8,["message"])]),i("div",null,[r(a,{for:"delivery_time"},{default:o(()=>e[18]||(e[18]=[d("Delivery Time")])),_:1,__:[18]}),r(t(c),{modelValue:t(l).delivery_time,"onUpdate:modelValue":e[6]||(e[6]=s=>t(l).delivery_time=s),options:w,placeholder:"Select delivery time",class:"mt-1",required:""},null,8,["modelValue"]),r(u,{message:t(l).errors.delivery_time},null,8,["message"])]),i("div",null,[r(a,{for:"status"},{default:o(()=>e[19]||(e[19]=[d("Status")])),_:1,__:[19]}),r(t(c),{modelValue:t(l).status,"onUpdate:modelValue":e[7]||(e[7]=s=>t(l).status=s),options:$,placeholder:"Select status",class:"mt-1",required:""},null,8,["modelValue"]),r(u,{message:t(l).errors.status},null,8,["message"])])]),i("div",Q,[i("div",null,[r(a,{for:"delivery_fee"},{default:o(()=>e[20]||(e[20]=[d("Delivery Fee")])),_:1,__:[20]}),p(i("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>t(l).delivery_fee=s),type:"number",id:"delivery_fee",min:"0",step:"0.01",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"0.00",required:""},null,512),[[f,t(l).delivery_fee]]),r(u,{message:t(l).errors.delivery_fee},null,8,["message"])]),i("div",null,[r(a,{for:"notes"},{default:o(()=>e[21]||(e[21]=[d("Notes")])),_:1,__:[21]}),p(i("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>t(l).notes=s),id:"notes",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter any additional notes"},null,512),[[f,t(l).notes]]),r(u,{message:t(l).errors.notes},null,8,["message"])])])]),_:1})]),_:1}),r(_,null,{default:o(()=>[r(y,null,{default:o(()=>[r(x,null,{default:o(()=>e[22]||(e[22]=[d("Delivery Route")])),_:1,__:[22]})]),_:1}),r(b,null,{default:o(()=>{var s;return[r(L,{"customer-location":q.value,"delivery-address":t(l).delivery_address||((s=U.value)==null?void 0:s.address),"map-height":"400px"},null,8,["customer-location","delivery-address"])]}),_:1})]),_:1}),r(_,null,{default:o(()=>[r(j,{class:"flex gap-2 justify-end"},{default:o(()=>[r(t(g),{type:"submit",variant:"default"},{default:o(()=>e[23]||(e[23]=[d("Create Delivery")])),_:1,__:[23]}),r(t(I),{href:n.route("deliveries.index")},{default:o(()=>[r(t(g),{type:"button",variant:"ghost"},{default:o(()=>e[24]||(e[24]=[d("Cancel")])),_:1,__:[24]})]),_:1},8,["href"])]),_:1})]),_:1})],32)]),_:1,__:[25]}))}});export{De as default};
