import{d as J,v as U,m as T,p as h,J as G,s as H,W as g,c,o as i,w as n,a,b as t,u as o,g as K,T as O,x as R,f,t as p,H as Q,y as X,h as v,e as u,S as k,F as W,r as L,n as Z}from"./app-BJGGIgA8.js";import{_ as m}from"./index-riohrRak.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-6OmCq4tp.js";import{_ as b,a as C}from"./CardContent.vue_vue_type_script_setup_true_lang-DPB8yWHX.js";import{_ as B}from"./Icon.vue_vue_type_script_setup_true_lang-DK3Ddpru.js";import{S as y}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-CX_goT8l.js";import"./useForwardPropsEmits-CZzI8B5e.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-MrJHOVsW.js";import"./Teleport-MSIji786.js";import"./RovingFocusGroup-gSG5KO_4.js";import"./VisuallyHidden-BC0AEIfW.js";import"./DialogPortal-Dpb7jdpY.js";import"./x-BjkU5bBK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DSD56j4j.js";import"./chevron-down-B83M1Caq.js";import"./chevron-right-CjvrEjDl.js";import"./square-pen-BALro00M.js";import"./calendar-C8vvPkHy.js";import"./check-CuaqBRk8.js";import"./chevron-left-Czs0_KEi.js";import"./circle-alert-C-R8aAcF.js";import"./piggy-bank-DQw4-LKJ.js";import"./circle-check-big-gvrLbzHW.js";import"./circle-check-BuF8fqTY.js";import"./trophy-B5vnFol2.js";import"./circle-x-C9HF6h3m.js";import"./clock-CUJ54ABb.js";import"./dollar-sign-BFWObhvv.js";import"./eye-off-dgfcsi04.js";import"./eye-BztToSRT.js";import"./loader-circle-ZvNwhMCX.js";import"./mail-tmHC_MiF.js";import"./map-pin-D8FvW8n7.js";import"./message-square-Cf895NaZ.js";import"./sun-Bomsfx5Q.js";import"./plus-CntaVqKq.js";import"./printer-_fQTJVRW.js";import"./search-BUl39vHB.js";import"./shopping-bag-DsL7THBq.js";import"./trash-2-DcMzLwyY.js";import"./trending-up-CSTqz3kz.js";const te={class:"grid grid-cols-1 lg:grid-cols-4 gap-6 mt-8 mb-6"},se={class:"flex items-center justify-between"},oe={class:"text-xl font-bold text-blue-600"},re={class:"flex items-center justify-between"},ne={class:"text-xl font-bold text-green-600"},le={class:"flex items-center justify-between"},ie={class:"text-xl font-bold text-yellow-600"},ae={class:"flex items-center justify-between"},ue={class:"text-xl font-bold text-emerald-600"},de={class:"flex items-center justify-between"},pe={class:"text-xl font-bold text-orange-600"},me={class:"flex items-center justify-between mt-4 mb-2"},fe={class:"flex gap-2 items-center"},ce={key:0,class:"ml-2 bg-white/20 px-2 py-0.5 rounded-full text-xs"},ve={class:"flex gap-2"},xe={key:0,class:"py-12 text-center"},he={class:"mx-auto max-w-md"},ge={key:1,class:"py-12 text-center"},ye={class:"mx-auto max-w-md"},_e={key:2,class:"min-w-full divide-y divide-border"},we={key:0,class:"px-4 py-2 text-left"},ke={class:"px-4 py-2 font-medium"},be={key:1},Ce={class:"px-4 py-2"},Be={class:"px-4 py-2"},je={class:"px-4 py-2"},Se={key:0,class:"px-4 py-2"},Ve={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800"},Ae={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Te={class:"px-4 py-2"},ze={class:"flex gap-2 items-center"},$e={key:0,class:"flex gap-2"},Me={key:1,class:"text-sm text-muted-foreground"},Pe={key:3,class:"flex items-center justify-between mt-6"},Ne={class:"text-sm text-gray-700"},We={class:"flex items-center gap-1"},Ee={key:1,class:"px-2 text-sm text-muted-foreground"},He={class:"fixed bottom-6 right-6 z-50"},Re={key:0,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Le={key:1,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Tt=J({__name:"Index",setup(De){const r=U(),V=T(r.props.filters?r.props.filters:{}),x=T(typeof V.value.search=="string"?V.value.search:""),_=T(typeof V.value.pending=="boolean"?V.value.pending:!1),j=T(!1),w=h(()=>{var l;return Array.isArray((l=r.props.auth)==null?void 0:l.userRoles)&&r.props.auth.userRoles.includes("Admin")});h(()=>{var l;return Array.isArray((l=r.props.auth)==null?void 0:l.userRoles)&&r.props.auth.userRoles.includes("Staff")&&!w.value});const A=h(()=>w.value),D=[{title:"Customers",href:"/customers"}];G(()=>{x.value=r.props.filters&&typeof r.props.filters.search=="string"?r.props.filters.search:""});let z=null;H(x,l=>{z&&clearTimeout(z),z=setTimeout(()=>{const e=(l??"").toString().trim(),s=r.props.filters&&typeof r.props.filters.search=="string"?r.props.filters.search:"";e!==s&&g.get("/customers",{search:e||void 0,pending:_.value||void 0},{preserveState:!0,replace:!0})},400)}),H(_,l=>{g.get("/customers",{search:x.value||void 0,pending:l||void 0},{preserveState:!0,replace:!0})});function $(l){g.get("/customers",{search:x.value,pending:_.value||void 0,page:l},{preserveState:!0,replace:!0})}async function F(l){(await y.fire({title:"Verify Customer?",text:`Are you sure you want to verify ${l.name}? They will receive an email notification and be able to log in.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#8f5be8",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, verify",cancelButtonText:"Cancel"})).isConfirmed&&g.post(`/customers/${l.id}/approve`,{},{onSuccess:()=>{y.fire("Customer Verified","The customer has been verified and notified via email.","success")},onError:()=>{const s=r.props.flash,d=(s==null?void 0:s.error)??"Failed to verify customer.";y.fire("Error",d,"error")}})}const E=h(()=>r.props.customers),M=h(()=>E.value.current_page),Y=h(()=>E.value.last_page),q=h(()=>{const l=Y.value||1,e=M.value||1,s=2,d=[],S=Math.max(1,e-s),P=Math.min(l,e+s);for(let N=S;N<=P;N++)d.push(N);return S>1&&(S>2&&d.unshift("..."),d.unshift(1)),P<l&&(P<l-1&&d.push("..."),d.push(l)),d});async function I(l){(await y.fire({title:"Delete Customer?",text:"Are you sure you want to delete this customer? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#8f5be8",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete customer"})).isConfirmed&&g.delete(`/customers/${l}`,{onSuccess:()=>{const s=r.props.flash;if(s!=null&&s.error){y.fire({title:"Cannot delete",text:s.error,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(d=>{d.isConfirmed&&g.get("/deliveries",{customer_id:l},{preserveState:!0,replace:!0})});return}y.fire("Customer deleted","Customer deleted successfully.","success")},onError:()=>{const s=r.props.flash,d=(s==null?void 0:s.error)??"Cannot delete this customer because there are related records.";y.fire({title:"Cannot delete",text:d,icon:"error",confirmButtonText:"View related deliveries",showCancelButton:!0,cancelButtonText:"Close",confirmButtonColor:"#8f5be8"}).then(S=>{S.isConfirmed&&g.get("/deliveries",{customer_id:l},{preserveState:!0,replace:!0})})}})}return(l,e)=>(i(),c(ee,{breadcrumbs:D},{default:n(()=>[a(o(K),{title:"Customers"}),a(O,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-4","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-4"},{default:n(()=>[R(t("div",te,[a(b,{class:"relative overflow-hidden"},{default:n(()=>[a(C,{class:"p-6"},{default:n(()=>{var s;return[t("div",se,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Total Customers",-1)),t("p",oe,p(((s=o(r).props.stats)==null?void 0:s.totalCustomers)||0),1)]),e[7]||(e[7]=t("div",{class:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})])],-1))])]}),_:1})]),_:1}),a(b,{class:"relative overflow-hidden"},{default:n(()=>[a(C,{class:"p-6"},{default:n(()=>{var s;return[t("div",re,[t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm font-medium text-muted-foreground"},"With Company",-1)),t("p",ne,p(((s=o(r).props.stats)==null?void 0:s.customersWithCompany)||0),1)]),e[9]||(e[9]=t("div",{class:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1))])]}),_:1})]),_:1}),a(b,{class:"relative overflow-hidden"},{default:n(()=>[a(C,{class:"p-6"},{default:n(()=>{var s;return[t("div",le,[t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm font-medium text-muted-foreground"},"With Phone",-1)),t("p",ie,p(((s=o(r).props.stats)==null?void 0:s.customersWithPhone)||0),1)]),e[11]||(e[11]=t("div",{class:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1))])]}),_:1})]),_:1}),a(b,{class:"relative overflow-hidden"},{default:n(()=>[a(C,{class:"p-6"},{default:n(()=>{var s;return[t("div",ae,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Recently Added",-1)),t("p",ue,p(((s=o(r).props.stats)==null?void 0:s.recentlyAdded)||0),1)]),e[13]||(e[13]=t("div",{class:"h-12 w-12 rounded-full bg-emerald-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]}),_:1})]),_:1}),w.value?(i(),c(b,{key:0,class:"relative overflow-hidden"},{default:n(()=>[a(C,{class:"p-6"},{default:n(()=>{var s;return[t("div",de,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-muted-foreground"},"Pending Approvals",-1)),t("p",pe,p(((s=o(r).props.stats)==null?void 0:s.pendingApprovals)||0),1)]),e[15]||(e[15]=t("div",{class:"h-12 w-12 rounded-full bg-orange-100 flex items-center justify-center"},[t("svg",{class:"h-6 w-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]}),_:1})]),_:1})):f("",!0)],512),[[Q,j.value]])]),_:1}),t("div",me,[t("div",fe,[R(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),type:"text",placeholder:"Search customers by name, company, or email...",class:"rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[X,x.value]]),w.value?(i(),c(o(m),{key:0,variant:_.value?"default":"outline",onClick:e[1]||(e[1]=s=>_.value=!_.value)},{default:n(()=>{var s,d;return[a(B,{name:"Clock",class:"h-4 w-4 mr-2"}),e[16]||(e[16]=v(" Pending Approvals ")),(s=o(r).props.stats)!=null&&s.pendingApprovals?(i(),u("span",ce,p((d=o(r).props.stats)==null?void 0:d.pendingApprovals),1)):f("",!0)]}),_:1,__:[16]},8,["variant"])):f("",!0)]),t("div",ve,[a(o(k),{href:l.route("customers.logs.index")},{default:n(()=>[a(o(m),{variant:"outline"},{default:n(()=>[a(B,{name:"file-text",class:"h-4 w-4 mr-2"}),e[17]||(e[17]=v(" View All Logs "))]),_:1,__:[17]})]),_:1},8,["href"]),A.value?(i(),c(o(k),{key:0,href:l.route("customers.create")},{default:n(()=>[a(o(m),{variant:"default"},{default:n(()=>e[18]||(e[18]=[t("span",{class:"mr-2"},"+",-1),v(" Add New Customer ")])),_:1,__:[18]})]),_:1},8,["href"])):f("",!0)])]),a(b,null,{default:n(()=>[a(C,null,{default:n(()=>[o(r).props.customers.total===0?(i(),u("div",xe,[t("div",he,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold mb-2"},"No customers yet",-1)),e[21]||(e[21]=t("p",{class:"text-sm text-muted-foreground mb-6"}," Customers you add will appear here. You can create invoices faster when customers are saved. ",-1)),A.value?(i(),c(o(k),{key:0,href:l.route("customers.create")},{default:n(()=>[a(o(m),{variant:"default"},{default:n(()=>e[19]||(e[19]=[v(" Add your first customer ")])),_:1,__:[19]})]),_:1},8,["href"])):f("",!0)])])):o(r).props.customers.data.length===0&&x.value&&x.value.toString().trim().length?(i(),u("div",ge,[t("div",ye,[e[23]||(e[23]=t("h3",{class:"text-lg font-semibold mb-2"},"No results found",-1)),e[24]||(e[24]=t("p",{class:"text-sm text-muted-foreground mb-6"}," We couldn't find any customers matching your search. ",-1)),a(o(m),{variant:"outline",onClick:e[2]||(e[2]=s=>x.value="")},{default:n(()=>e[22]||(e[22]=[v(" Clear search ")])),_:1,__:[22]})])])):(i(),u("table",_e,[t("thead",null,[t("tr",null,[e[25]||(e[25]=t("th",{class:"px-4 py-2 text-left"},"Name",-1)),e[26]||(e[26]=t("th",{class:"px-4 py-2 text-left"},"Company",-1)),e[27]||(e[27]=t("th",{class:"px-4 py-2 text-left"},"Email",-1)),e[28]||(e[28]=t("th",{class:"px-4 py-2 text-left"},"Phone",-1)),w.value?(i(),u("th",we,"Status")):f("",!0),e[29]||(e[29]=t("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),t("tbody",null,[(i(!0),u(W,null,L(o(r).props.customers.data,s=>(i(),u("tr",{key:s.id,class:"hover:bg-muted"},[t("td",ke,[A.value?(i(),c(o(k),{key:0,href:l.route("customers.edit",s.id),class:"underline underline-offset-4"},{default:n(()=>[v(p(s.name),1)]),_:2},1032,["href"])):(i(),u("span",be,p(s.name),1))]),t("td",Ce,p(s.company_name||"-"),1),t("td",Be,p(s.email),1),t("td",je,p(s.phone||"-"),1),w.value?(i(),u("td",Se,[s.verified_at?(i(),u("span",Ae," Verified ")):(i(),u("span",Ve," Pending Verification "))])):f("",!0),t("td",Te,[t("div",ze,[a(o(k),{href:l.route("customers.logs.show",s.id)},{default:n(()=>[a(o(m),{variant:"ghost",size:"sm",title:"View Logs"},{default:n(()=>[a(B,{name:"file-text",class:"h-4 w-4"})]),_:1})]),_:2},1032,["href"]),A.value?(i(),u("div",$e,[s.verified_at?f("",!0):(i(),c(o(m),{key:0,variant:"default",size:"sm",onClick:d=>F(s),class:"bg-green-600 hover:bg-green-700"},{default:n(()=>[a(B,{name:"Check",class:"h-4 w-4 mr-1"}),e[30]||(e[30]=v(" Verify "))]),_:2,__:[30]},1032,["onClick"])),a(o(k),{href:l.route("customers.edit",s.id)},{default:n(()=>[a(o(m),{variant:"ghost",size:"sm"},{default:n(()=>[a(B,{name:"edit",class:"h-4 w-4"})]),_:1})]),_:2},1032,["href"]),a(o(m),{variant:"ghost",size:"sm",onClick:d=>I(s.id)},{default:n(()=>[a(B,{name:"trash",class:"h-4 w-4"})]),_:2},1032,["onClick"])])):(i(),u("span",Me,"View only"))])])]))),128))])])),o(r).props.customers.last_page>1?(i(),u("div",Pe,[t("div",Ne," Showing "+p(o(r).props.customers.from)+" to "+p(o(r).props.customers.to)+" of "+p(o(r).props.customers.total)+" results ",1),t("div",We,[o(r).props.customers.prev_page_url?(i(),c(o(m),{key:0,variant:"outline",size:"sm",onClick:e[3]||(e[3]=s=>$(o(r).props.customers.current_page-1))},{default:n(()=>e[31]||(e[31]=[v(" Previous ")])),_:1,__:[31]})):f("",!0),(i(!0),u(W,null,L(q.value,s=>(i(),u(W,{key:"p-"+s},[typeof s=="number"?(i(),c(o(m),{key:0,variant:s===M.value?"default":"outline",size:"sm",onClick:d=>s!==M.value&&$(s)},{default:n(()=>[v(p(s),1)]),_:2},1032,["variant","onClick"])):(i(),u("span",Ee,"â€¦"))],64))),128)),o(r).props.customers.next_page_url?(i(),c(o(m),{key:1,variant:"outline",size:"sm",onClick:e[4]||(e[4]=s=>$(o(r).props.customers.current_page-0+1))},{default:n(()=>e[32]||(e[32]=[v(" Next ")])),_:1,__:[32]})):f("",!0)])])):f("",!0)]),_:1})]),_:1}),t("div",He,[t("button",{onClick:e[5]||(e[5]=s=>j.value=!j.value),class:Z(["h-12 w-12 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center",j.value?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"])},[j.value?(i(),u("svg",Le,e[34]||(e[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(i(),u("svg",Re,e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},null,-1)])))],2)])]),_:1}))}});export{Tt as default};
