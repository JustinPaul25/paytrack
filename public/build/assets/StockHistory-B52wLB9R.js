import{d as I,v as G,p as g,m as N,s as U,W as V,c as _,o as a,w as u,a as f,b as t,u as x,g as J,t as r,h as m,S as A,x as L,y as O,e as i,F as k,r as B,D as X,f as P,n as j}from"./app-BJGGIgA8.js";import{_ as w}from"./index-riohrRak.js";import{_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-6OmCq4tp.js";import{_ as z,a as M}from"./CardContent.vue_vue_type_script_setup_true_lang-DPB8yWHX.js";import{_ as Z}from"./Icon.vue_vue_type_script_setup_true_lang-DK3Ddpru.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-CX_goT8l.js";import"./useForwardPropsEmits-CZzI8B5e.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-MrJHOVsW.js";import"./Teleport-MSIji786.js";import"./RovingFocusGroup-gSG5KO_4.js";import"./VisuallyHidden-BC0AEIfW.js";import"./DialogPortal-Dpb7jdpY.js";import"./x-BjkU5bBK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DSD56j4j.js";import"./chevron-down-B83M1Caq.js";import"./chevron-right-CjvrEjDl.js";import"./square-pen-BALro00M.js";import"./calendar-C8vvPkHy.js";import"./check-CuaqBRk8.js";import"./chevron-left-Czs0_KEi.js";import"./circle-alert-C-R8aAcF.js";import"./piggy-bank-DQw4-LKJ.js";import"./circle-check-big-gvrLbzHW.js";import"./circle-check-BuF8fqTY.js";import"./trophy-B5vnFol2.js";import"./circle-x-C9HF6h3m.js";import"./clock-CUJ54ABb.js";import"./dollar-sign-BFWObhvv.js";import"./eye-off-dgfcsi04.js";import"./eye-BztToSRT.js";import"./loader-circle-ZvNwhMCX.js";import"./mail-tmHC_MiF.js";import"./map-pin-D8FvW8n7.js";import"./message-square-Cf895NaZ.js";import"./sun-Bomsfx5Q.js";import"./plus-CntaVqKq.js";import"./printer-_fQTJVRW.js";import"./search-BUl39vHB.js";import"./shopping-bag-DsL7THBq.js";import"./trash-2-DcMzLwyY.js";import"./trending-up-CSTqz3kz.js";const tt={class:"flex items-center justify-between mb-6"},et={class:"text-2xl font-bold"},st={class:"mt-2 flex gap-4 text-sm"},ot={class:"text-muted-foreground"},rt={class:"text-muted-foreground"},at={class:"text-muted-foreground"},it={class:"flex gap-4 items-end"},nt={class:"flex-1"},ut={class:"w-48"},lt=["value"],dt={key:0,class:"py-12 text-center"},pt={class:"mx-auto max-w-md"},ct={class:"text-sm text-muted-foreground"},ft={key:1,class:"overflow-x-auto"},mt={class:"min-w-full divide-y divide-border"},xt={class:"bg-background divide-y divide-border"},gt={class:"px-4 py-3 whitespace-nowrap text-sm"},vt={class:"px-4 py-3 whitespace-nowrap"},_t={class:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground"},yt={class:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground"},bt={class:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground"},ht={class:"px-4 py-3 whitespace-nowrap text-sm"},kt={key:1,class:"text-muted-foreground"},wt={key:2,class:"text-muted-foreground"},St={class:"px-4 py-3 text-sm text-muted-foreground"},Tt={key:2,class:"px-4 py-4 border-t border-border"},Ct={class:"flex items-center justify-between"},$t={class:"text-sm text-muted-foreground"},Nt={class:"flex gap-2"},Bt={key:1,class:"px-2 py-1 text-sm text-muted-foreground"},_e=I({__name:"StockHistory",setup(Pt){const v=G(),d=g(()=>v.props.product),y=N(v.props.filters?v.props.filters:{}),p=N(typeof y.value.search=="string"?y.value.search:""),c=N(typeof y.value.type=="string"?y.value.type:""),R=g(()=>v.props.types||[]),F=[{title:"Products",href:"/products"},{title:d.value.name,href:"#"},{title:"Stock History",href:"#"}];let S=null;U(p,o=>{S&&clearTimeout(S),S=setTimeout(()=>{D()},400)}),U(c,()=>{D()});function D(){const o={};p.value&&(o.search=p.value),c.value&&(o.type=c.value),V.get(route("products.stockHistory",d.value.id),o,{preserveState:!0,replace:!0})}function T(o){const e={page:o};p.value&&(e.search=p.value),c.value&&(e.type=c.value),V.get(route("products.stockHistory",d.value.id),e,{preserveState:!0,replace:!0})}function W(o){return new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function q(o){switch(o.toLowerCase()){case"adjustment":return"bg-blue-100 text-blue-800";case"sale":return"bg-red-100 text-red-800";case"refund":return"bg-green-100 text-green-800";case"writeoff":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}}function H(o){switch(o.toLowerCase()){case"adjustment":return"Stock Added";case"sale":return"Sale";case"refund":return"Refund";case"writeoff":return"Write-off";default:return o}}function K(o){return o>0?`+${o}`:`${o}`}const l=g(()=>v.props.movements),b=g(()=>{var o;return((o=l.value)==null?void 0:o.current_page)||1}),Q=g(()=>{var o;return((o=l.value)==null?void 0:o.last_page)||1}),E=g(()=>{const o=Q.value||1,e=b.value||1,s=2,n=[],h=Math.max(1,e-s),C=Math.min(o,e+s);for(let $=h;$<=C;$++)n.push($);return h>1&&(h>2&&n.unshift("..."),n.unshift(1)),C<o&&(C<o-1&&n.push("..."),n.push(o)),n});return(o,e)=>(a(),_(Y,{breadcrumbs:F},{default:u(()=>[f(x(J),{title:`${d.value.name} - Stock History`},null,8,["title"]),t("div",tt,[t("div",null,[t("h1",et," Stock History - "+r(d.value.name),1),e[7]||(e[7]=t("p",{class:"text-sm text-muted-foreground mt-1"}," Track all stock movements for this product ",-1)),t("div",st,[t("span",ot,[e[4]||(e[4]=t("strong",null,"Stock:",-1)),m(" "+r(d.value.initial_stock),1)]),t("span",rt,[e[5]||(e[5]=t("strong",null,"Remaining Stock:",-1)),m(" "+r(d.value.stock),1)]),t("span",at,[e[6]||(e[6]=t("strong",null,"SKU:",-1)),m(" "+r(d.value.SKU),1)])])]),f(x(A),{href:o.route("products.index")},{default:u(()=>[f(x(w),{variant:"outline"},{default:u(()=>[f(Z,{name:"arrow-left",class:"h-4 w-4 mr-2"}),e[8]||(e[8]=m(" Back to Products "))]),_:1,__:[8]})]),_:1},8,["href"])]),f(z,{class:"mb-6"},{default:u(()=>[f(M,{class:"p-4"},{default:u(()=>[t("div",it,[t("div",nt,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium mb-1"},"Search",-1)),L(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),type:"text",placeholder:"Search by notes or user name...",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[O,p.value]])]),t("div",ut,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium mb-1"},"Type",-1)),L(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>c.value=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[10]||(e[10]=t("option",{value:""},"All Types",-1)),(a(!0),i(k,null,B(R.value,s=>(a(),i("option",{key:s,value:s},r(H(s)),9,lt))),128))],512),[[X,c.value]])])])]),_:1})]),_:1}),f(z,null,{default:u(()=>[f(M,{class:"p-0"},{default:u(()=>[l.value.total===0?(a(),i("div",dt,[t("div",pt,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold mb-2"},"No stock movements found",-1)),t("p",ct,r(p.value||c.value?"No movements match your filters.":"No stock movements have been recorded yet."),1)])])):(a(),i("div",ft,[t("table",mt,[e[13]||(e[13]=t("thead",{class:"bg-muted/50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Date & Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Type"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Quantity"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Before"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"After"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Related"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Notes")])],-1)),t("tbody",xt,[(a(!0),i(k,null,B(l.value.data,s=>{var n;return a(),i("tr",{key:s.id,class:"hover:bg-muted/50"},[t("td",gt,r(W(s.created_at)),1),t("td",vt,[t("span",{class:j(["px-2 py-1 rounded-full text-xs font-medium",q(s.type)])},r(H(s.type)),3)]),t("td",{class:j(["px-4 py-3 whitespace-nowrap text-sm font-medium",s.quantity>0?"text-green-600":"text-red-600"])},r(K(s.quantity)),3),t("td",_t,r(s.quantity_before??"N/A"),1),t("td",yt,r(s.quantity_after??"N/A"),1),t("td",bt,r(((n=s.user)==null?void 0:n.name)??"System"),1),t("td",ht,[s.invoice?(a(),_(x(A),{key:0,href:o.route("invoices.show",s.invoice.id),class:"text-blue-600 hover:underline"},{default:u(()=>[m(" Invoice #"+r(s.invoice.reference_number),1)]),_:2},1032,["href"])):s.refund?(a(),i("span",kt," Refund #"+r(s.refund.id),1)):(a(),i("span",wt,"—"))]),t("td",St,r(s.notes||"—"),1)])}),128))])])])),l.value.last_page>1?(a(),i("div",Tt,[t("div",Ct,[t("div",$t," Showing "+r(l.value.from)+" to "+r(l.value.to)+" of "+r(l.value.total)+" results ",1),t("div",Nt,[l.value.prev_page_url?(a(),_(x(w),{key:0,variant:"outline",size:"sm",onClick:e[2]||(e[2]=s=>T(b.value-1))},{default:u(()=>e[14]||(e[14]=[m(" Previous ")])),_:1,__:[14]})):P("",!0),(a(!0),i(k,null,B(E.value,(s,n)=>(a(),i(k,{key:n},[s!=="..."?(a(),_(x(w),{key:0,variant:s===b.value?"default":"outline",size:"sm",onClick:h=>T(s)},{default:u(()=>[m(r(s),1)]),_:2},1032,["variant","onClick"])):(a(),i("span",Bt,"..."))],64))),128)),l.value.next_page_url?(a(),_(x(w),{key:1,variant:"outline",size:"sm",onClick:e[3]||(e[3]=s=>T(b.value+1))},{default:u(()=>e[15]||(e[15]=[m(" Next ")])),_:1,__:[15]})):P("",!0)])])])):P("",!0)]),_:1})]),_:1})]),_:1}))}});export{_e as default};
