import{d as B,v as D,m as I,c,o as i,w as d,a as p,b as t,f as a,h as l,u as r,g as V,t as n,W as g,e as v,F as L,r as z,S as k,l as A}from"./app-CrbxPDKR.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-Ck0ITrji.js";import{_ as M,a as F}from"./CardContent.vue_vue_type_script_setup_true_lang-CD5eH6o6.js";import{_ as H,a as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-CiDLbmvN.js";import{_ as f}from"./index-CW9Bv3xQ.js";import{S}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fe2f881_lang-DcvXf-iQ.js";import"./RovingFocusGroup-BBitnScW.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Dkwl6_gP.js";import"./createLucideIcon-hv-fcGHk.js";import"./VisuallyHidden-NkJcgW7M.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BNcdHWj8.js";import"./chevron-right-BqnufUyh.js";const U={class:"flex items-center justify-between my-6"},E={class:"text-2xl font-bold"},Q={class:"flex gap-2"},W=["value"],Y={key:0,class:"py-8 text-center text-sm text-gray-500"},G={key:0},J={class:"mt-3"},O={key:1},X={key:1},Z={class:"min-w-full divide-y divide-border"},ee={key:0,class:"px-4 py-2 text-left"},te={class:"px-4 py-2"},se={class:"font-medium"},ie={key:0,class:"text-xs text-gray-500 truncate max-w-64"},oe={class:"px-4 py-2"},ne={key:1,class:"text-sm"},ae={key:0,class:"px-4 py-2"},re={class:"text-sm"},le={key:0,class:"text-xs text-gray-500"},de={class:"px-4 py-2"},ue={class:"px-4 py-2"},ve={class:"px-4 py-2 text-sm text-gray-500"},pe={class:"px-4 py-2"},me={class:"flex gap-2"},ce={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},fe={class:"relative bg-background rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6"},_e={class:"flex items-center justify-between mb-6 border-b pb-4"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-4"},ge={class:"font-semibold text-lg"},ke={key:0},be={key:1,class:"font-medium"},we={key:0,class:"mt-1 text-sm text-gray-600"},he={key:0},Ce={key:1},Re={class:"font-medium"},qe={class:"space-y-1"},Ae={class:"font-medium"},Se={key:0,class:"text-sm text-gray-600"},$e={key:1,class:"text-sm text-gray-600"},Ne={class:"text-sm"},je={key:0,class:"text-xs text-gray-500 mt-1"},Pe={class:"space-y-4"},Be={key:0},De={class:"font-medium"},Ie={key:0,class:"mt-1 text-sm text-gray-600 space-y-1"},Ve={key:0},Le={class:"font-medium text-lg"},ze={key:1},Te={class:"font-medium text-lg text-green-600"},Me={key:2},Fe={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},He={key:3},Ke={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},Ue={key:4},Ee={class:"whitespace-pre-wrap text-sm bg-blue-50 p-3 rounded-md border border-blue-200"},Qe={key:5},We=["href"],Ye={key:6},Ge={class:"text-sm font-medium text-green-600"},Je={class:"mt-6 pt-4 border-t flex justify-end gap-2"},vt=B({__name:"Index",setup(Oe){var h,C,R;function b(u){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(u)}const m=D(),x=m.props.filters||{},y=Array.isArray((h=m.props.auth)==null?void 0:h.userRoles)&&m.props.auth.userRoles.includes("Customer"),$=Array.isArray((C=m.props.auth)==null?void 0:C.userRoles)&&m.props.auth.userRoles.includes("Admin"),N=Array.isArray((R=m.props.auth)==null?void 0:R.userRoles)&&m.props.auth.userRoles.includes("Staff"),w=$||N,s=I(null);function j(u){S.fire({title:"Approve this refund request?",icon:"question",showCancelButton:!0,confirmButtonText:"Approve",confirmButtonColor:"#10b981",input:"textarea",inputLabel:"Approval notes (optional)",inputPlaceholder:"Notes for this approval...",inputAttributes:{"aria-label":"Approval notes (optional)"}}).then(e=>{e.isConfirmed&&g.post(route("refundRequests.approve",u),{review_notes:e.value||void 0},{preserveScroll:!0})})}function P(u){S.fire({title:"Decline this refund request?",text:"This will mark the request as rejected. You canâ€™t undo this.",icon:"warning",showCancelButton:!0,confirmButtonText:"Decline",confirmButtonColor:"#ef4444",input:"textarea",inputLabel:"Reason (required)",inputPlaceholder:"Provide a reason for declining...",inputAttributes:{"aria-label":"Reason (required)"},inputValidator:e=>{if(!e||!e.trim())return"Please provide a brief reason."}}).then(e=>{e.isConfirmed&&g.post(route("refundRequests.reject",u),{review_notes:e.value},{preserveScroll:!0})})}return(u,e)=>(i(),c(T,null,{default:d(()=>{var q;return[p(r(V),{title:"Refund Requests"}),t("div",U,[t("h1",E,n(r(y)?"My Refund Requests":"Refund Requests"),1),t("div",Q,[t("select",{class:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:r(x).status||"all",onChange:e[0]||(e[0]=o=>{const _=o.target.value==="all"?"":o.target.value;r(g).get(u.route("refundRequests.index"),_?{status:_}:{},{preserveState:!0,replace:!0})})},e[5]||(e[5]=[t("option",{value:"all"},"All",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"approved"},"Approved",-1),t("option",{value:"rejected"},"Rejected",-1),t("option",{value:"converted"},"Converted",-1)]),40,W)])]),p(M,null,{default:d(()=>[p(H,null,{default:d(()=>[p(K,null,{default:d(()=>e[6]||(e[6]=[v("Requests")])),_:1,__:[6]})]),_:1}),p(F,null,{default:d(()=>[r(m).props.refundRequests.data.length?(i(),a("div",X,[t("table",Z,[t("thead",null,[t("tr",null,[e[9]||(e[9]=t("th",{class:"px-4 py-2 text-left"},"Tracking",-1)),e[10]||(e[10]=t("th",{class:"px-4 py-2 text-left"},"Invoice",-1)),r(y)?l("",!0):(i(),a("th",ee,"Customer")),e[11]||(e[11]=t("th",{class:"px-4 py-2 text-left"},"Qty",-1)),e[12]||(e[12]=t("th",{class:"px-4 py-2 text-left"},"Status",-1)),e[13]||(e[13]=t("th",{class:"px-4 py-2 text-left"},"Submitted",-1)),e[14]||(e[14]=t("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),t("tbody",null,[(i(!0),a(L,null,z(r(m).props.refundRequests.data,o=>(i(),a("tr",{key:o.id,class:"hover:bg-muted"},[t("td",te,[t("div",se,n(o.tracking_number),1),o.reason?(i(),a("div",ie,n(o.reason),1)):l("",!0)]),t("td",oe,[o.invoice_id?(i(),c(r(k),{key:0,href:u.route("invoices.show",o.invoice_id),class:"text-sm text-blue-600 hover:underline"},{default:d(()=>[v(n(o.invoice_reference||"#"+o.invoice_id),1)]),_:2},1032,["href"])):(i(),a("div",ne,n(o.invoice_reference||"#"+o.invoice_id),1))]),r(y)?l("",!0):(i(),a("td",ae,[t("div",re,n(o.customer_name),1),o.email?(i(),a("div",le,n(o.email),1)):l("",!0)])),t("td",de,n(o.quantity),1),t("td",ue,[t("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":o.status==="pending","bg-green-100 text-green-800":o.status==="approved"||o.status==="converted","bg-red-100 text-red-800":o.status==="rejected"}])},n(o.status),3)]),t("td",ve,n(new Date(o.created_at).toLocaleString()),1),t("td",pe,[t("div",me,[r(w)&&o.status==="pending"?(i(),c(r(f),{key:0,size:"sm",variant:"default",onClick:_=>j(o.id)},{default:d(()=>e[15]||(e[15]=[v(" Approve ")])),_:2,__:[15]},1032,["onClick"])):l("",!0),r(w)&&o.status==="pending"?(i(),c(r(f),{key:1,size:"sm",variant:"destructive",onClick:_=>P(o.id)},{default:d(()=>e[16]||(e[16]=[v(" Decline ")])),_:2,__:[16]},1032,["onClick"])):l("",!0),p(r(f),{size:"sm",variant:"outline",onClick:_=>s.value=o},{default:d(()=>e[17]||(e[17]=[v("View details")])),_:2,__:[17]},1032,["onClick"]),o.invoice_id&&!r(y)?(i(),c(r(k),{key:2,href:u.route("invoices.show",o.invoice_id)},{default:d(()=>[p(r(f),{size:"sm",variant:"ghost"},{default:d(()=>e[18]||(e[18]=[v("View Invoice")])),_:1,__:[18]})]),_:2},1032,["href"])):l("",!0)])])]))),128))])])])):(i(),a("div",Y,[r(x).status&&r(x).status!==""&&r(x).status!=="all"?(i(),a("div",G,[e[8]||(e[8]=v(" No refund requests for the selected filter. ")),t("div",J,[p(r(f),{variant:"outline",onClick:e[1]||(e[1]=o=>r(g).get(u.route("refundRequests.index"),{},{preserveState:!0,replace:!0}))},{default:d(()=>e[7]||(e[7]=[v(" Clear filters ")])),_:1,__:[7]})])])):(i(),a("div",O," No refund requests. "))]))]),_:1})]),_:1}),s.value?(i(),a("div",ce,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[2]||(e[2]=o=>s.value=null)}),t("div",fe,[t("div",_e,[e[19]||(e[19]=t("h3",{class:"text-xl font-semibold"},"Refund Request Details",-1)),t("button",{class:"text-sm text-gray-500 hover:text-gray-700",onClick:e[3]||(e[3]=o=>s.value=null)},"Close")]),t("div",xe,[t("div",ye,[t("div",null,[e[20]||(e[20]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Tracking Number",-1)),t("div",ge,n(s.value.tracking_number),1)]),t("div",null,[e[21]||(e[21]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Status",-1)),t("span",{class:A(["px-3 py-1 rounded-full text-sm font-medium inline-block",{"bg-yellow-100 text-yellow-800":s.value.status==="pending","bg-green-100 text-green-800":s.value.status==="approved"||s.value.status==="converted","bg-red-100 text-red-800":s.value.status==="rejected"}])},n(s.value.status),3)]),s.value.invoice?(i(),a("div",ke,[e[22]||(e[22]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice",-1)),t("div",null,[s.value.invoice_id?(i(),c(r(k),{key:0,href:u.route("invoices.show",s.value.invoice_id),class:"text-blue-600 hover:underline font-medium"},{default:d(()=>[v(n(s.value.invoice.reference_number||s.value.invoice_reference||`#${s.value.invoice_id}`),1)]),_:1},8,["href"])):(i(),a("span",be,n(s.value.invoice_reference||"N/A"),1))]),s.value.invoice?(i(),a("div",we,[t("div",null,"Amount: "+n(b(s.value.invoice.total_amount)),1),t("div",null,"Status: "+n(s.value.invoice.status),1),s.value.invoice.payment_status?(i(),a("div",he,"Payment: "+n(s.value.invoice.payment_status),1)):l("",!0)])):l("",!0)])):s.value.invoice_reference?(i(),a("div",Ce,[e[23]||(e[23]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice Reference",-1)),t("div",Re,n(s.value.invoice_reference),1)])):l("",!0),t("div",null,[e[24]||(e[24]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Customer Information",-1)),t("div",qe,[t("div",Ae,n(s.value.customer_name),1),s.value.email?(i(),a("div",Se,n(s.value.email),1)):l("",!0),s.value.phone?(i(),a("div",$e,n(s.value.phone),1)):l("",!0)])]),t("div",null,[e[25]||(e[25]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Submitted",-1)),t("div",Ne,n(new Date(s.value.created_at).toLocaleString()),1),s.value.updated_at&&s.value.updated_at!==s.value.created_at?(i(),a("div",je," Last updated: "+n(new Date(s.value.updated_at).toLocaleString()),1)):l("",!0)])]),t("div",Pe,[s.value.product||s.value.product_name?(i(),a("div",Be,[e[26]||(e[26]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Product",-1)),t("div",null,[t("div",De,n(((q=s.value.product)==null?void 0:q.name)||s.value.product_name||"N/A"),1),s.value.product?(i(),a("div",Ie,[s.value.product.SKU?(i(),a("div",Ve,"SKU: "+n(s.value.product.SKU),1)):l("",!0),t("div",null,"Price: "+n(b(s.value.product.selling_price)),1)])):l("",!0)])])):l("",!0),t("div",null,[e[27]||(e[27]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Quantity",-1)),t("div",Le,n(s.value.quantity),1)]),s.value.amount_requested?(i(),a("div",ze,[e[28]||(e[28]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Amount Requested",-1)),t("div",Te,n(b(s.value.amount_requested)),1)])):l("",!0),s.value.reason?(i(),a("div",Me,[e[29]||(e[29]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Reason",-1)),t("div",Fe,n(s.value.reason),1)])):l("",!0),s.value.notes?(i(),a("div",He,[e[30]||(e[30]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Additional Notes",-1)),t("div",Ke,n(s.value.notes),1)])):l("",!0),s.value.review_notes?(i(),a("div",Ue,[e[31]||(e[31]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Review Notes",-1)),t("div",Ee,n(s.value.review_notes),1)])):l("",!0),s.value.media_link?(i(),a("div",Qe,[e[33]||(e[33]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Media / Evidence",-1)),t("a",{href:s.value.media_link,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:underline break-all text-sm flex items-center gap-2"},e[32]||(e[32]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1),v(" View Media ")]),8,We)])):l("",!0),s.value.converted_refund_id?(i(),a("div",Ye,[e[34]||(e[34]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Converted to Refund",-1)),t("div",Ge,"Refund ID: #"+n(s.value.converted_refund_id),1)])):l("",!0)])]),t("div",Je,[p(r(f),{variant:"outline",onClick:e[4]||(e[4]=o=>s.value=null)},{default:d(()=>e[35]||(e[35]=[v("Close")])),_:1,__:[35]}),s.value.invoice_id?(i(),c(r(k),{key:0,href:u.route("invoices.show",s.value.invoice_id)},{default:d(()=>[p(r(f),{variant:"default"},{default:d(()=>e[36]||(e[36]=[v("View Invoice")])),_:1,__:[36]})]),_:1},8,["href"])):l("",!0)])])])):l("",!0)]}),_:1}))}});export{vt as default};
