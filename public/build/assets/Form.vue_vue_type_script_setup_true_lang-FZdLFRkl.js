import{d as D,E as G,p as C,s as N,e as w,o as B,b as a,a as t,w as r,h as n,u as s,x as A,y as E,f as L,l as T,t as z,G as J}from"./app-BJGGIgA8.js";import{_ as d}from"./InputError.vue_vue_type_script_setup_true_lang-YNpV2x5o.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-bOJZE9lv.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-o7QhFVaq.js";import{_ as q}from"./PhoneInput.vue_vue_type_script_setup_true_lang--2OWr11_.js";import{_ as H}from"./index-riohrRak.js";import{_ as W}from"./CardFooter.vue_vue_type_script_setup_true_lang-viGH8JM8.js";import K from"./LocationInput-DrNLtDsP.js";import{_ as g}from"./SearchSelect.vue_vue_type_script_setup_true_lang-DjNxBFPF.js";import{g as Q,a as R,p as Y}from"./philippines-BZpectg7.js";const Z={class:"flex gap-4"},ee={class:"flex-1"},oe={class:"flex gap-4"},se={class:"flex-1"},te={class:"flex gap-4"},ae={class:"flex-1"},le={class:"flex gap-4"},ie={class:"flex-1"},re={class:"flex gap-4"},ne={class:"flex-1"},me={class:"flex gap-4"},de={class:"flex-1"},ue={class:"flex gap-4"},pe={class:"flex-1"},ce={class:"flex gap-4"},fe={class:"flex-1"},ge={class:"flex gap-4"},_e={class:"flex-1"},ye={class:"flex gap-4"},ve={class:"flex-1"},xe={key:0,class:"mt-2"},be=["src"],Ie=D({__name:"Form",props:{customer:Object,profileImageUrl:String,fromUsers:Boolean},setup(f){var _,y,v,x,b,V,S,U,h,P;const i=f,F=()=>{var u;if((u=i.customer)!=null&&u.location){const e=i.customer.location;if(typeof e=="string")try{return JSON.parse(e)}catch{return{lat:0,lng:0}}else if(typeof e=="object"&&e!==null){const l=parseFloat(e.lat),p=parseFloat(e.lng);if(!isNaN(l)&&!isNaN(p))return{lat:l,lng:p}}}return{lat:0,lng:0}},o=G({name:((_=i.customer)==null?void 0:_.name)||"",company_name:((y=i.customer)==null?void 0:y.company_name)||"",email:((v=i.customer)==null?void 0:v.email)||"",phone:((x=i.customer)==null?void 0:x.phone)||"",address:((b=i.customer)==null?void 0:b.address)||"",purok:((V=i.customer)==null?void 0:V.purok)||"",barangay:((S=i.customer)==null?void 0:S.barangay)||"",city_municipality:((U=i.customer)==null?void 0:U.city_municipality)||"",province:((h=i.customer)==null?void 0:h.province)||"",profile_image:null,customerId:((P=i.customer)==null?void 0:P.id)||null,location:F()}),I=Y,X=C(()=>Q(o.province)),$=C(()=>R(o.city_municipality));N(()=>o.province,()=>{o.city_municipality="",o.barangay=""}),N(()=>o.city_municipality,()=>{o.barangay=""});function M(u){const e=u.target;if(e.files&&e.files.length>0){const l=e.files[0],p=["image/jpeg","image/png"].includes(l.type),j=l.size<=2*1024*1024;if(!p||!j){o.profile_image=null,e.value="";const k=p?"File is too large. Max size is 2MB.":"Please select a JPG or PNG image.";window.alert(k);return}o.profile_image=l}else o.profile_image=null}function O(){if(o.customerId){const u=i.fromUsers?`${route("customers.update",o.customerId)}?from=users`:route("customers.update",o.customerId);o.post(u,{forceFormData:!0,onSuccess:()=>o.reset("profile_image")})}else o.post(route("customers.store"),{forceFormData:!0,onSuccess:()=>o.reset("profile_image")})}return(u,e)=>(B(),w("form",{onSubmit:J(O,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[a("div",Z,[a("div",ee,[t(m,{for:"name"},{default:r(()=>e[9]||(e[9]=[n("Full name *")])),_:1,__:[9]}),t(c,{id:"name",modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=l=>s(o).name=l),placeholder:"e.g., Aisha Bello",required:""},null,8,["modelValue"]),e[10]||(e[10]=a("p",{class:"text-xs text-muted-foreground mt-1"},"This is the customer’s name.",-1)),t(d,{message:s(o).errors.name},null,8,["message"])])]),a("div",oe,[a("div",se,[t(m,{for:"company_name"},{default:r(()=>e[11]||(e[11]=[n("Company (optional)")])),_:1,__:[11]}),t(c,{id:"company_name",modelValue:s(o).company_name,"onUpdate:modelValue":e[1]||(e[1]=l=>s(o).company_name=l),placeholder:"e.g., Bright Ventures Ltd."},null,8,["modelValue"]),e[12]||(e[12]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Add if this customer represents a company.",-1)),t(d,{message:s(o).errors.company_name},null,8,["message"])])]),a("div",te,[a("div",ae,[t(m,{for:"email"},{default:r(()=>e[13]||(e[13]=[n("Email address *")])),_:1,__:[13]}),t(c,{id:"email",modelValue:s(o).email,"onUpdate:modelValue":e[2]||(e[2]=l=>s(o).email=l),type:"email",placeholder:"name@company.com",required:""},null,8,["modelValue"]),e[14]||(e[14]=a("p",{class:"text-xs text-muted-foreground mt-1"},"We’ll use this to send receipts.",-1)),t(d,{message:s(o).errors.email},null,8,["message"])])]),a("div",le,[a("div",ie,[t(m,{for:"phone"},{default:r(()=>e[15]||(e[15]=[n("Phone number (optional)")])),_:1,__:[15]}),t(q,{id:"phone",modelValue:s(o).phone,"onUpdate:modelValue":e[3]||(e[3]=l=>s(o).phone=l),placeholder:"XXXXXXXXXX"},null,8,["modelValue"]),e[16]||(e[16]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Enter 10-digit Philippine mobile number.",-1)),t(d,{message:s(o).errors.phone},null,8,["message"])])]),a("div",re,[a("div",ne,[t(m,{for:"address"},{default:r(()=>e[17]||(e[17]=[n("Street Address (Optional)")])),_:1,__:[17]}),A(a("textarea",{id:"address","onUpdate:modelValue":e[4]||(e[4]=l=>s(o).address=l),placeholder:"House/Unit number, Street name",class:"w-full rounded border px-3 py-2 mt-1",rows:"2"},null,512),[[E,s(o).address]]),e[18]||(e[18]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Additional address details if needed.",-1)),t(d,{message:s(o).errors.address},null,8,["message"])])]),a("div",me,[a("div",de,[t(m,{for:"province"},{default:r(()=>e[19]||(e[19]=[n("Province")])),_:1,__:[19]}),t(g,{"model-value":s(o).province,options:s(I),placeholder:"Select province",searchPlaceholder:"Search province...","onUpdate:modelValue":e[5]||(e[5]=l=>s(o).province=String(l??""))},null,8,["model-value","options"]),t(d,{message:s(o).errors.province},null,8,["message"])])]),a("div",ue,[a("div",pe,[t(m,{for:"city_municipality"},{default:r(()=>e[20]||(e[20]=[n("City/Municipality")])),_:1,__:[20]}),t(g,{"model-value":s(o).city_municipality,options:X.value,placeholder:"Select city or municipality",searchPlaceholder:"Search city or municipality...",disabled:!s(o).province,"onUpdate:modelValue":e[6]||(e[6]=l=>s(o).city_municipality=String(l??""))},null,8,["model-value","options","disabled"]),t(d,{message:s(o).errors.city_municipality},null,8,["message"])])]),a("div",ce,[a("div",fe,[t(m,{for:"barangay"},{default:r(()=>e[21]||(e[21]=[n("Barangay")])),_:1,__:[21]}),t(g,{"model-value":s(o).barangay,options:$.value,placeholder:"Select barangay",searchPlaceholder:"Search barangay...",disabled:!s(o).city_municipality,"onUpdate:modelValue":e[7]||(e[7]=l=>s(o).barangay=String(l??""))},null,8,["model-value","options","disabled"]),t(d,{message:s(o).errors.barangay},null,8,["message"])])]),a("div",ge,[a("div",_e,[t(m,{for:"location"},{default:r(()=>e[22]||(e[22]=[n("Location")])),_:1,__:[22]}),t(K,{modelValue:s(o).location,"onUpdate:modelValue":e[8]||(e[8]=l=>s(o).location=l)},null,8,["modelValue"])])]),a("div",ye,[a("div",ve,[t(m,{for:"profile_image"},{default:r(()=>e[23]||(e[23]=[n("Profile picture (optional)")])),_:1,__:[23]}),t(c,{id:"profile_image",type:"file",accept:"image/jpeg,image/png",onChange:M}),e[24]||(e[24]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Max 2MB, JPG or PNG.",-1)),t(d,{message:s(o).errors.profile_image},null,8,["message"]),f.profileImageUrl?(B(),w("div",xe,[a("img",{src:f.profileImageUrl,alt:"Profile Image",class:"w-24 h-24 object-cover rounded-full"},null,8,be)])):L("",!0)])]),t(W,{class:"flex gap-2 justify-end"},{default:r(()=>[t(s(H),{type:"submit",variant:"default"},{default:r(()=>[n(z(s(o).customerId?"Update Customer":"Create Customer"),1)]),_:1}),T(u.$slots,"footer")]),_:3})],32))}});export{Ie as _};
