import{d as q,c as J,o as b,u as o,i as $e,j as Se,w as r,k as pe,f as _,l as X,m as M,p as m,q as me,a as s,b as e,e as w,t as p,r as E,F as W,n as se,s as Ce,v as Pe,W as re,g as De,h as ne,x as ie,y as de}from"./app-BMMojY9-.js";import{_ as ae}from"./Select.vue_vue_type_script_setup_true_lang-D86ronDD.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fe2f881_lang-BfftWwLn.js";import{a as Be,C as le,P as G,b as U,c as Y,d as z,F as ce,S as Te,_ as Me}from"./AppLayout.vue_vue_type_script_setup_true_lang-DBW-FYgo.js";import{_ as D,a as B}from"./CardContent.vue_vue_type_script_setup_true_lang-DG3YorwW.js";import{a as I,_ as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-vuV8PTfK.js";import{c as Ae}from"./index-BndpXK5-.js";import{C as ge,a as fe,L as ye,P as be,b as he,p as ve,c as _e,d as xe,i as we,e as ke,_ as ue}from"./BaseChart.vue_vue_type_script_setup_true_lang-B4EfHgW8.js";import{T as R}from"./trending-up-D7nAWss3.js";import{T as Fe,C as O}from"./trophy-Ch_fH5-d.js";import{_ as Le,a as Ve,b as ee,c as te}from"./TabsContent.vue_vue_type_script_setup_true_lang-B-o3uUuE.js";import{S as Re}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{C as je}from"./calendar-Ck708ZFh.js";import{C as Ie}from"./clock-BZkVUoW7.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DlZ3heVz.js";import"./createLucideIcon-MFhzBaTf.js";import"./RovingFocusGroup-DgaJ71-x.js";import"./VisuallyHidden-drTNZz5F.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BxWxuV-v.js";import"./chevron-right-Dz7uTY1r.js";import"./RovingFocusItem-BgPrOtxM.js";const He=q({__name:"TooltipProvider",props:{delayDuration:{default:0},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(F){const g=F;return(f,x)=>(b(),J(o(Be),$e(Se(g)),{default:r(()=>[pe(f.$slots,"default")]),_:3},16))}}),Q=q({__name:"CardDescription",props:{class:{}},setup(F){const g=F;return(f,x)=>(b(),_("p",{"data-slot":"card-description",class:X(o(Ae)("text-muted-foreground text-sm",g.class))},[pe(f.$slots,"default")],2))}}),Ke={class:"flex items-center justify-between"},Ne={class:"space-y-6"},Ue={class:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 rounded-lg p-6"},Ye={class:"flex items-center justify-between"},ze={class:"text-3xl font-bold text-blue-600"},Oe={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Ee={class:"text-right"},We={class:"text-2xl font-bold text-green-600"},qe={class:"space-y-3"},Ze={class:"flex items-center gap-3"},Qe={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center"},Ge={class:"text-sm font-medium text-blue-600"},Je={class:"font-medium text-gray-900 dark:text-gray-100"},Xe={class:"text-sm text-gray-600 dark:text-gray-400"},et={class:"text-right"},tt={class:"font-semibold text-gray-900 dark:text-gray-100"},st={class:"flex items-center gap-1 mt-1"},at={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",style:{width:"60px"}},lt={class:"flex items-center justify-between mb-4"},ot={class:"flex items-center gap-2"},rt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},nt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},it={class:"flex items-center justify-between mb-3"},dt={class:"font-semibold text-gray-900 dark:text-gray-100"},ct={class:"flex items-center gap-2"},ut={class:"text-green-600 text-sm font-medium"},pt={class:"border-t pt-4"},mt={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},gt={key:0},ft={key:1},yt=q({__name:"SalesPredictionWidget",props:{salesData:{}},setup(F){ge.register(fe,ye,be,he,ve,_e,xe,we);const g=M(!1),f=M("monthly"),x=m(()=>{const n=new Date;return n.setDate(n.getDate()+1),n}),y=M([]),P=m(()=>y.value.length?y.value.reduce((l,a)=>l+(a.confidence??.7),0)/y.value.length:.7),$=m(()=>y.value.slice(0,7).map(n=>n.predicted_sales)),K=m(()=>{var n;return((n=y.value[0])==null?void 0:n.predicted_sales)??0}),N=m(()=>y.value.length>=30?y.value.slice(0,30).reduce((n,l)=>n+l.predicted_sales,0):y.value.length>0?y.value.reduce((l,a)=>l+a.predicted_sales,0)/y.value.length*30:0),L=m(()=>Math.max(0,Math.min(25,(P.value-.6)*100))),V=M(!1),d=m(()=>{if(f.value==="yearly"){const n=new Map;return y.value.forEach((l,a)=>{const i=C(a).getFullYear().toString(),v=i;if(n.has(i)){const T=n.get(i);T.sales+=l.predicted_sales}else n.set(i,{sales:l.predicted_sales,date:i,sortKey:v})}),Array.from(n.values()).sort((l,a)=>l.sortKey.localeCompare(a.sortKey)).map(l=>({label:l.date,sales:l.sales}))}else{const n=new Map;return y.value.forEach((l,a)=>{const t=C(a),i=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,v=t.toLocaleDateString("en-US",{month:"short",year:"numeric"});if(n.has(i)){const T=n.get(i);T.sales+=l.predicted_sales}else n.set(i,{sales:l.predicted_sales,date:v,sortKey:i})}),Array.from(n.values()).sort((l,a)=>l.sortKey.localeCompare(a.sortKey)).map(l=>({label:l.date,sales:l.sales}))}}),c=m(()=>f.value==="yearly"||f.value==="monthly"?{labels:d.value.map(n=>n.label),datasets:[{label:f.value==="yearly"?"Predicted Yearly Sales":"Predicted Monthly Sales",data:d.value.map(n=>n.sales),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(59, 130, 246)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5},{label:"Confidence Range",data:d.value.map(n=>n.sales*.95),borderColor:"rgba(59, 130, 246, 0.3)",backgroundColor:"rgba(59, 130, 246, 0.05)",fill:!1,tension:.4,borderDash:[5,5],pointRadius:0}]}:{labels:$.value.map((n,l)=>{const a=C(l);return S(a).split(" ")[1]}),datasets:[{label:"Predicted Sales",data:$.value,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(59, 130, 246)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5},{label:"Confidence Range",data:$.value.map(n=>n*.95),borderColor:"rgba(59, 130, 246, 0.3)",backgroundColor:"rgba(59, 130, 246, 0.05)",fill:!1,tension:.4,borderDash:[5,5],pointRadius:0}]}),u=m(()=>{const n=f.value==="yearly"||f.value==="monthly"?d.value.map(l=>l.sales):$.value;return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(l){return`${l.dataset.label}: ${h(l.parsed.y)}`}}}},scales:{y:{beginAtZero:!1,min:Math.min(...n,0),max:Math.max(...n,1)*1.1,grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{callback:function(l){return h(l)},font:{size:11}}},x:{grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{font:{size:11}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}}),k=m(()=>Math.max(...$.value,0));m(()=>$.value.map((l,a)=>{const t=a/6*100,i=100-l/k.value*100;return`${t},${i}`}).join(" ")),m(()=>$.value.map((n,l)=>{const a=l/6*100,t=100-n/k.value*100;return{x:a,y:t}}));function h(n){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)}function S(n){return n.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function A(n){return n.toLocaleDateString("en-US",{weekday:"short"})}function C(n){const l=new Date;return l.setDate(l.getDate()+n+1),l}function oe(n){const l=Math.max(...$.value,0);return l>0?n/l*100:0}return me(async()=>{var n;try{const l=await fetch("/sales/predictions?period=month&days_ahead=30",{headers:{Accept:"application/json"}});if(!l.ok)throw new Error(`Failed to fetch predictions: ${l.status}`);const a=await l.json();V.value=!!((n=a==null?void 0:a.model_info)!=null&&n.note),y.value=Array.isArray(a==null?void 0:a.predictions)?a.predictions:[]}catch(l){V.value=!0,y.value=[],console.error(l)}}),(n,l)=>(b(),J(o(D),null,{default:r(()=>[s(o(H),null,{default:r(()=>[e("div",Ke,[s(o(I),{class:"flex items-center gap-2"},{default:r(()=>[s(o(R),{class:"w-5 h-5 text-blue-600"}),l[1]||(l[1]=w(" Sales Prediction "))]),_:1,__:[1]})])]),_:1}),e("div",{class:X(["overflow-hidden transition-all duration-300 ease-in-out",{"max-h-0":g.value,"max-h-[2000px]":!g.value}])},[s(o(B),null,{default:r(()=>[e("div",Ne,[e("div",Ue,[e("div",Ye,[e("div",null,[l[2]||(l[2]=e("h4",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," Tomorrow's Prediction ",-1)),e("p",ze,p(h(K.value)),1),e("p",Oe," Expected sales for "+p(S(x.value)),1)]),e("div",Ee,[l[3]||(l[3]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Confidence",-1)),e("div",We,p((P.value*100).toFixed(0))+"% ",1)])])]),e("div",null,[l[4]||(l[4]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Next 7 Days Forecast",-1)),e("div",qe,[(b(!0),_(W,null,E($.value,(a,t)=>(b(),_("div",{key:t,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[e("div",Ze,[e("div",Qe,[e("span",Ge,p(t+1),1)]),e("div",null,[e("p",Je,p(S(C(t))),1),e("p",Xe,p(A(C(t))),1)])]),e("div",et,[e("p",tt,p(h(a)),1),e("div",st,[e("div",at,[e("div",{class:"h-full bg-blue-500 rounded-full transition-all duration-300",style:se({width:oe(a)+"%"})},null,4)])])])]))),128))])]),e("div",null,[e("div",lt,[l[5]||(l[5]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100"},"Sales Forecast Trend",-1)),e("div",ot,[s(o(le),{class:"w-4 h-4 text-muted-foreground"}),s(o(ae),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=a=>f.value=a),options:[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],placeholder:"Select period",class:"w-32"},null,8,["modelValue"])])]),e("div",rt,[s(o(ke),{data:c.value,options:u.value,height:"200px"},null,8,["data","options"])])]),e("div",null,[l[7]||(l[7]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Monthly Trend",-1)),e("div",nt,[e("div",it,[l[6]||(l[6]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Predicted Monthly Revenue",-1)),e("span",dt,p(h(N.value)),1)]),e("div",ct,[s(o(R),{class:"w-4 h-4 text-green-600"}),e("span",ut," +"+p(L.value.toFixed(1))+"% vs current month ",1)])])]),e("div",pt,[e("div",mt,[V.value?(b(),_("span",gt,"Using sample data")):(b(),_("span",ft,"Live predictions")),l[8]||(l[8]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),e("span",null,"Ready")],-1))])])])]),_:1})],2)]),_:1}))}}),bt={class:"flex items-center justify-between"},ht={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},vt={class:"bg-indigo-50 dark:bg-indigo-950/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-4"},_t={class:"flex items-center justify-between"},xt={class:"bg-emerald-50 dark:bg-emerald-950/20 border border-emerald-200 dark:border-emerald-800 rounded-lg p-4"},wt={class:"flex items-center justify-between"},kt={class:"bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4"},$t={class:"flex items-center justify-between"},St={class:"mb-6"},Ct={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Dt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Bt={class:"space-y-3"},Tt={class:"flex items-center gap-3"},Mt={class:"w-8 h-8 bg-indigo-100 dark:bg-indigo-900/20 rounded-full flex items-center justify-center"},At={class:"text-sm font-medium text-indigo-600"},Ft={class:"font-medium text-gray-900 dark:text-gray-100"},Lt={class:"text-right"},Vt={class:"font-semibold text-gray-900 dark:text-gray-100"},Rt={class:"text-sm text-gray-600 dark:text-gray-400"},jt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},It={class:"space-y-3"},Ht={class:"flex items-center gap-2"},Kt={class:"text-sm text-gray-700 dark:text-gray-300"},Nt={class:"flex items-center gap-2"},Ut={class:"w-16 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Yt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},zt=q({__name:"ProductSalesTrendWidget",props:{salesByDate:{},topProducts:{}},setup(F){ge.register(fe,ye,be,he,ve,_e,xe,we);const g=M(!1),f=F,x=m(()=>{const d=new Date,c=[];for(let u=6;u>=0;u--){const k=new Date(d);k.setDate(k.getDate()-u);const h=k.toISOString().split("T")[0],S=f.salesByDate.find(A=>A.date===h);c.push({date:h,dateObj:k,sales:S?S.sales:0})}return c}),y=m(()=>({labels:x.value.map(d=>d.dateObj.toLocaleDateString("en-US",{weekday:"short"})),datasets:[{label:"Daily Sales",data:x.value.map(d=>d.sales),borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(99, 102, 241)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:5}]})),P=m(()=>{const d=Math.max(...x.value.map(u=>u.sales),0);if(d===0)return 100;const c=Math.ceil(d/50)*50;return Math.max(c,100)}),$=m(()=>{const d=Math.max(...x.value.map(u=>u.sales),0);return d===0?50:Math.ceil(d/50)*50>=400?100:50}),K=m(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(d){return d.datasetIndex===0?`${d.dataset.label}: ${d.parsed.y} units`:`${d.dataset.label}: ${d.parsed.y} units`}}}},scales:{y:{beginAtZero:!0,min:0,suggestedMax:P.value,grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{stepSize:$.value,font:{size:11}}},x:{grid:{color:"rgba(156, 163, 175, 0.1)"},ticks:{font:{size:11}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}})),N=m(()=>f.topProducts.map(d=>({name:d.name,units:d.total_quantity,revenue:d.total_revenue}))),L=[{name:"High Performance",percentage:35,color:"#10B981"},{name:"Medium Performance",percentage:45,color:"#3B82F6"},{name:"Low Performance",percentage:20,color:"#F59E0B"}];m(()=>{const d=x.value,c=Math.max(...d.map(h=>h.sales),1),u=0;return d.map((h,S)=>{const A=S/Math.max(1,d.length-1)*100,C=100-((h.sales-u)/(c-u)*80+10);return`${A},${C}`}).join(" ")}),m(()=>{const d=x.value,c=Math.max(...d.map(k=>k.sales),1),u=0;return d.map((k,h)=>{const S=h/Math.max(1,d.length-1)*100,A=100-((k.sales-u)/(c-u)*80+10);return{x:S,y:A}})});function V(d){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(d)}return(d,c)=>(b(),J(o(D),null,{default:r(()=>[s(o(H),null,{default:r(()=>[e("div",bt,[s(o(I),{class:"flex items-center gap-2"},{default:r(()=>[s(o(G),{class:"w-5 h-5 text-indigo-600"}),c[0]||(c[0]=w(" Product Sales Trend "))]),_:1,__:[0]})])]),_:1}),e("div",{class:X(["overflow-hidden transition-all duration-300 ease-in-out",{"max-h-0":g.value,"max-h-[2000px]":!g.value}])},[s(o(B),null,{default:r(()=>[e("div",ht,[e("div",vt,[e("div",_t,[c[1]||(c[1]=e("div",null,[e("p",{class:"text-sm font-medium text-indigo-600 dark:text-indigo-400"},"Total Products Sold"),e("p",{class:"text-2xl font-bold text-indigo-700 dark:text-indigo-300"},"8,456")],-1)),s(o(G),{class:"w-8 h-8 text-indigo-600"})]),c[2]||(c[2]=e("p",{class:"text-xs text-indigo-600 dark:text-indigo-400 mt-1"},"+15% from last month",-1))]),e("div",xt,[e("div",wt,[c[3]||(c[3]=e("div",null,[e("p",{class:"text-sm font-medium text-emerald-600 dark:text-emerald-400"},"Top Product"),e("p",{class:"text-lg font-bold text-emerald-700 dark:text-emerald-300"},"Ink Cartridge")],-1)),s(o(Fe),{class:"w-8 h-8 text-emerald-600"})]),c[4]||(c[4]=e("p",{class:"text-xs text-emerald-600 dark:text-emerald-400 mt-1"},"1,247 units sold",-1))]),e("div",kt,[e("div",$t,[c[5]||(c[5]=e("div",null,[e("p",{class:"text-sm font-medium text-amber-600 dark:text-amber-400"},"Avg Daily Sales"),e("p",{class:"text-2xl font-bold text-amber-700 dark:text-amber-300"},"282")],-1)),s(o(R),{class:"w-8 h-8 text-amber-600"})]),c[6]||(c[6]=e("p",{class:"text-xs text-amber-600 dark:text-amber-400 mt-1"},"+8% from last week",-1))])]),e("div",St,[c[7]||(c[7]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Product Sales Trend (Last 7 Days)",-1)),e("div",Ct,[s(o(ke),{data:y.value,options:K.value,height:"200px"},null,8,["data","options"])])]),e("div",Pt,[e("div",null,[c[8]||(c[8]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Top Selling Products",-1)),e("div",Dt,[e("div",Bt,[(b(!0),_(W,null,E(N.value,u=>(b(),_("div",{key:u.name,class:"flex items-center justify-between"},[e("div",Tt,[e("div",Mt,[e("span",At,p(u.name.charAt(0)),1)]),e("div",null,[e("p",Ft,p(u.name),1)])]),e("div",Lt,[e("p",Vt,p(u.units)+" units",1),e("p",Rt,p(V(u.revenue)),1)])]))),128))])])]),e("div",null,[c[9]||(c[9]=e("h4",{class:"font-medium text-gray-900 dark:text-gray-100 mb-4"},"Product Performance",-1)),e("div",jt,[e("div",It,[(b(),_(W,null,E(L,u=>e("div",{key:u.name,class:"flex items-center justify-between"},[e("div",Ht,[e("div",{class:"w-3 h-3 rounded-full",style:se({backgroundColor:u.color})},null,4),e("span",Kt,p(u.name),1)]),e("div",Nt,[e("div",Ut,[e("div",{class:"h-full rounded-full transition-all duration-300",style:se({width:u.percentage+"%",backgroundColor:u.color})},null,4)]),e("span",Yt,p(u.percentage)+"%",1)])])),64))])])])])]),_:1})],2)]),_:1}))}}),Ot={class:"dashboard-wrapper"},Et={class:"dashboard-header"},Wt={class:"dashboard-filters"},qt={class:"filter-group"},Zt={class:"filter-label"},Qt={key:0,class:"date-range-group"},Gt={class:"date-input-group"},Jt={class:"date-input-group"},Xt={class:"metrics-grid",style:{"grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))"}},es={class:"metric-header"},ts={class:"metric-info"},ss={class:"metric-label-group"},as={class:"metric-value"},ls={class:"metric-header"},os={class:"metric-info"},rs={class:"metric-label-group"},ns={class:"metric-value"},is={class:"metric-icon-wrapper metric-icon-green"},ds={class:"metric-header"},cs={class:"metric-info"},us={class:"metric-label-group"},ps={class:"metric-value"},ms={class:"metric-icon-wrapper metric-icon-yellow"},gs={class:"metric-header"},fs={class:"metric-info"},ys={class:"metric-label-group"},bs={class:"metric-value"},hs={class:"metric-icon-wrapper metric-icon-orange"},vs={class:"metric-header"},_s={class:"metric-info"},xs={class:"metric-label-group"},ws={class:"metric-value"},ks={class:"metric-icon-wrapper metric-icon-purple"},$s={class:"analytics-section"},Ss={class:"section-header",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem"}},Cs={class:"filter-group",style:{display:"flex","align-items":"center",gap:"0.5rem"}},Ps={class:"filter-label",style:{display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.875rem","font-weight":"500",color:"var(--foreground)"}},Ds={class:"analytics-tabs-wrapper"},Bs={class:"category-section"},Ts={key:0,class:"empty-state"},Ms={key:1},As={key:0,class:"text-xs text-muted-foreground text-center mt-2"},Fs={class:"tables-grid"},Ls={class:"table-wrapper"},Vs={class:"data-table"},Rs={class:"table-cell table-cell-bold"},js={class:"table-cell table-cell-right"},Is={class:"table-cell table-cell-right table-cell-highlight"},Hs={class:"table-wrapper"},Ks={class:"data-table"},Ns={class:"table-cell"},Us=["href"],Ys={class:"table-cell"},zs={class:"table-cell table-cell-right table-cell-bold"},Os={class:"table-cell table-cell-center"},ma=q({__name:"Dashboard",props:{salesData:{},topProducts:{},salesByDate:{},salesByCategory:{},recentInvoices:{},filters:{},lowStockProducts:{}},setup(F){var n,l;const g=F,f=M(g.filters.period),x=M(g.filters.start_date),y=M(g.filters.end_date),P=M("monthly"),$=[{title:"Dashboard",href:"/dashboard"}],K=[{value:"week",label:"Last 7 Days"},{value:"month",label:"Last 30 Days"},{value:"quarter",label:"Last 3 Months"},{value:"year",label:"Last 12 Months"},{value:"custom",label:"Choose Dates"}];function N(){re.get("/dashboard",{period:f.value,start_date:x.value,end_date:y.value},{preserveState:!0,replace:!0})}Ce([f,x,y],()=>{N()});const L=Pe(),V=Array.isArray((n=L.props.auth)==null?void 0:n.userRoles)&&L.props.auth.userRoles.includes("Admin"),d=Array.isArray((l=L.props.auth)==null?void 0:l.userRoles)&&L.props.auth.userRoles.includes("Staff")&&!V;me(()=>{const a=new Date().toISOString().split("T")[0],t=localStorage.getItem("lowStockAlertLastShown");if(d&&g.lowStockProducts&&g.lowStockProducts.length>0&&t!==a){const i=g.lowStockProducts.slice(0,10),v=g.lowStockProducts.length>10?g.lowStockProducts.length-10:0,T=i.map(j=>`
                <tr style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 8px 12px; font-weight: 600;">${j.name}</td>
                    <td style="padding: 8px 12px; color: #6b7280;">${j.category}</td>
                    <td style="padding: 8px 12px; color: #6b7280;">${j.SKU||"N/A"}</td>
                    <td style="padding: 8px 12px; text-align: center;">
                        <span style="color: #dc2626; font-weight: bold; font-size: 14px;">${j.stock}</span>
                    </td>
                </tr>
            `).join(""),Z=v>0?`<p style="margin-top: 10px; text-align: center; color: #6b7280;"><strong>And ${v} more product(s) with low stock.</strong></p>`:"";Re.fire({icon:"warning",title:"Low Stock Alert",html:`
                <p style="margin-bottom: 15px;">There are <strong>${g.lowStockProducts.length}</strong> product(s) with low stock (≤10 units):</p>
                <div style="max-height: 400px; overflow-y: auto; margin: 15px 0;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                        <thead>
                            <tr style="background-color: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">Product Name</th>
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">Category</th>
                                <th style="padding: 10px 12px; text-align: left; font-weight: 600; color: #374151;">SKU</th>
                                <th style="padding: 10px 12px; text-align: center; font-weight: 600; color: #374151;">Stock</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${T}
                        </tbody>
                    </table>
                </div>
                ${Z}
                <p style="margin-top: 15px; color: #6b7280;">Please review and restock these items soon.</p>
            `,confirmButtonText:"View Products",confirmButtonColor:"#8f5be8",showCancelButton:!0,cancelButtonText:"Dismiss",cancelButtonColor:"#6b7280",width:"700px"}).then(j=>{localStorage.setItem("lowStockAlertLastShown",a),j.isConfirmed&&re.visit("/products?low_stock=1")})}});const c=m(()=>{if(P.value==="yearly"){const a=new Map;return g.salesByDate.forEach(t=>{const v=new Date(t.date).getFullYear().toString();if(a.has(v)){const T=a.get(v);T.sales+=t.sales,T.invoices+=t.invoices}else a.set(v,{sales:t.sales,invoices:t.invoices,date:v,sortKey:v})}),Array.from(a.values()).sort((t,i)=>t.sortKey.localeCompare(i.sortKey))}else{const a=new Map;return g.salesByDate.forEach(t=>{const i=new Date(t.date),v=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`,T=i.toLocaleDateString("en-US",{month:"short",year:"numeric"});if(a.has(v)){const Z=a.get(v);Z.sales+=t.sales,Z.invoices+=t.invoices}else a.set(v,{sales:t.sales,invoices:t.invoices,date:T,sortKey:v})}),Array.from(a.values()).sort((t,i)=>t.sortKey.localeCompare(i.sortKey))}}),u=m(()=>({labels:c.value.map(a=>a.date),datasets:[{label:P.value==="yearly"?"Yearly Sales":"Monthly Sales",data:c.value.map(a=>a.sales),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:P.value==="yearly"?"Yearly Invoices":"Monthly Invoices",data:c.value.map(a=>a.invoices),borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!1,tension:.4,yAxisID:"y1"}]})),k=m(()=>({plugins:{title:{display:!0,text:"Sales Trend"},legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Sales Amount (₱)"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Number of Invoices"},grid:{drawOnChartArea:!1}}}})),h=m(()=>[...g.salesByCategory].sort((a,t)=>t.total_revenue-a.total_revenue).slice(0,5)),S=m(()=>({labels:h.value.map(a=>a.category_name),datasets:[{data:h.value.map(a=>a.total_revenue),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]})),A=m(()=>({plugins:{title:{display:!0,text:"Sales by Category"},legend:{position:"bottom"}}}));m(()=>({labels:g.topProducts.map(a=>a.name),datasets:[{label:"Revenue",data:g.topProducts.map(a=>a.total_revenue),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgb(59, 130, 246)",borderWidth:1}]})),m(()=>({plugins:{title:{display:!0,text:"Top Products by Revenue"},legend:{display:!1}},scales:{y:{title:{display:!0,text:"Revenue (₱)"}}}}));function C(a){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(a)}return M(!1),[{id:1,title:"New Order Received",message:"Order #1234 has been placed for ₱2,500",time:"2 minutes ago",type:"order",read:!1},{id:2,title:"Low Stock Alert",message:"Ink (brother 500 C, Cyan) is running low on stock",time:"15 minutes ago",type:"alert",read:!1},{id:3,title:"Sales Target Achieved",message:"Congratulations! You've reached 85% of your monthly sales target",time:"1 hour ago",type:"success",read:!0},{id:4,title:"Payment Received",message:"Payment of ₱1,800 has been received for Invoice #5678",time:"2 hours ago",type:"payment",read:!0}].filter(a=>!a.read).length,(a,t)=>(b(),J(Me,{breadcrumbs:$},{default:r(()=>[s(o(De),{title:"Dashboard"}),s(o(He),null,{default:r(()=>[e("div",Ot,[e("div",Et,[t[7]||(t[7]=e("div",null,[e("h1",{class:"dashboard-title"},"Dashboard"),e("p",{class:"dashboard-subtitle"},"View your business performance at a glance")],-1)),e("div",Wt,[e("div",qt,[e("label",Zt,[s(o(je),{class:"w-4 h-4"}),t[4]||(t[4]=w(" View Period "))]),s(o(ae),{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=i=>f.value=i),options:K,placeholder:"Choose time period",class:"period-select"},null,8,["modelValue"])]),f.value==="custom"?(b(),_("div",Qt,[e("div",Gt,[t[5]||(t[5]=e("label",{class:"date-label"},"Start Date",-1)),ie(e("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>x.value=i),type:"date",class:"date-input"},null,512),[[de,x.value]])]),e("div",Jt,[t[6]||(t[6]=e("label",{class:"date-label"},"End Date",-1)),ie(e("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>y.value=i),type:"date",class:"date-input"},null,512),[[de,y.value]])])])):ne("",!0)])]),t[39]||(t[39]=e("div",{class:"metrics-section"},[e("h2",{class:"section-title"},"Your Business Overview"),e("p",{class:"section-description"},"Quick summary of your sales performance")],-1)),e("div",Xt,[s(D,{class:"metric-card"},{default:r(()=>[s(B,{class:"metric-card-content"},{default:r(()=>[e("div",es,[e("div",ts,[e("div",ss,[t[9]||(t[9]=e("span",{class:"metric-label"},"Total Revenue",-1)),s(o(U),null,{default:r(()=>[s(o(Y),{"as-child":""},{default:r(()=>[s(o(O),{class:"help-icon"})]),_:1}),s(o(z),null,{default:r(()=>t[8]||(t[8]=[e("p",null,"The total amount of money you've earned from all sales",-1)])),_:1,__:[8]})]),_:1})]),e("p",as,p(C(a.salesData.total_sales)),1),t[10]||(t[10]=e("p",{class:"metric-description"},"All sales combined",-1))]),t[11]||(t[11]=e("div",{class:"metric-icon-wrapper metric-icon-blue"},[e("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 119.43 122.88",class:"metric-icon"},[e("path",{d:"M118.45,51l1,1-.74,9.11H99A40.52,40.52,0,0,1,81.88,78.43q-11.44,6.28-27.71,7h-15l.5,37.43H21.42l.74-36.94-.24-24.87H1L0,59.84.74,51H21.92l-.25-15.26H1l-1-1,.74-9.11H21.67L21.42.25,63.29,0Q78.8,0,88.65,6.53T102,25.61h16.5l1,1.23-.74,8.87h-15v3.94A53.17,53.17,0,0,1,102.44,51ZM39.65,25.61H81.26Q74.85,14,58.61,13.3L39.89,14l-.24,11.57ZM39.4,51H83.23a39.51,39.51,0,0,0,1.23-9.6,46.17,46.17,0,0,0-.24-5.66H39.65L39.4,51ZM58.61,71.91q12.56-2.72,19.21-10.84H39.4l-.25,10.1,19.46.74Z"})])],-1))])]),_:1})]),_:1}),s(D,{class:"metric-card"},{default:r(()=>[s(B,{class:"metric-card-content"},{default:r(()=>[e("div",ls,[e("div",os,[e("div",rs,[t[13]||(t[13]=e("span",{class:"metric-label"},"Total Invoices",-1)),s(o(U),null,{default:r(()=>[s(o(Y),{"as-child":""},{default:r(()=>[s(o(O),{class:"help-icon"})]),_:1}),s(o(z),null,{default:r(()=>t[12]||(t[12]=[e("p",null,"The number of sales transactions you've completed",-1)])),_:1,__:[12]})]),_:1})]),e("p",ns,p(a.salesData.total_invoices),1),t[14]||(t[14]=e("p",{class:"metric-description"},"Sales transactions",-1))]),e("div",is,[s(o(ce),{class:"metric-icon"})])])]),_:1})]),_:1}),s(D,{class:"metric-card"},{default:r(()=>[s(B,{class:"metric-card-content"},{default:r(()=>[e("div",ds,[e("div",cs,[e("div",us,[t[16]||(t[16]=e("span",{class:"metric-label"},"Average Sale Amount",-1)),s(o(U),null,{default:r(()=>[s(o(Y),{"as-child":""},{default:r(()=>[s(o(O),{class:"help-icon"})]),_:1}),s(o(z),null,{default:r(()=>t[15]||(t[15]=[e("p",null,"The average amount customers spend per transaction",-1)])),_:1,__:[15]})]),_:1})]),e("p",ps,p(C(a.salesData.average_order_value)),1),t[17]||(t[17]=e("p",{class:"metric-description"},"Per transaction",-1))]),e("div",ms,[s(o(R),{class:"metric-icon"})])])]),_:1})]),_:1}),s(D,{class:"metric-card"},{default:r(()=>[s(B,{class:"metric-card-content"},{default:r(()=>[e("div",gs,[e("div",fs,[e("div",ys,[t[19]||(t[19]=e("span",{class:"metric-label"},"Awaiting Payment",-1)),s(o(U),null,{default:r(()=>[s(o(Y),{"as-child":""},{default:r(()=>[s(o(O),{class:"help-icon"})]),_:1}),s(o(z),null,{default:r(()=>t[18]||(t[18]=[e("p",null,"Invoices that are still waiting to be paid",-1)])),_:1,__:[18]})]),_:1})]),e("p",bs,p(a.salesData.pending_invoices),1),t[20]||(t[20]=e("p",{class:"metric-description"},"Need attention",-1))]),e("div",hs,[s(o(Ie),{class:"metric-icon"})])])]),_:1})]),_:1}),s(D,{class:"metric-card"},{default:r(()=>[s(B,{class:"metric-card-content"},{default:r(()=>[e("div",vs,[e("div",_s,[e("div",xs,[t[22]||(t[22]=e("span",{class:"metric-label"},"Pending Orders",-1)),s(o(U),null,{default:r(()=>[s(o(Y),{"as-child":""},{default:r(()=>[s(o(O),{class:"help-icon"})]),_:1}),s(o(z),null,{default:r(()=>t[21]||(t[21]=[e("p",null,"Customer orders waiting for staff approval",-1)])),_:1,__:[21]})]),_:1})]),e("p",ws,p(a.salesData.pending_orders),1),t[23]||(t[23]=e("p",{class:"metric-description"},"Require review",-1))]),e("div",ks,[s(o(Te),{class:"metric-icon"})])])]),_:1})]),_:1})]),e("div",$s,[e("div",Ss,[t[25]||(t[25]=e("div",null,[e("h2",{class:"section-title"},"Sales Trends & Insights"),e("p",{class:"section-description"},"Track how your sales are performing over time")],-1)),e("div",Cs,[e("label",Ps,[s(o(le),{class:"w-4 h-4"}),t[24]||(t[24]=w(" View Period "))]),s(o(ae),{modelValue:P.value,"onUpdate:modelValue":t[3]||(t[3]=i=>P.value=i),options:[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],placeholder:"Select period",class:"period-select",style:{"min-width":"120px"}},null,8,["modelValue"])])])]),e("div",Ds,[s(o(Le),{defaultValue:"sales-trend",class:"analytics-tabs-full"},{default:r(()=>[s(o(Ve),{class:"tabs-list-full"},{default:r(()=>[s(o(ee),{value:"sales-trend",class:"tab-trigger-full"},{default:r(()=>[s(o(R),{class:"tab-icon"}),t[26]||(t[26]=w(" Your Sales Trend "))]),_:1,__:[26]}),s(o(ee),{value:"sales-prediction",class:"tab-trigger-full"},{default:r(()=>[s(o(R),{class:"tab-icon"}),t[27]||(t[27]=w(" Sales Prediction "))]),_:1,__:[27]}),s(o(ee),{value:"product-trend",class:"tab-trigger-full"},{default:r(()=>[s(o(le),{class:"tab-icon"}),t[28]||(t[28]=w(" Product Sales Trend "))]),_:1,__:[28]})]),_:1}),s(o(te),{value:"sales-trend",class:"tab-content-full"},{default:r(()=>[s(D,{class:"chart-card"},{default:r(()=>[s(H,null,{default:r(()=>[s(I,{class:"chart-title"},{default:r(()=>[s(o(R),{class:"chart-title-icon"}),t[29]||(t[29]=w(" Your Sales Trend "))]),_:1,__:[29]}),s(Q,null,{default:r(()=>[w(" See how your "+p(P.value==="yearly"?"yearly":"monthly")+" sales and number of transactions change over time ",1)]),_:1})]),_:1}),s(B,null,{default:r(()=>[s(ue,{type:"line",data:u.value,options:k.value,height:"350px"},null,8,["data","options"])]),_:1})]),_:1})]),_:1}),s(o(te),{value:"sales-prediction",class:"tab-content-full"},{default:r(()=>[s(yt,{"sales-data":a.salesByDate},null,8,["sales-data"])]),_:1}),s(o(te),{value:"product-trend",class:"tab-content-full"},{default:r(()=>[s(zt,{"sales-by-date":a.salesByDate,"top-products":a.topProducts},null,8,["sales-by-date","top-products"])]),_:1})]),_:1})]),e("div",Bs,[s(D,{class:"chart-card"},{default:r(()=>[s(H,null,{default:r(()=>[s(I,{class:"chart-title"},{default:r(()=>[s(o(G),{class:"chart-title-icon"}),t[30]||(t[30]=w(" Sales by Product Category "))]),_:1,__:[30]}),s(Q,null,{default:r(()=>t[31]||(t[31]=[w(" See which product categories bring in the most revenue ")])),_:1,__:[31]})]),_:1}),s(B,null,{default:r(()=>[g.salesByCategory.length===0?(b(),_("div",Ts,t[32]||(t[32]=[e("p",{class:"empty-title"},"No category data for the selected period",-1),e("p",{class:"empty-subtitle"},"Try expanding the date range or confirming there are paid invoices.",-1)]))):(b(),_("div",Ms,[s(ue,{type:"doughnut",data:S.value,options:A.value,height:"300px"},null,8,["data","options"]),g.salesByCategory.length>5?(b(),_("p",As," Showing top 5 categories ("+p(g.salesByCategory.length)+" total) ",1)):ne("",!0)]))]),_:1})]),_:1})]),t[40]||(t[40]=e("div",{class:"section-header"},[e("h2",{class:"section-title"},"Product Performance & Recent Activity"),e("p",{class:"section-description"},"Your best-selling products and latest transactions")],-1)),e("div",Fs,[s(D,{class:"table-card"},{default:r(()=>[s(H,null,{default:r(()=>[s(I,{class:"table-title"},{default:r(()=>[s(o(G),{class:"table-title-icon"}),t[33]||(t[33]=w(" Best-Selling Products "))]),_:1,__:[33]}),s(Q,null,{default:r(()=>t[34]||(t[34]=[w(" Products that have generated the most revenue ")])),_:1,__:[34]})]),_:1}),s(B,null,{default:r(()=>[e("div",Ls,[e("table",Vs,[t[35]||(t[35]=e("thead",null,[e("tr",{class:"table-header-row"},[e("th",{class:"table-header"},"Product Name"),e("th",{class:"table-header table-header-right"},"Units Sold"),e("th",{class:"table-header table-header-right"},"Revenue")])],-1)),e("tbody",null,[(b(!0),_(W,null,E(a.topProducts,i=>(b(),_("tr",{key:i.id,class:"table-row"},[e("td",Rs,p(i.name),1),e("td",js,p(i.total_quantity.toLocaleString()),1),e("td",Is,p(C(i.total_revenue)),1)]))),128))])])])]),_:1})]),_:1}),s(D,{class:"table-card"},{default:r(()=>[s(H,null,{default:r(()=>[s(I,{class:"table-title"},{default:r(()=>[s(o(ce),{class:"table-title-icon"}),t[36]||(t[36]=w(" Recent Transactions "))]),_:1,__:[36]}),s(Q,null,{default:r(()=>t[37]||(t[37]=[w(" Your most recent sales and invoices ")])),_:1,__:[37]})]),_:1}),s(B,null,{default:r(()=>[e("div",Hs,[e("table",Ks,[t[38]||(t[38]=e("thead",null,[e("tr",{class:"table-header-row"},[e("th",{class:"table-header"},"Invoice #"),e("th",{class:"table-header"},"Customer"),e("th",{class:"table-header table-header-right"},"Amount"),e("th",{class:"table-header table-header-center"},"Status")])],-1)),e("tbody",null,[(b(!0),_(W,null,E(a.recentInvoices,i=>(b(),_("tr",{key:i.id,class:"table-row"},[e("td",Ns,[e("a",{href:`/invoices/${i.id}`,class:"invoice-link"}," #"+p(i.id),9,Us)]),e("td",Ys,p(i.customer_name),1),e("td",zs,p(C(i.total_amount)),1),e("td",Os,[e("span",{class:X({"status-badge":!0,"status-paid":i.status==="paid","status-pending":i.status==="pending","status-cancelled":i.status==="cancelled"})},p(i.status.charAt(0).toUpperCase()+i.status.slice(1)),3)])]))),128))])])])]),_:1})]),_:1})])])]),_:1})]),_:1}))}});export{ma as default};
