import{d as L,D as O,f as w,o as P,b as r,a as l,w as s,e as i,u as n,A as F,B as $,h as T,k as W,t as A,q as J}from"./app-D8GMqoQL.js";import{_ as m}from"./InputError.vue_vue_type_script_setup_true_lang-BCon8n8M.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-Dc3JaC7p.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-D3J-Rw-h.js";import{_ as R}from"./Select.vue_vue_type_script_setup_true_lang-NzKcQ-CX.js";import{_ as z}from"./index-CKTUUg4B.js";import{L as G}from"./LocationInput-BRsAeaWu.js";import{S as p}from"./sweetalert2.esm.all-BQIkj5Wb.js";const H={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Z={key:0,class:"mt-2"},ee=["src"],ae={class:"flex gap-2 justify-end"},de=L({__name:"Form",props:{branch:Object,branchImageUrl:String},setup(f){var b,_,h,v,V,X,x,y,B,U,I,S,C;const o=f,D=[{value:"",label:"Select Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],E=()=>{var u;if((u=o.branch)!=null&&u.location){const e=o.branch.location;if(typeof e=="string")try{return JSON.parse(e)}catch{return{lat:0,lng:0}}else if(typeof e=="object"&&e!==null){const t=parseFloat(e.lat),N=parseFloat(e.lng);if(!isNaN(t)&&!isNaN(N))return{lat:t,lng:N}}}return{lat:0,lng:0}},a=O({name:((b=o.branch)==null?void 0:b.name)||"",code:((_=o.branch)==null?void 0:_.code)||"",address:((h=o.branch)==null?void 0:h.address)||"",phone:((v=o.branch)==null?void 0:v.phone)||"",email:((V=o.branch)==null?void 0:V.email)||"",description:((X=o.branch)==null?void 0:X.description)||"",status:((x=o.branch)==null?void 0:x.status)||"active",manager_name:((y=o.branch)==null?void 0:y.manager_name)||"",manager_phone:((B=o.branch)==null?void 0:B.manager_phone)||"",manager_email:((U=o.branch)==null?void 0:U.manager_email)||"",opening_time:((I=o.branch)==null?void 0:I.opening_time)||"",closing_time:((S=o.branch)==null?void 0:S.closing_time)||"",branch_image:null,branchId:((C=o.branch)==null?void 0:C.id)||null,location:E()});function M(u){const e=u.target;e.files&&e.files.length>0?a.branch_image=e.files[0]:a.branch_image=null}function c(u){let e=u.replace(/[^0-9+]/g,"");return e.startsWith("+")?(e.length>1&&!e.startsWith("+63")&&(e="+63"+e.substring(1).replace(/[^0-9]/g,"")),e.length>13&&(e=e.substring(0,13))):(e.length>0&&e[0]==="0"&&e.length>1&&e[1]!=="9"&&(e="09"+e.substring(2).replace(/[^0-9]/g,"")),e.startsWith("63")&&(e="+"+e),e.length>11&&!e.startsWith("+")&&(e=e.substring(0,11))),e}function k(u){const e=u.target,t=c(e.value);t!==e.value&&(e.value=t),a.phone=t}function q(u){const e=u.target,t=c(e.value);t!==e.value&&(e.value=t),a.manager_phone=t}function j(){a.branchId?a.post(route("branches.update",a.branchId),{forceFormData:!0,onSuccess:()=>{a.reset("branch_image"),p.fire({title:"Success!",text:"Branch updated successfully.",icon:"success",confirmButtonColor:"#8f5be8"})},onError:()=>{p.fire({title:"Error!",text:"Failed to update branch. Please check the form and try again.",icon:"error",confirmButtonColor:"#8f5be8"})}}):a.post(route("branches.store"),{forceFormData:!0,onSuccess:()=>{a.reset("branch_image"),p.fire({title:"Success!",text:"Branch created successfully.",icon:"success",confirmButtonColor:"#8f5be8"})},onError:()=>{p.fire({title:"Error!",text:"Failed to create branch. Please check the form and try again.",icon:"error",confirmButtonColor:"#8f5be8"})}})}return(u,e)=>(P(),w("form",{onSubmit:J(j,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[r("div",H,[r("div",null,[l(d,{for:"name"},{default:s(()=>e[13]||(e[13]=[i("Branch Name *")])),_:1,__:[13]}),l(g,{id:"name",modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=t=>n(a).name=t),required:""},null,8,["modelValue"]),l(m,{message:n(a).errors.name},null,8,["message"])]),r("div",null,[l(d,{for:"code"},{default:s(()=>e[14]||(e[14]=[i("Branch Code *")])),_:1,__:[14]}),l(g,{id:"code",modelValue:n(a).code,"onUpdate:modelValue":e[1]||(e[1]=t=>n(a).code=t),placeholder:"e.g., BR001",required:""},null,8,["modelValue"]),l(m,{message:n(a).errors.code},null,8,["message"])])]),r("div",null,[l(d,{for:"address"},{default:s(()=>e[15]||(e[15]=[i("Address *")])),_:1,__:[15]}),F(r("textarea",{id:"address","onUpdate:modelValue":e[2]||(e[2]=t=>n(a).address=t),class:"w-full rounded border px-3 py-2 mt-1",rows:"3",required:""},null,512),[[$,n(a).address]]),l(m,{message:n(a).errors.address},null,8,["message"])]),r("div",K,[r("div",null,[l(d,{for:"phone"},{default:s(()=>e[16]||(e[16]=[i("Phone")])),_:1,__:[16]}),l(g,{id:"phone",modelValue:n(a).phone,"onUpdate:modelValue":e[3]||(e[3]=t=>n(a).phone=t),placeholder:"09XXXXXXXXX or +639XXXXXXXXX",inputmode:"tel",pattern:"^(?:\\+?63|0)9\\d{9}$",maxlength:"13",onInput:k},null,8,["modelValue"]),e[17]||(e[17]=r("p",{class:"text-xs text-muted-foreground mt-1"},"Philippine mobile number format only.",-1)),l(m,{message:n(a).errors.phone},null,8,["message"])]),r("div",null,[l(d,{for:"email"},{default:s(()=>e[18]||(e[18]=[i("Email")])),_:1,__:[18]}),l(g,{id:"email",modelValue:n(a).email,"onUpdate:modelValue":e[4]||(e[4]=t=>n(a).email=t),type:"email"},null,8,["modelValue"]),l(m,{message:n(a).errors.email},null,8,["message"])])]),r("div",null,[l(d,{for:"description"},{default:s(()=>e[19]||(e[19]=[i("Description")])),_:1,__:[19]}),F(r("textarea",{id:"description","onUpdate:modelValue":e[5]||(e[5]=t=>n(a).description=t),class:"w-full rounded border px-3 py-2 mt-1",rows:"3"},null,512),[[$,n(a).description]]),l(m,{message:n(a).errors.description},null,8,["message"])]),r("div",null,[l(d,{for:"status"},{default:s(()=>e[20]||(e[20]=[i("Status *")])),_:1,__:[20]}),l(R,{modelValue:n(a).status,"onUpdate:modelValue":e[6]||(e[6]=t=>n(a).status=t),options:D,required:""},null,8,["modelValue"]),l(m,{message:n(a).errors.status},null,8,["message"])]),r("div",Q,[r("div",null,[l(d,{for:"opening_time"},{default:s(()=>e[21]||(e[21]=[i("Opening Time")])),_:1,__:[21]}),l(g,{id:"opening_time",modelValue:n(a).opening_time,"onUpdate:modelValue":e[7]||(e[7]=t=>n(a).opening_time=t),type:"time"},null,8,["modelValue"]),l(m,{message:n(a).errors.opening_time},null,8,["message"])]),r("div",null,[l(d,{for:"closing_time"},{default:s(()=>e[22]||(e[22]=[i("Closing Time")])),_:1,__:[22]}),l(g,{id:"closing_time",modelValue:n(a).closing_time,"onUpdate:modelValue":e[8]||(e[8]=t=>n(a).closing_time=t),type:"time"},null,8,["modelValue"]),l(m,{message:n(a).errors.closing_time},null,8,["message"])])]),r("div",Y,[r("div",null,[l(d,{for:"manager_name"},{default:s(()=>e[23]||(e[23]=[i("Manager Name")])),_:1,__:[23]}),l(g,{id:"manager_name",modelValue:n(a).manager_name,"onUpdate:modelValue":e[9]||(e[9]=t=>n(a).manager_name=t)},null,8,["modelValue"]),l(m,{message:n(a).errors.manager_name},null,8,["message"])]),r("div",null,[l(d,{for:"manager_phone"},{default:s(()=>e[24]||(e[24]=[i("Manager Phone")])),_:1,__:[24]}),l(g,{id:"manager_phone",modelValue:n(a).manager_phone,"onUpdate:modelValue":e[10]||(e[10]=t=>n(a).manager_phone=t),placeholder:"09XXXXXXXXX or +639XXXXXXXXX",inputmode:"tel",pattern:"^(?:\\+?63|0)9\\d{9}$",maxlength:"13",onInput:q},null,8,["modelValue"]),e[25]||(e[25]=r("p",{class:"text-xs text-muted-foreground mt-1"},"Philippine mobile number format only.",-1)),l(m,{message:n(a).errors.manager_phone},null,8,["message"])]),r("div",null,[l(d,{for:"manager_email"},{default:s(()=>e[26]||(e[26]=[i("Manager Email")])),_:1,__:[26]}),l(g,{id:"manager_email",modelValue:n(a).manager_email,"onUpdate:modelValue":e[11]||(e[11]=t=>n(a).manager_email=t),type:"email"},null,8,["modelValue"]),l(m,{message:n(a).errors.manager_email},null,8,["message"])])]),r("div",null,[l(d,{for:"location"},{default:s(()=>e[27]||(e[27]=[i("Location")])),_:1,__:[27]}),l(G,{modelValue:n(a).location,"onUpdate:modelValue":e[12]||(e[12]=t=>n(a).location=t)},null,8,["modelValue"]),l(m,{message:n(a).errors.location},null,8,["message"])]),r("div",null,[l(d,{for:"branch_image"},{default:s(()=>e[28]||(e[28]=[i("Branch Image")])),_:1,__:[28]}),l(g,{id:"branch_image",type:"file",accept:"image/*",onChange:M}),l(m,{message:n(a).errors.branch_image},null,8,["message"]),f.branchImageUrl?(P(),w("div",Z,[r("img",{src:f.branchImageUrl,alt:"Branch Image",class:"w-24 h-24 object-cover rounded"},null,8,ee)])):T("",!0)]),r("div",ae,[l(n(z),{type:"submit",variant:"default"},{default:s(()=>[i(A(n(a).branchId?"Update Branch":"Create Branch"),1)]),_:1}),W(u.$slots,"footer")])],32))}});export{de as _};
