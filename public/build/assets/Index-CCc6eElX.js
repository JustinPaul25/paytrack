import{d as z,v as L,m as V,c as f,o as i,w as d,a as p,b as t,e as r,f as a,u as l,g as T,t as n,W as y,h as u,F as A,r as S,S as b,n as j}from"./app-CFepRPwu.js";import{_ as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-DNgqyd1_.js";import{_ as M,a as F}from"./CardContent.vue_vue_type_script_setup_true_lang-C9g0iyFA.js";import{_ as H,a as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-DERnjdva.js";import{_ as x}from"./index-DV2OFQX6.js";import{S as $}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_85568d9b_lang-BVtomLDo.js";import"./useForwardPropsEmits-dJhCFBuM.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Bf_YxJw4.js";import"./Teleport-Cw4jQHPm.js";import"./RovingFocusGroup-ULlmQ5Ks.js";import"./VisuallyHidden-CWyJyYAC.js";import"./DialogPortal-DiCFzSGZ.js";import"./x-Ca8660xC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-LUv5QWXH.js";import"./chevron-down-R92geRre.js";import"./circle-check-BFRkzvLo.js";import"./chevron-right-y-5Kn7YG.js";const U={class:"flex items-center justify-between my-6"},Q={class:"text-2xl font-bold"},W={class:"flex gap-2"},Y=["value"],G={key:0,class:"py-8 text-center text-sm text-gray-500"},J={key:0},O={class:"mt-3"},X={key:1},Z={key:1},ee={class:"min-w-full divide-y divide-border"},te={key:0,class:"px-4 py-2 text-left"},se={class:"px-4 py-2"},ie={class:"font-medium"},oe={key:0,class:"text-xs text-gray-500 truncate max-w-64"},re={class:"px-4 py-2"},ne={key:1,class:"text-sm"},ae={key:0,class:"px-4 py-2"},le={class:"text-sm"},de={key:0,class:"text-xs text-gray-500"},ue={class:"px-4 py-2"},ve={class:"px-4 py-2"},pe={class:"px-4 py-2 text-sm text-gray-500"},me={class:"px-4 py-2"},ce={class:"flex gap-2"},fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},xe={class:"relative bg-background rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6"},_e={class:"flex items-center justify-between mb-6 border-b pb-4"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-4"},be={class:"font-semibold text-lg"},ke={key:0},we={key:1,class:"font-medium"},he={key:0,class:"mt-1 text-sm text-gray-600"},Ce={key:0},Re={key:1},qe={class:"font-medium"},Ae={class:"space-y-1"},Se={class:"font-medium"},je={key:0,class:"text-sm text-gray-600"},$e={key:1,class:"text-sm text-gray-600"},Pe={class:"text-sm"},Ne={key:0,class:"text-xs text-gray-500 mt-1"},Be={class:"space-y-4"},De={key:0},Ie={class:"font-medium"},ze={key:0,class:"mt-1 text-sm text-gray-600 space-y-1"},Le={key:0},Ve={class:"font-medium text-lg"},Te={key:1},Ee={class:"font-medium text-lg text-green-600"},Me={key:2},Fe={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},He={key:3},Ke={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},Ue={key:4},Qe={class:"whitespace-pre-wrap text-sm bg-blue-50 p-3 rounded-md border border-blue-200"},We={key:5},Ye={class:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2"},Ge=["href"],Je=["src","alt"],Oe={key:6},Xe=["href"],Ze={key:7},et={class:"whitespace-pre-wrap text-sm bg-yellow-50 p-3 rounded-md border border-yellow-200"},tt={key:8},st={class:"text-sm font-medium text-green-600"},it={class:"mt-6 pt-4 border-t flex justify-end gap-2"},ht=z({__name:"Index",setup(ot){var h,C,R;function k(v){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(v)}const m=L(),_=m.props.filters||{},g=Array.isArray((h=m.props.auth)==null?void 0:h.userRoles)&&m.props.auth.userRoles.includes("Customer"),P=Array.isArray((C=m.props.auth)==null?void 0:C.userRoles)&&m.props.auth.userRoles.includes("Admin"),N=Array.isArray((R=m.props.auth)==null?void 0:R.userRoles)&&m.props.auth.userRoles.includes("Staff"),w=P||N,s=V(null);function B(v){$.fire({title:"Approve this refund request?",icon:"question",showCancelButton:!0,confirmButtonText:"Approve",confirmButtonColor:"#10b981",input:"textarea",inputLabel:"Approval notes (optional)",inputPlaceholder:"Notes for this approval...",inputAttributes:{"aria-label":"Approval notes (optional)"}}).then(e=>{e.isConfirmed&&y.post(route("refundRequests.approve",v),{review_notes:e.value||void 0},{preserveScroll:!0})})}function D(v){$.fire({title:"Decline this refund request?",text:"This will mark the request as rejected. You canâ€™t undo this.",icon:"warning",showCancelButton:!0,confirmButtonText:"Decline",confirmButtonColor:"#ef4444",input:"textarea",inputLabel:"Reason (required)",inputPlaceholder:"Provide a reason for declining...",inputAttributes:{"aria-label":"Reason (required)"},inputValidator:e=>{if(!e||!e.trim())return"Please provide a brief reason."}}).then(e=>{e.isConfirmed&&y.post(route("refundRequests.reject",v),{review_notes:e.value},{preserveScroll:!0})})}return(v,e)=>(i(),f(E,null,{default:d(()=>{var q;return[p(l(T),{title:"Refund Requests"}),t("div",U,[t("h1",Q,n(l(g)?"My Refund Requests":"Refund Requests"),1),t("div",W,[t("select",{class:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:l(_).status||"all",onChange:e[0]||(e[0]=o=>{const c=o.target.value==="all"?"":o.target.value;l(y).get(v.route("refundRequests.index"),c?{status:c}:{},{preserveState:!0,replace:!0})})},e[6]||(e[6]=[t("option",{value:"all"},"All",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"approved"},"Approved",-1),t("option",{value:"rejected"},"Rejected",-1),t("option",{value:"converted"},"Converted",-1)]),40,Y)])]),p(M,null,{default:d(()=>[p(H,null,{default:d(()=>[p(K,null,{default:d(()=>e[7]||(e[7]=[u("Requests")])),_:1,__:[7]})]),_:1}),p(F,null,{default:d(()=>[l(m).props.refundRequests.data.length?(i(),r("div",Z,[t("table",ee,[t("thead",null,[t("tr",null,[e[10]||(e[10]=t("th",{class:"px-4 py-2 text-left"},"Tracking",-1)),e[11]||(e[11]=t("th",{class:"px-4 py-2 text-left"},"Type",-1)),e[12]||(e[12]=t("th",{class:"px-4 py-2 text-left"},"Invoice",-1)),l(g)?a("",!0):(i(),r("th",te,"Customer")),e[13]||(e[13]=t("th",{class:"px-4 py-2 text-left"},"Qty",-1)),e[14]||(e[14]=t("th",{class:"px-4 py-2 text-left"},"Status",-1)),e[15]||(e[15]=t("th",{class:"px-4 py-2 text-left"},"Submitted",-1)),e[16]||(e[16]=t("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),t("tbody",null,[(i(!0),r(A,null,S(l(m).props.refundRequests.data,o=>(i(),r("tr",{key:o.id,class:"hover:bg-muted"},[t("td",se,[t("div",ie,n(o.tracking_number),1),o.reason?(i(),r("div",oe,n(o.reason),1)):a("",!0)]),e[21]||(e[21]=t("td",{class:"px-4 py-2"},[t("span",{class:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," Refund ")],-1)),t("td",re,[o.invoice_id?(i(),f(l(b),{key:0,href:v.route("invoices.show",o.invoice_id),class:"text-sm text-blue-600 hover:underline"},{default:d(()=>[u(n(o.invoice_reference||"#"+o.invoice_id),1)]),_:2},1032,["href"])):(i(),r("div",ne,n(o.invoice_reference||"#"+o.invoice_id),1))]),l(g)?a("",!0):(i(),r("td",ae,[t("div",le,n(o.customer_name),1),o.email?(i(),r("div",de,n(o.email),1)):a("",!0)])),t("td",ue,n(o.quantity),1),t("td",ve,[t("span",{class:j(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":o.status==="pending","bg-green-100 text-green-800":o.status==="approved"||o.status==="converted","bg-red-100 text-red-800":o.status==="rejected"}])},n(o.status),3)]),t("td",pe,n(new Date(o.created_at).toLocaleString()),1),t("td",me,[t("div",ce,[l(w)&&o.status==="pending"?(i(),f(l(x),{key:0,size:"sm",variant:"default",onClick:c=>B(o.id)},{default:d(()=>e[17]||(e[17]=[u(" Approve ")])),_:2,__:[17]},1032,["onClick"])):a("",!0),l(w)&&o.status==="pending"?(i(),f(l(x),{key:1,size:"sm",variant:"destructive",onClick:c=>D(o.id)},{default:d(()=>e[18]||(e[18]=[u(" Decline ")])),_:2,__:[18]},1032,["onClick"])):a("",!0),p(l(x),{size:"sm",variant:"outline",onClick:c=>s.value=o},{default:d(()=>e[19]||(e[19]=[u("View details")])),_:2,__:[19]},1032,["onClick"]),o.invoice_id&&!l(g)?(i(),f(l(b),{key:2,href:v.route("invoices.show",o.invoice_id)},{default:d(()=>[p(l(x),{size:"sm",variant:"ghost"},{default:d(()=>e[20]||(e[20]=[u("View Invoice")])),_:1,__:[20]})]),_:2},1032,["href"])):a("",!0)])])]))),128))])])])):(i(),r("div",G,[l(_).status&&l(_).status!==""&&l(_).status!=="all"?(i(),r("div",J,[e[9]||(e[9]=u(" No refund requests for the selected filter. ")),t("div",O,[p(l(x),{variant:"outline",onClick:e[1]||(e[1]=o=>l(y).get(v.route("refundRequests.index"),{},{preserveState:!0,replace:!0}))},{default:d(()=>e[8]||(e[8]=[u(" Clear filters ")])),_:1,__:[8]})])])):(i(),r("div",X," No refund requests. "))]))]),_:1})]),_:1}),s.value?(i(),r("div",fe,[t("div",{class:"absolute inset-0 bg-black/50",onClick:e[2]||(e[2]=o=>s.value=null)}),t("div",xe,[t("div",_e,[e[22]||(e[22]=t("h3",{class:"text-xl font-semibold"},"Refund Request Details",-1)),t("button",{class:"text-sm text-gray-500 hover:text-gray-700",onClick:e[3]||(e[3]=o=>s.value=null)},"Close")]),t("div",ge,[t("div",ye,[t("div",null,[e[23]||(e[23]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Tracking Number",-1)),t("div",be,n(s.value.tracking_number),1)]),t("div",null,[e[24]||(e[24]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Status",-1)),t("span",{class:j(["px-3 py-1 rounded-full text-sm font-medium inline-block",{"bg-yellow-100 text-yellow-800":s.value.status==="pending","bg-green-100 text-green-800":s.value.status==="approved"||s.value.status==="converted","bg-red-100 text-red-800":s.value.status==="rejected"}])},n(s.value.status),3)]),s.value.invoice?(i(),r("div",ke,[e[25]||(e[25]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice",-1)),t("div",null,[s.value.invoice_id?(i(),f(l(b),{key:0,href:v.route("invoices.show",s.value.invoice_id),class:"text-blue-600 hover:underline font-medium"},{default:d(()=>[u(n(s.value.invoice.reference_number||s.value.invoice_reference||`#${s.value.invoice_id}`),1)]),_:1},8,["href"])):(i(),r("span",we,n(s.value.invoice_reference||"N/A"),1))]),s.value.invoice?(i(),r("div",he,[t("div",null,"Amount: "+n(k(s.value.invoice.total_amount)),1),t("div",null,"Status: "+n(s.value.invoice.status),1),s.value.invoice.payment_status?(i(),r("div",Ce,"Payment: "+n(s.value.invoice.payment_status),1)):a("",!0)])):a("",!0)])):s.value.invoice_reference?(i(),r("div",Re,[e[26]||(e[26]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice Reference",-1)),t("div",qe,n(s.value.invoice_reference),1)])):a("",!0),t("div",null,[e[27]||(e[27]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Customer Information",-1)),t("div",Ae,[t("div",Se,n(s.value.customer_name),1),s.value.email?(i(),r("div",je,n(s.value.email),1)):a("",!0),s.value.phone?(i(),r("div",$e,n(s.value.phone),1)):a("",!0)])]),t("div",null,[e[28]||(e[28]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Submitted",-1)),t("div",Pe,n(new Date(s.value.created_at).toLocaleString()),1),s.value.updated_at&&s.value.updated_at!==s.value.created_at?(i(),r("div",Ne," Last updated: "+n(new Date(s.value.updated_at).toLocaleString()),1)):a("",!0)])]),t("div",Be,[s.value.product||s.value.product_name?(i(),r("div",De,[e[29]||(e[29]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Product",-1)),t("div",null,[t("div",Ie,n(((q=s.value.product)==null?void 0:q.name)||s.value.product_name||"N/A"),1),s.value.product?(i(),r("div",ze,[s.value.product.SKU?(i(),r("div",Le,"SKU: "+n(s.value.product.SKU),1)):a("",!0),t("div",null,"Price: "+n(k(s.value.product.selling_price)),1)])):a("",!0)])])):a("",!0),t("div",null,[e[30]||(e[30]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Quantity",-1)),t("div",Ve,n(s.value.quantity),1)]),s.value.amount_requested?(i(),r("div",Te,[e[31]||(e[31]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Amount Requested",-1)),t("div",Ee,n(k(s.value.amount_requested)),1)])):a("",!0),s.value.reason?(i(),r("div",Me,[e[32]||(e[32]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Reason",-1)),t("div",Fe,n(s.value.reason),1)])):a("",!0),s.value.notes?(i(),r("div",He,[e[33]||(e[33]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Additional Notes",-1)),t("div",Ke,n(s.value.notes),1)])):a("",!0),s.value.review_notes?(i(),r("div",Ue,[e[34]||(e[34]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Review Notes",-1)),t("div",Qe,n(s.value.review_notes),1)])):a("",!0),s.value.proof_images&&s.value.proof_images.length>0?(i(),r("div",We,[e[36]||(e[36]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Proof Images",-1)),t("div",Ye,[(i(!0),r(A,null,S(s.value.proof_images,(o,c)=>(i(),r("a",{key:o.id||c,href:o.url,target:"_blank",rel:"noopener noreferrer",class:"relative group block overflow-hidden rounded-md border border-gray-300 hover:border-blue-500 transition-all"},[t("img",{src:o.url,alt:`Proof image ${c+1}`,class:"w-full h-32 object-cover transition-transform group-hover:scale-105 bg-gray-100",onError:e[4]||(e[4]=I=>{I.target.src="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect fill=%22%23f3f4f6%22 width=%22100%22 height=%22100%22/%3E%3Ctext fill=%22%239ca3af%22 font-family=%22sans-serif%22 font-size=%2214%22 x=%2250%%22 y=%2250%%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3EImage%3C/text%3E%3C/svg%3E"}),loading:"lazy"},null,40,Je),e[35]||(e[35]=t("div",{class:"absolute inset-0 flex items-center justify-center"},[t("div",{class:"bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm font-medium opacity-0 group-hover:opacity-100 transform translate-y-2 group-hover:translate-y-0 transition-all flex items-center gap-1.5 shadow-lg"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]),u(" View ")])],-1))],8,Ge))),128))])])):a("",!0),s.value.media_link?(i(),r("div",Oe,[e[38]||(e[38]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Media Link (Legacy)",-1)),t("a",{href:s.value.media_link,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:underline break-all text-sm flex items-center gap-2"},e[37]||(e[37]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1),u(" View Media ")]),8,Xe)])):a("",!0),s.value.damaged_items_terms?(i(),r("div",Ze,[e[39]||(e[39]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Damaged Items Terms",-1)),t("div",et,n(s.value.damaged_items_terms),1)])):a("",!0),s.value.converted_refund_id?(i(),r("div",tt,[e[40]||(e[40]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Converted to Refund",-1)),t("div",st,"Refund ID: #"+n(s.value.converted_refund_id),1)])):a("",!0)])]),t("div",it,[p(l(x),{variant:"outline",onClick:e[5]||(e[5]=o=>s.value=null)},{default:d(()=>e[41]||(e[41]=[u("Close")])),_:1,__:[41]}),s.value.invoice_id?(i(),f(l(b),{key:0,href:v.route("invoices.show",s.value.invoice_id)},{default:d(()=>[p(l(x),{variant:"default"},{default:d(()=>e[42]||(e[42]=[u("View Invoice")])),_:1,__:[42]})]),_:1},8,["href"])):a("",!0)])])])):a("",!0)]}),_:1}))}});export{ht as default};
