import{d as I,v as L,m as V,c as x,o as i,w as l,a as p,b as e,e as r,f as a,u as d,g as T,t as n,W as k,h as v,F as A,r as P,n as h,S as b}from"./app-D813Jm8L.js";import{_ as z}from"./AppLayout.vue_vue_type_script_setup_true_lang-BXVphV0c.js";import{_ as M,a as K}from"./CardContent.vue_vue_type_script_setup_true_lang-Bd0-TUSa.js";import{_ as U,a as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-CWkeiFc_.js";import{_}from"./index-CviG3rkw.js";import{S as j}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fdfc5f8_lang-CV5BHZq7.js";import"./useForwardPropsEmits-HaL_en7z.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CNZgJ1qe.js";import"./createLucideIcon-DbTVWaVY.js";import"./Teleport-DZRgFwKg.js";import"./RovingFocusGroup-CmZI1JuB.js";import"./VisuallyHidden-CSeGT6UP.js";import"./x-Bm3VYXWf.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-JzmBcxvg.js";import"./chevron-right-By_NXETe.js";const H={class:"flex items-center justify-between my-6"},E={class:"text-2xl font-bold"},Q={class:"flex gap-2"},W=["value"],Y={key:0,class:"py-8 text-center text-sm text-gray-500"},G={key:0},J={class:"mt-3"},O={key:1},X={key:1},Z={class:"min-w-full divide-y divide-border"},ee={key:0,class:"px-4 py-2 text-left"},te={class:"px-4 py-2"},se={class:"font-medium"},ie={key:0,class:"text-xs text-gray-500 truncate max-w-64"},oe={class:"px-4 py-2"},ne={class:"px-4 py-2"},re={key:1,class:"text-sm"},ae={key:0,class:"px-4 py-2"},de={class:"text-sm"},le={key:0,class:"text-xs text-gray-500"},ue={class:"px-4 py-2"},ve={class:"px-4 py-2"},pe={class:"px-4 py-2 text-sm text-gray-500"},ce={class:"px-4 py-2"},me={class:"flex gap-2"},xe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},_e={class:"relative bg-background rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6"},fe={class:"flex items-center justify-between mb-6 border-b pb-4"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-4"},ke={class:"font-semibold text-lg"},be={key:0},he={key:1,class:"font-medium"},we={key:0,class:"mt-1 text-sm text-gray-600"},Ce={key:0},Re={key:1},qe={class:"font-medium"},Se={class:"space-y-1"},Ae={class:"font-medium"},Pe={key:0,class:"text-sm text-gray-600"},je={key:1,class:"text-sm text-gray-600"},$e={class:"text-sm"},Ne={key:0,class:"text-xs text-gray-500 mt-1"},Be={class:"space-y-4"},De={key:0},Ie={class:"font-medium"},Le={key:0,class:"mt-1 text-sm text-gray-600 space-y-1"},Ve={key:0},Te={class:"font-medium text-lg"},ze={key:1},Me={class:"font-medium text-lg text-green-600"},Ke={key:2},Ue={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},Fe={key:3},He={class:"whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-md border"},Ee={key:4},Qe={class:"whitespace-pre-wrap text-sm bg-blue-50 p-3 rounded-md border border-blue-200"},We={key:5},Ye={class:"font-medium"},Ge={key:0,class:"text-sm text-gray-600"},Je={class:"text-sm text-gray-600"},Oe={key:1,class:"text-sm text-gray-600"},Xe={key:6},Ze={class:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2"},et=["href"],tt=["src","alt"],st={key:7},it=["href"],ot={key:8},nt={class:"whitespace-pre-wrap text-sm bg-yellow-50 p-3 rounded-md border border-yellow-200"},rt={key:9},at={class:"text-sm font-medium text-green-600"},dt={class:"mt-6 pt-4 border-t flex justify-end gap-2"},qt=I({__name:"Index",setup(lt){var C,R,q;function f(u){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(u)}const c=L(),g=c.props.filters||{},y=Array.isArray((C=c.props.auth)==null?void 0:C.userRoles)&&c.props.auth.userRoles.includes("Customer"),$=Array.isArray((R=c.props.auth)==null?void 0:R.userRoles)&&c.props.auth.userRoles.includes("Admin"),N=Array.isArray((q=c.props.auth)==null?void 0:q.userRoles)&&c.props.auth.userRoles.includes("Staff"),w=$||N,s=V(null);function B(u){j.fire({title:"Approve this refund request?",icon:"question",showCancelButton:!0,confirmButtonText:"Approve",confirmButtonColor:"#10b981",input:"textarea",inputLabel:"Approval notes (optional)",inputPlaceholder:"Notes for this approval...",inputAttributes:{"aria-label":"Approval notes (optional)"}}).then(t=>{t.isConfirmed&&k.post(route("refundRequests.approve",u),{review_notes:t.value||void 0},{preserveScroll:!0})})}function D(u){j.fire({title:"Decline this refund request?",text:"This will mark the request as rejected. You canâ€™t undo this.",icon:"warning",showCancelButton:!0,confirmButtonText:"Decline",confirmButtonColor:"#ef4444",input:"textarea",inputLabel:"Reason (required)",inputPlaceholder:"Provide a reason for declining...",inputAttributes:{"aria-label":"Reason (required)"},inputValidator:t=>{if(!t||!t.trim())return"Please provide a brief reason."}}).then(t=>{t.isConfirmed&&k.post(route("refundRequests.reject",u),{review_notes:t.value},{preserveScroll:!0})})}return(u,t)=>(i(),x(z,null,{default:l(()=>{var S;return[p(d(T),{title:"Refund Requests"}),e("div",H,[e("h1",E,n(d(y)?"My Refund Requests":"Refund Requests"),1),e("div",Q,[e("select",{class:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:d(g).status||"all",onChange:t[0]||(t[0]=o=>{const m=o.target.value==="all"?"":o.target.value;d(k).get(u.route("refundRequests.index"),m?{status:m}:{},{preserveState:!0,replace:!0})})},t[5]||(t[5]=[e("option",{value:"all"},"All",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1),e("option",{value:"converted"},"Converted",-1)]),40,W)])]),p(M,null,{default:l(()=>[p(U,null,{default:l(()=>[p(F,null,{default:l(()=>t[6]||(t[6]=[v("Requests")])),_:1,__:[6]})]),_:1}),p(K,null,{default:l(()=>[d(c).props.refundRequests.data.length?(i(),r("div",X,[e("table",Z,[e("thead",null,[e("tr",null,[t[9]||(t[9]=e("th",{class:"px-4 py-2 text-left"},"Tracking",-1)),t[10]||(t[10]=e("th",{class:"px-4 py-2 text-left"},"Type",-1)),t[11]||(t[11]=e("th",{class:"px-4 py-2 text-left"},"Invoice",-1)),d(y)?a("",!0):(i(),r("th",ee,"Customer")),t[12]||(t[12]=e("th",{class:"px-4 py-2 text-left"},"Qty",-1)),t[13]||(t[13]=e("th",{class:"px-4 py-2 text-left"},"Status",-1)),t[14]||(t[14]=e("th",{class:"px-4 py-2 text-left"},"Submitted",-1)),t[15]||(t[15]=e("th",{class:"px-4 py-2 text-left"},"Actions",-1))])]),e("tbody",null,[(i(!0),r(A,null,P(d(c).props.refundRequests.data,o=>(i(),r("tr",{key:o.id,class:"hover:bg-muted"},[e("td",te,[e("div",se,n(o.tracking_number),1),o.reason?(i(),r("div",ie,n(o.reason),1)):a("",!0)]),e("td",oe,[e("span",{class:h(["px-2 py-1 rounded-full text-xs font-medium",{"bg-blue-100 text-blue-800":o.request_type==="refund"||!o.request_type,"bg-purple-100 text-purple-800":o.request_type==="exchange"}])},n(o.request_type==="exchange"?"Exchange":"Refund"),3)]),e("td",ne,[o.invoice_id?(i(),x(d(b),{key:0,href:u.route("invoices.show",o.invoice_id),class:"text-sm text-blue-600 hover:underline"},{default:l(()=>[v(n(o.invoice_reference||"#"+o.invoice_id),1)]),_:2},1032,["href"])):(i(),r("div",re,n(o.invoice_reference||"#"+o.invoice_id),1))]),d(y)?a("",!0):(i(),r("td",ae,[e("div",de,n(o.customer_name),1),o.email?(i(),r("div",le,n(o.email),1)):a("",!0)])),e("td",ue,n(o.quantity),1),e("td",ve,[e("span",{class:h(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":o.status==="pending","bg-green-100 text-green-800":o.status==="approved"||o.status==="converted","bg-red-100 text-red-800":o.status==="rejected"}])},n(o.status),3)]),e("td",pe,n(new Date(o.created_at).toLocaleString()),1),e("td",ce,[e("div",me,[d(w)&&o.status==="pending"?(i(),x(d(_),{key:0,size:"sm",variant:"default",onClick:m=>B(o.id)},{default:l(()=>t[16]||(t[16]=[v(" Approve ")])),_:2,__:[16]},1032,["onClick"])):a("",!0),d(w)&&o.status==="pending"?(i(),x(d(_),{key:1,size:"sm",variant:"destructive",onClick:m=>D(o.id)},{default:l(()=>t[17]||(t[17]=[v(" Decline ")])),_:2,__:[17]},1032,["onClick"])):a("",!0),p(d(_),{size:"sm",variant:"outline",onClick:m=>s.value=o},{default:l(()=>t[18]||(t[18]=[v("View details")])),_:2,__:[18]},1032,["onClick"]),o.invoice_id&&!d(y)?(i(),x(d(b),{key:2,href:u.route("invoices.show",o.invoice_id)},{default:l(()=>[p(d(_),{size:"sm",variant:"ghost"},{default:l(()=>t[19]||(t[19]=[v("View Invoice")])),_:1,__:[19]})]),_:2},1032,["href"])):a("",!0)])])]))),128))])])])):(i(),r("div",Y,[d(g).status&&d(g).status!==""&&d(g).status!=="all"?(i(),r("div",G,[t[8]||(t[8]=v(" No refund requests for the selected filter. ")),e("div",J,[p(d(_),{variant:"outline",onClick:t[1]||(t[1]=o=>d(k).get(u.route("refundRequests.index"),{},{preserveState:!0,replace:!0}))},{default:l(()=>t[7]||(t[7]=[v(" Clear filters ")])),_:1,__:[7]})])])):(i(),r("div",O," No refund requests. "))]))]),_:1})]),_:1}),s.value?(i(),r("div",xe,[e("div",{class:"absolute inset-0 bg-black/50",onClick:t[2]||(t[2]=o=>s.value=null)}),e("div",_e,[e("div",fe,[t[20]||(t[20]=e("h3",{class:"text-xl font-semibold"},"Refund Request Details",-1)),e("button",{class:"text-sm text-gray-500 hover:text-gray-700",onClick:t[3]||(t[3]=o=>s.value=null)},"Close")]),e("div",ge,[e("div",ye,[e("div",null,[t[21]||(t[21]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Tracking Number",-1)),e("div",ke,n(s.value.tracking_number),1)]),e("div",null,[t[22]||(t[22]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Status",-1)),e("span",{class:h(["px-3 py-1 rounded-full text-sm font-medium inline-block",{"bg-yellow-100 text-yellow-800":s.value.status==="pending","bg-green-100 text-green-800":s.value.status==="approved"||s.value.status==="converted","bg-red-100 text-red-800":s.value.status==="rejected"}])},n(s.value.status),3)]),s.value.invoice?(i(),r("div",be,[t[23]||(t[23]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice",-1)),e("div",null,[s.value.invoice_id?(i(),x(d(b),{key:0,href:u.route("invoices.show",s.value.invoice_id),class:"text-blue-600 hover:underline font-medium"},{default:l(()=>[v(n(s.value.invoice.reference_number||s.value.invoice_reference||`#${s.value.invoice_id}`),1)]),_:1},8,["href"])):(i(),r("span",he,n(s.value.invoice_reference||"N/A"),1))]),s.value.invoice?(i(),r("div",we,[e("div",null,"Amount: "+n(f(s.value.invoice.total_amount)),1),e("div",null,"Status: "+n(s.value.invoice.status),1),s.value.invoice.payment_status?(i(),r("div",Ce,"Payment: "+n(s.value.invoice.payment_status),1)):a("",!0)])):a("",!0)])):s.value.invoice_reference?(i(),r("div",Re,[t[24]||(t[24]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Invoice Reference",-1)),e("div",qe,n(s.value.invoice_reference),1)])):a("",!0),e("div",null,[t[25]||(t[25]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Customer Information",-1)),e("div",Se,[e("div",Ae,n(s.value.customer_name),1),s.value.email?(i(),r("div",Pe,n(s.value.email),1)):a("",!0),s.value.phone?(i(),r("div",je,n(s.value.phone),1)):a("",!0)])]),e("div",null,[t[26]||(t[26]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Submitted",-1)),e("div",$e,n(new Date(s.value.created_at).toLocaleString()),1),s.value.updated_at&&s.value.updated_at!==s.value.created_at?(i(),r("div",Ne," Last updated: "+n(new Date(s.value.updated_at).toLocaleString()),1)):a("",!0)])]),e("div",Be,[s.value.product||s.value.product_name?(i(),r("div",De,[t[27]||(t[27]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Product",-1)),e("div",null,[e("div",Ie,n(((S=s.value.product)==null?void 0:S.name)||s.value.product_name||"N/A"),1),s.value.product?(i(),r("div",Le,[s.value.product.SKU?(i(),r("div",Ve,"SKU: "+n(s.value.product.SKU),1)):a("",!0),e("div",null,"Price: "+n(f(s.value.product.selling_price)),1)])):a("",!0)])])):a("",!0),e("div",null,[t[28]||(t[28]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Quantity",-1)),e("div",Te,n(s.value.quantity),1)]),s.value.amount_requested?(i(),r("div",ze,[t[29]||(t[29]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Amount Requested",-1)),e("div",Me,n(f(s.value.amount_requested)),1)])):a("",!0),s.value.reason?(i(),r("div",Ke,[t[30]||(t[30]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Reason",-1)),e("div",Ue,n(s.value.reason),1)])):a("",!0),s.value.notes?(i(),r("div",Fe,[t[31]||(t[31]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Additional Notes",-1)),e("div",He,n(s.value.notes),1)])):a("",!0),s.value.review_notes?(i(),r("div",Ee,[t[32]||(t[32]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Review Notes",-1)),e("div",Qe,n(s.value.review_notes),1)])):a("",!0),s.value.request_type==="exchange"&&s.value.exchange_product?(i(),r("div",We,[t[33]||(t[33]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Exchange Product",-1)),e("div",null,[e("div",Ye,n(s.value.exchange_product.name),1),s.value.exchange_product.SKU?(i(),r("div",Ge,"SKU: "+n(s.value.exchange_product.SKU),1)):a("",!0),e("div",Je,"Price: "+n(f(s.value.exchange_product.selling_price)),1),s.value.exchange_quantity?(i(),r("div",Oe,"Quantity: "+n(s.value.exchange_quantity),1)):a("",!0)])])):a("",!0),s.value.media&&s.value.media.length>0?(i(),r("div",Xe,[t[35]||(t[35]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Proof Images",-1)),e("div",Ze,[(i(!0),r(A,null,P(s.value.media,(o,m)=>(i(),r("a",{key:o.id,href:o.url,target:"_blank",rel:"noopener noreferrer",class:"relative group"},[e("img",{src:o.url,alt:`Proof image ${m+1}`,class:"w-full h-32 object-cover rounded-md border hover:opacity-75 transition-opacity"},null,8,tt),t[34]||(t[34]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity rounded-md flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-white opacity-0 group-hover:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})])],-1))],8,et))),128))])])):a("",!0),s.value.media_link?(i(),r("div",st,[t[37]||(t[37]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Media Link (Legacy)",-1)),e("a",{href:s.value.media_link,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:underline break-all text-sm flex items-center gap-2"},t[36]||(t[36]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1),v(" View Media ")]),8,it)])):a("",!0),s.value.damaged_items_terms?(i(),r("div",ot,[t[38]||(t[38]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Damaged Items Terms",-1)),e("div",nt,n(s.value.damaged_items_terms),1)])):a("",!0),s.value.converted_refund_id?(i(),r("div",rt,[t[39]||(t[39]=e("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1"},"Converted to Refund",-1)),e("div",at,"Refund ID: #"+n(s.value.converted_refund_id),1)])):a("",!0)])]),e("div",dt,[p(d(_),{variant:"outline",onClick:t[4]||(t[4]=o=>s.value=null)},{default:l(()=>t[40]||(t[40]=[v("Close")])),_:1,__:[40]}),s.value.invoice_id?(i(),x(d(b),{key:0,href:u.route("invoices.show",s.value.invoice_id)},{default:l(()=>[p(d(_),{variant:"default"},{default:l(()=>t[41]||(t[41]=[v("View Invoice")])),_:1,__:[41]})]),_:1},8,["href"])):a("",!0)])])])):a("",!0)]}),_:1}))}});export{qt as default};
