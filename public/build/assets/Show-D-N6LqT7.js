import{d as se,D as oe,p as P,s as Y,c as b,o as u,u as d,w as i,a as o,b as e,e as m,t as r,f as p,h as f,x as F,y as I,E as le,v as ie,m as ee,g as re,F as T,S as K,l as A,r as L,W as de}from"./app-1A5YSak6.js";import{_ as h}from"./index-BWU88cBJ.js";import{p as ae,q as ue,r as me,_ as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-BCVanqXE.js";import{_ as S,a as $}from"./CardContent.vue_vue_type_script_setup_true_lang-DYhZIIS0.js";import{_ as M,a as B}from"./CardTitle.vue_vue_type_script_setup_true_lang-C4ol0moP.js";import{_ as te}from"./Select.vue_vue_type_script_setup_true_lang-CbSJUwQ_.js";import{_ as pe}from"./SearchSelect.vue_vue_type_script_setup_true_lang-BHPPqgLd.js";import{e as fe,a as _e,b as ve,c as ge,d as ye,_ as xe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D0UdXA4r.js";import{_ as w}from"./Label.vue_vue_type_script_setup_true_lang-B3Uu3sDk.js";import{_ as be}from"./PhoneInput.vue_vue_type_script_setup_true_lang-C_gtMK97.js";import{S as E}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as C}from"./InputError.vue_vue_type_script_setup_true_lang-1GrtDaRh.js";import{D as ke}from"./DeliveryRouteMap-DcMo3Z-d.js";import"./LocationInput.vue_vue_type_style_index_0_scoped_0fe2f881_lang-BHJz_n_j.js";import"./useForwardPropsEmits-DLwOjtLV.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CY5h4SiE.js";import"./createLucideIcon-BqpLk_z0.js";import"./Teleport-BHg1vLCi.js";import"./RovingFocusGroup-hZDTo2Q6.js";import"./VisuallyHidden-B3oxVUhX.js";import"./x-CQ3Uca_e.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-D1Pjj9RT.js";import"./Input.vue_vue_type_script_setup_true_lang-BO3jUK9y.js";import"./search-DcUo4BKy.js";import"./vue-leaflet.es-Dc4IIcE8.js";import"./marker-icon-2x-1TirABJh.js";import"./marker-icon-B6h-nX3D.js";import"./marker-shadow-B9CpECYs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const we={class:"space-y-4"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pe=["min"],Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Re={key:0},Se=se({__name:"DeliveryFormModal",props:{open:{type:Boolean},invoice:{},customers:{}},emits:["update:open"],setup(W,{emit:n}){var X,z,y;const v=W,q=n,a=oe({customer_id:v.invoice.customer_id,invoice_id:v.invoice.id,delivery_address:((X=v.invoice.customer)==null?void 0:X.address)||"",contact_person:((z=v.invoice.customer)==null?void 0:z.name)||"",contact_phone:j((y=v.invoice.customer)==null?void 0:y.phone)||"",delivery_date:"",delivery_time:"",status:"pending",notes:"",delivery_fee:""}),Q=new Date().toISOString().split("T")[0];function j(_){if(!_)return"";let s=_.replace(/[^0-9]/g,"");return s.startsWith("63")?s=s.substring(2):s.startsWith("0")&&(s=s.substring(1)),s=s.substring(0,10),s.length===10?"+63"+s:_}const V=P(()=>[{value:null,label:"Select customer"},...v.customers.map(_=>({value:_.id,label:`${_.name}${_.company_name?` (${_.company_name})`:""}`}))]),k=[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],N=[{value:"09:00 AM - 12:00 PM",label:"09:00 AM - 12:00 PM"},{value:"12:00 PM - 03:00 PM",label:"12:00 PM - 03:00 PM"},{value:"03:00 PM - 06:00 PM",label:"03:00 PM - 06:00 PM"},{value:"06:00 PM - 09:00 PM",label:"06:00 PM - 09:00 PM"},{value:"Custom",label:"Custom"}],D=P(()=>{if(!a.customer_id)return null;const _=v.customers.find(x=>x.id===a.customer_id);if(!(_!=null&&_.location))return null;let s=_.location;if(typeof s=="string")try{s=JSON.parse(s)}catch{return console.warn("Failed to parse customer location string:",s),null}return s&&typeof s.lat=="number"&&typeof s.lng=="number"&&!isNaN(s.lat)&&!isNaN(s.lng)&&s.lat>=-90&&s.lat<=90&&s.lng>=-180&&s.lng<=180?s:null}),O=P(()=>a.customer_id&&v.customers.find(_=>_.id===a.customer_id)||null);Y(()=>a.customer_id,_=>{if(_){const s=v.customers.find(x=>x.id===_);s!=null&&s.address&&!a.delivery_address&&(a.delivery_address=s.address)}}),Y(()=>v.open,_=>{var s,x,R;_&&(a.reset(),a.customer_id=v.invoice.customer_id,a.invoice_id=v.invoice.id,a.delivery_address=((s=v.invoice.customer)==null?void 0:s.address)||"",a.contact_person=((x=v.invoice.customer)==null?void 0:x.name)||"",a.contact_phone=j((R=v.invoice.customer)==null?void 0:R.phone)||"",a.clearErrors())});function U(){a.contact_phone&&(a.contact_phone=j(a.contact_phone));const _=/^\+63\d{10}$/;if(a.contact_phone&&!_.test(a.contact_phone)){a.setError("contact_phone","Enter a valid 10-digit Philippine mobile number.");return}a.post(route("deliveries.store"),{preserveScroll:!0,onSuccess:()=>{E.fire({toast:!0,position:"top-end",icon:"success",title:"Delivery created successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),q("update:open",!1),a.reset()}})}function H(){q("update:open",!1),a.clearErrors()}return(_,s)=>(u(),b(d(fe),{open:_.open,"onUpdate:open":s[10]||(s[10]=x=>q("update:open",x))},{default:i(()=>[o(d(xe),{class:"max-w-4xl max-h-[90vh] overflow-y-auto"},{default:i(()=>{var x,R;return[o(d(_e),null,{default:i(()=>[o(d(ve),null,{default:i(()=>s[11]||(s[11]=[m("Out for Delivery")])),_:1,__:[11]}),o(d(ge),null,{default:i(()=>[m(" Create a delivery for invoice "+r(_.invoice.reference_number),1)]),_:1})]),_:1}),e("form",{onSubmit:s[9]||(s[9]=le(g=>U(),["prevent"])),class:"space-y-6"},[e("div",we,[e("div",he,[e("div",null,[o(w,{for:"customer_id"},{default:i(()=>s[12]||(s[12]=[m("Customer")])),_:1,__:[12]}),o(d(pe),{modelValue:d(a).customer_id,"onUpdate:modelValue":s[0]||(s[0]=g=>d(a).customer_id=g),options:V.value,placeholder:"Select customer","search-placeholder":"Search customers...",class:"mt-1",required:""},null,8,["modelValue","options"]),o(C,{message:d(a).errors.customer_id},null,8,["message"])]),e("div",null,[o(w,{for:"delivery_date"},{default:i(()=>s[13]||(s[13]=[m("Delivery Date")])),_:1,__:[13]}),F(e("input",{"onUpdate:modelValue":s[1]||(s[1]=g=>d(a).delivery_date=g),type:"date",id:"delivery_date",min:d(Q),class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",required:""},null,8,Pe),[[I,d(a).delivery_date]]),o(C,{message:d(a).errors.delivery_date},null,8,["message"])])]),e("div",null,[o(w,{for:"delivery_address"},{default:i(()=>s[14]||(s[14]=[m("Delivery Address")])),_:1,__:[14]}),F(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=g=>d(a).delivery_address=g),id:"delivery_address",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter complete delivery address",required:""},null,512),[[I,d(a).delivery_address]]),o(C,{message:d(a).errors.delivery_address},null,8,["message"])]),e("div",Ce,[e("div",null,[o(w,{for:"contact_person"},{default:i(()=>s[15]||(s[15]=[m("Contact Person")])),_:1,__:[15]}),F(e("input",{"onUpdate:modelValue":s[3]||(s[3]=g=>d(a).contact_person=g),type:"text",id:"contact_person",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"Enter contact person name",required:""},null,512),[[I,d(a).contact_person]]),o(C,{message:d(a).errors.contact_person},null,8,["message"])]),e("div",null,[o(w,{for:"contact_phone"},{default:i(()=>s[16]||(s[16]=[m("Contact Phone")])),_:1,__:[16]}),o(be,{modelValue:d(a).contact_phone,"onUpdate:modelValue":s[4]||(s[4]=g=>d(a).contact_phone=g),id:"contact_phone",placeholder:"XXXXXXXXXX",required:"",class:"mt-1"},null,8,["modelValue"]),o(C,{message:d(a).errors.contact_phone},null,8,["message"])])]),e("div",De,[e("div",null,[o(w,{for:"delivery_time"},{default:i(()=>s[17]||(s[17]=[m("Delivery Time")])),_:1,__:[17]}),o(d(te),{modelValue:d(a).delivery_time,"onUpdate:modelValue":s[5]||(s[5]=g=>d(a).delivery_time=g),options:N,placeholder:"Select delivery time",class:"mt-1",required:""},null,8,["modelValue"]),o(C,{message:d(a).errors.delivery_time},null,8,["message"])]),e("div",null,[o(w,{for:"status"},{default:i(()=>s[18]||(s[18]=[m("Status")])),_:1,__:[18]}),o(d(te),{modelValue:d(a).status,"onUpdate:modelValue":s[6]||(s[6]=g=>d(a).status=g),options:k,placeholder:"Select status",class:"mt-1",required:""},null,8,["modelValue"]),o(C,{message:d(a).errors.status},null,8,["message"])]),e("div",null,[o(w,{for:"delivery_fee"},{default:i(()=>s[19]||(s[19]=[m("Delivery Fee")])),_:1,__:[19]}),F(e("input",{"onUpdate:modelValue":s[7]||(s[7]=g=>d(a).delivery_fee=g),type:"number",id:"delivery_fee",min:"0",step:"0.01",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",placeholder:"0.00",required:""},null,512),[[I,d(a).delivery_fee]]),o(C,{message:d(a).errors.delivery_fee},null,8,["message"])])]),e("div",null,[o(w,{for:"notes"},{default:i(()=>s[20]||(s[20]=[m("Notes")])),_:1,__:[20]}),F(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=g=>d(a).notes=g),id:"notes",class:"w-full rounded-md border border-input bg-transparent px-3 py-2 mt-1 text-foreground dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none",rows:"3",placeholder:"Enter any additional notes"},null,512),[[I,d(a).notes]]),o(C,{message:d(a).errors.notes},null,8,["message"])])]),D.value||d(a).delivery_address||(x=O.value)!=null&&x.address?(u(),p("div",Re,[o(w,{class:"mb-2 block"},{default:i(()=>s[21]||(s[21]=[m("Delivery Route")])),_:1,__:[21]}),o(ke,{"customer-location":D.value,"delivery-address":d(a).delivery_address||((R=O.value)==null?void 0:R.address),"map-height":"300px"},null,8,["customer-location","delivery-address"])])):f("",!0),o(d(ye),{class:"gap-2"},{default:i(()=>[o(d(h),{type:"button",variant:"ghost",onClick:H},{default:i(()=>s[22]||(s[22]=[m("Cancel")])),_:1,__:[22]}),o(d(h),{type:"submit",variant:"default",disabled:d(a).processing},{default:i(()=>s[23]||(s[23]=[m(" Create Delivery ")])),_:1,__:[23]},8,["disabled"])]),_:1})],32)]}),_:1})]),_:1},8,["open"]))}}),$e={key:0,class:"mb-4 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-md"},Me={class:"flex items-start"},Be={class:"ml-3 flex-1"},qe={class:"mt-2 text-sm text-blue-700"},Ve={class:"font-semibold"},Ae={class:"flex items-center justify-between my-6"},je={class:"text-2xl font-bold"},Ne={class:"flex gap-2"},Ue={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Fe={class:"lg:col-span-2 space-y-6"},Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={class:"text-lg font-semibold"},Ee={key:0},Oe={key:1},Xe={key:0,class:"text-xs font-normal text-green-600 ml-2"},ze={key:2},Le={key:3},We={key:0,class:"mt-4"},Qe={class:"mt-1"},He={class:"overflow-x-auto"},Je={class:"min-w-full divide-y divide-border"},Ke={class:"px-4 py-2"},Ye={class:"font-medium"},Ge={class:"text-sm text-gray-500"},Ze={class:"px-4 py-2"},et={class:"px-4 py-2"},tt={class:"px-4 py-2 font-medium"},st={class:"border-t"},nt={class:"px-4 py-2 font-medium"},ot={colspan:"3",class:"px-4 py-2 text-right font-medium"},lt={class:"px-4 py-2 font-medium"},it={class:"border-t"},rt={class:"px-4 py-2 font-bold text-lg"},dt={key:0,class:"border-t bg-yellow-50"},at={class:"px-4 py-2 font-medium text-orange-700"},ut={key:1,class:"border-t-2 border-blue-500 bg-blue-50"},mt={colspan:"3",class:"px-4 py-2 text-right font-bold text-lg text-blue-700"},ct={class:"flex items-center justify-end gap-2"},pt={key:0},ft={key:1},_t={class:"px-4 py-2 font-bold text-lg text-blue-700"},vt={class:"space-y-6"},gt={class:"flex justify-between items-center"},yt={class:"font-medium"},xt={class:"flex justify-between items-center"},bt={class:"font-medium text-orange-600"},kt={class:"border-t pt-3 mt-3"},wt={class:"flex justify-between items-center"},ht={key:0,class:"mt-2 text-xs text-green-600 flex items-center gap-1"},Pt={class:"space-y-3"},Ct={class:"flex items-center justify-between mb-2"},Dt={class:"font-medium"},Rt={class:"text-sm text-gray-600 space-y-1"},St={key:0},$t={key:1},Mt={class:"text-xs mt-0.5"},Bt={key:2},qt={key:3},Vt={key:4},At={key:5,class:"mt-2 pt-2 border-t"},jt={class:"text-xs mt-0.5"},Nt={key:6,class:"text-xs text-gray-500 mt-2"},Ut={key:7,class:"mt-2 pt-2 border-t"},Ft={class:"space-y-3"},It={class:"flex items-center justify-between"},Tt={class:"font-medium"},Et={class:"text-sm text-gray-600"},Ot={key:0},Xt={class:"text-xs text-gray-500"},zt={key:1,class:"mt-1 text-xs text-red-500"},Lt={key:2,class:"text-xs"},Wt=["href"],Qt={class:"space-y-3"},Ht={class:"flex items-center justify-between"},Jt={class:"font-medium"},Kt={class:"text-sm text-gray-600"},Yt={key:0},Gt={class:"text-xs text-gray-500"},Zt={class:"space-y-3"},es={class:"flex items-center gap-3"},ts={class:"font-medium"},ss={key:0},ns={key:1},os={key:2},ls={class:"text-sm"},is={class:"mt-3"},rs={class:"text-sm"},Us=se({__name:"Show",props:{invoice:{},refunds:{},refundRequests:{},deliveries:{},customers:{},netBalance:{},totalRefunded:{}},setup(W){var G,Z;const n=W,v=ie(),q=Array.isArray((G=v.props.auth)==null?void 0:G.userRoles)&&v.props.auth.userRoles.includes("Customer"),a=Array.isArray((Z=v.props.auth)==null?void 0:Z.userRoles)&&v.props.auth.userRoles.includes("Staff"),Q=P(()=>Array.isArray(n.refundRequests)&&n.refundRequests.some(c=>c.status==="pending")),j=P(()=>{var c;return a&&((c=n.invoice.customer)==null?void 0:c.email)&&n.invoice.payment_status!=="paid"}),V=ee(!1),k=P(()=>n.netBalance!==void 0?n.netBalance:n.invoice.total_amount),N=P(()=>n.totalRefunded!==void 0?n.totalRefunded:0),D=P(()=>N.value>0),O=P(()=>D.value&&Math.abs(k.value-n.invoice.total_amount)>.01),U=P(()=>n.invoice.payment_method==="credit"),H=[{title:"Invoices",href:"/invoices"},{title:n.invoice.reference_number,href:`/invoices/${n.invoice.id}`}];function X(c){switch(c){case"draft":return"bg-gray-100 text-gray-800";case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function z(c){switch(c){case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function y(c){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(c)}function _(c){return new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function s(c){return new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function x(){window.print()}function R(c){if(!c.media||c.media.length===0)return null;const t=c.media.find(l=>l.mime_type.startsWith("image/"));return t?t.thumb_url||t.original_url:null}function g(c){return c.name.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().slice(0,2)}const J=ee(!1);function ne(){!j.value||V.value||(V.value=!0,de.post(route("invoices.sendPaymentReminder",n.invoice.id),{},{preserveScroll:!0,onSuccess:()=>{const c=v.props.flash;c!=null&&c.success&&E.fire({toast:!0,position:"top-end",icon:"success",title:c.success,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},onError:c=>{const t=v.props.flash,l=(t==null?void 0:t.error)||"Failed to send payment reminder. Please try again.";E.fire({toast:!0,position:"top-end",icon:"error",title:l,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},onFinish:()=>{V.value=!1}}))}return Y(()=>v.props.flash,c=>{c!=null&&c.success?E.fire({toast:!0,position:"top-end",icon:"success",title:c.success,showConfirmButton:!1,timer:3e3,timerProgressBar:!0}):c!=null&&c.error&&E.fire({toast:!0,position:"top-end",icon:"error",title:c.error,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}),(c,t)=>(u(),b(ce,{breadcrumbs:H},{default:i(()=>[o(d(re),{title:n.invoice.reference_number},null,8,["title"]),O.value&&U.value?(u(),p("div",$e,[e("div",Me,[t[7]||(t[7]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Be,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-blue-800"},"Credit Invoice with Refunds",-1)),e("div",qe,[e("p",null,[t[2]||(t[2]=m(" Original invoice amount: ")),e("strong",null,r(y(n.invoice.total_amount)),1),t[3]||(t[3]=e("br",null,null,-1)),t[4]||(t[4]=m(" Total refunded: ")),e("strong",null,r(y(N.value)),1),t[5]||(t[5]=e("br",null,null,-1)),e("span",Ve,"Amount Due: "+r(y(k.value)),1)])])])])])):f("",!0),e("div",Ae,[e("h1",je,r(n.invoice.reference_number),1),e("div",Ne,[o(d(h),{variant:"outline",onClick:x},{default:i(()=>t[8]||(t[8]=[m("Download PDF")])),_:1,__:[8]}),o(d(h),{variant:"outline",onClick:x},{default:i(()=>t[9]||(t[9]=[m("Print")])),_:1,__:[9]}),j.value?(u(),b(d(h),{key:0,variant:"default",onClick:ne,disabled:V.value},{default:i(()=>[m(r(V.value?"Sending...":"Send Payment Reminder"),1)]),_:1},8,["disabled"])):f("",!0),!d(q)&&n.invoice.status!=="completed"?(u(),b(d(h),{key:1,variant:"default",onClick:t[0]||(t[0]=l=>J.value=!0)},{default:i(()=>t[10]||(t[10]=[m("Out for Delivery")])),_:1,__:[10]})):f("",!0),d(q)&&n.invoice.status==="completed"?(u(),p(T,{key:2},[Q.value?(u(),b(d(h),{key:1,variant:"outline",disabled:"",title:"You already have a pending refund request for this invoice."},{default:i(()=>t[12]||(t[12]=[m(" Request Pending ")])),_:1,__:[12]})):(u(),b(d(K),{key:0,href:c.route("refundRequests.create",n.invoice.id)},{default:i(()=>[o(d(h),{variant:"default"},{default:i(()=>t[11]||(t[11]=[m("Request Refund")])),_:1,__:[11]})]),_:1},8,["href"]))],64)):f("",!0),o(d(K),{href:c.route("invoices.index")},{default:i(()=>[o(d(h),{variant:"ghost"},{default:i(()=>t[13]||(t[13]=[m("Back")])),_:1,__:[13]})]),_:1},8,["href"])])]),e("div",Ue,[e("div",Fe,[o(S,null,{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[14]||(t[14]=[m("Invoice Information")])),_:1,__:[14]})]),_:1}),o($,null,{default:i(()=>[e("div",Ie,[e("div",null,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-gray-500"},"Reference Number",-1)),e("p",Te,r(n.invoice.reference_number),1)]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-gray-500"},"Date Created",-1)),e("p",null,r(_(n.invoice.created_at)),1)]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),e("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",X(n.invoice.status)])},r(n.invoice.status),3)]),e("div",null,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Method",-1)),e("p",null,r(n.invoice.payment_method.replace("_"," ")),1)]),n.invoice.payment_status?(u(),p("div",Ee,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Status",-1)),e("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",n.invoice.payment_status==="paid"?"bg-green-100 text-green-800":n.invoice.payment_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},r(n.invoice.payment_status),3)])):f("",!0),D.value&&U.value?(u(),p("div",Oe,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-gray-500"},"Amount Due",-1)),e("p",{class:A(["font-semibold text-lg",k.value<=0?"text-green-600":"text-orange-600"])},[m(r(y(k.value))+" ",1),k.value<=0?(u(),p("span",Xe,"(Fully Settled)")):f("",!0)],2)])):f("",!0),n.invoice.due_date?(u(),p("div",ze,[t[21]||(t[21]=e("label",{class:"text-sm font-medium text-gray-500"},"Due Date",-1)),e("p",null,r(s(n.invoice.due_date)),1)])):f("",!0),n.invoice.payment_reference?(u(),p("div",Le,[t[22]||(t[22]=e("label",{class:"text-sm font-medium text-gray-500"},"Payment Reference",-1)),e("p",null,r(n.invoice.payment_reference),1)])):f("",!0)]),n.invoice.notes?(u(),p("div",We,[t[23]||(t[23]=e("label",{class:"text-sm font-medium text-gray-500"},"Notes",-1)),e("p",Qe,r(n.invoice.notes),1)])):f("",!0)]),_:1})]),_:1}),o(S,null,{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[24]||(t[24]=[m("Invoice Items")])),_:1,__:[24]})]),_:1}),o($,null,{default:i(()=>[e("div",He,[e("table",Je,[t[29]||(t[29]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Product"),e("th",{class:"px-4 py-2 text-left"},"Quantity"),e("th",{class:"px-4 py-2 text-left"},"Price"),e("th",{class:"px-4 py-2 text-left"},"Total")])],-1)),e("tbody",null,[(u(!0),p(T,null,L(n.invoice.invoice_items,l=>(u(),p("tr",{key:l.id,class:"hover:bg-muted"},[e("td",Ke,[e("div",null,[e("div",Ye,r(l.product.name),1),e("div",Ge,"SKU: "+r(l.product.id),1)])]),e("td",Ze,r(l.quantity),1),e("td",et,r(y(l.price)),1),e("td",tt,r(y(l.total)),1)]))),128))]),e("tfoot",null,[e("tr",st,[t[25]||(t[25]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-medium"},"Subtotal:",-1)),e("td",nt,r(y(n.invoice.subtotal_amount)),1)]),e("tr",null,[e("td",ot,"VAT ("+r(n.invoice.vat_rate)+"%):",1),e("td",lt,r(y(n.invoice.vat_amount)),1)]),e("tr",it,[t[26]||(t[26]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-bold text-lg"},"Total Amount:",-1)),e("td",rt,r(y(n.invoice.total_amount)),1)]),D.value?(u(),p("tr",dt,[t[27]||(t[27]=e("td",{colspan:"3",class:"px-4 py-2 text-right font-medium text-orange-700"},[e("div",{class:"flex items-center justify-end gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),m(" Total Refunded: ")])],-1)),e("td",at,"-"+r(y(N.value)),1)])):f("",!0),D.value?(u(),p("tr",ut,[e("td",mt,[e("div",ct,[t[28]||(t[28]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),U.value?(u(),p("span",pt,"Amount Due:")):(u(),p("span",ft,"Net Balance:"))])]),e("td",_t,r(y(k.value)),1)])):f("",!0)])])])]),_:1})]),_:1})]),e("div",vt,[D.value&&U.value?(u(),b(S,{key:0,class:"border-blue-200 bg-blue-50"},{default:i(()=>[o(M,null,{default:i(()=>[o(B,{class:"text-blue-800"},{default:i(()=>t[30]||(t[30]=[m("Payment Summary")])),_:1,__:[30]})]),_:1}),o($,{class:"space-y-3"},{default:i(()=>[e("div",gt,[t[31]||(t[31]=e("span",{class:"text-sm text-gray-600"},"Original Amount:",-1)),e("span",yt,r(y(n.invoice.total_amount)),1)]),e("div",xt,[t[32]||(t[32]=e("span",{class:"text-sm text-gray-600"},"Total Refunded:",-1)),e("span",bt,"-"+r(y(N.value)),1)]),e("div",kt,[e("div",wt,[t[33]||(t[33]=e("span",{class:"text-sm font-semibold text-blue-800"},"Amount Due:",-1)),e("span",{class:A(["text-lg font-bold",k.value<=0?"text-green-600":"text-blue-700"])},r(y(k.value)),3)]),k.value<=0?(u(),p("div",ht,t[34]||(t[34]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),m(" Fully settled ")]))):f("",!0)])]),_:1})]),_:1})):f("",!0),n.deliveries&&n.deliveries.length?(u(),b(S,{key:1},{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[35]||(t[35]=[m("Deliveries")])),_:1,__:[35]})]),_:1}),o($,null,{default:i(()=>[e("div",Pt,[(u(!0),p(T,null,L(n.deliveries,l=>(u(),p("div",{key:l.id,class:"border rounded-md p-3"},[e("div",Ct,[e("div",Dt,"Delivery #"+r(l.id),1),e("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",z(l.status)])},r(l.status),3)]),e("div",Rt,[l.delivery_date?(u(),p("div",St,[t[36]||(t[36]=e("span",{class:"font-medium"},"Date:",-1)),m(" "+r(l.delivery_date),1)])):f("",!0),l.delivery_time?(u(),p("div",$t,[t[37]||(t[37]=e("span",{class:"font-medium"},"Time:",-1)),m(" "+r(l.delivery_time),1)])):f("",!0),e("div",null,[t[38]||(t[38]=e("span",{class:"font-medium"},"Address:",-1)),e("p",Mt,r(l.delivery_address),1)]),l.contact_person?(u(),p("div",Bt,[t[39]||(t[39]=e("span",{class:"font-medium"},"Contact:",-1)),m(" "+r(l.contact_person),1)])):f("",!0),l.contact_phone?(u(),p("div",qt,[t[40]||(t[40]=e("span",{class:"font-medium"},"Phone:",-1)),m(" "+r(l.contact_phone),1)])):f("",!0),l.delivery_fee>0?(u(),p("div",Vt,[t[41]||(t[41]=e("span",{class:"font-medium"},"Fee:",-1)),m(" "+r(y(l.delivery_fee)),1)])):f("",!0),l.notes?(u(),p("div",At,[t[42]||(t[42]=e("span",{class:"font-medium"},"Notes:",-1)),e("p",jt,r(l.notes),1)])):f("",!0),l.created_at?(u(),p("div",Nt," Created: "+r(l.created_at),1)):f("",!0),d(q)?f("",!0):(u(),p("div",Ut,[o(d(K),{href:c.route("deliveries.show",l.id)},{default:i(()=>[o(d(h),{variant:"outline",size:"sm",class:"w-full"},{default:i(()=>t[43]||(t[43]=[m(" View Delivery Details ")])),_:1,__:[43]})]),_:2},1032,["href"])]))])]))),128))])]),_:1})]),_:1})):f("",!0),n.refundRequests&&n.refundRequests.length?(u(),b(S,{key:2},{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[44]||(t[44]=[m("Refund Requests")])),_:1,__:[44]})]),_:1}),o($,null,{default:i(()=>[e("div",Ft,[(u(!0),p(T,null,L(n.refundRequests,l=>(u(),p("div",{key:l.id,class:"border rounded-md p-3"},[e("div",It,[e("div",Tt,r(l.tracking_number),1),e("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":l.status==="pending","bg-green-100 text-green-800":l.status==="approved"||l.status==="converted","bg-red-100 text-red-800":l.status==="rejected"}])},r(l.status),3)]),e("div",Et,[l.product_name?(u(),p("div",Ot,"Product: "+r(l.product_name),1)):f("",!0),e("div",null,"Qty: "+r(l.quantity),1),e("div",Xt,"Date: "+r(l.created_at),1),l.status==="rejected"&&l.review_notes?(u(),p("div",zt," Reason: "+r(l.review_notes),1)):f("",!0),l.media_link?(u(),p("div",Lt,[e("a",{href:l.media_link,target:"_blank",class:"text-blue-500 underline"},"Media",8,Wt)])):f("",!0)])]))),128))])]),_:1})]),_:1})):f("",!0),n.refunds&&n.refunds.length?(u(),b(S,{key:3},{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[45]||(t[45]=[m("Refunds")])),_:1,__:[45]})]),_:1}),o($,null,{default:i(()=>[e("div",Qt,[(u(!0),p(T,null,L(n.refunds,l=>(u(),p("div",{key:l.id,class:"border rounded-md p-3"},[e("div",Ht,[e("div",Jt,r(l.refund_number),1),e("span",{class:A(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":l.status==="approved"||l.status==="completed","bg-yellow-100 text-yellow-800":l.status==="pending","bg-red-100 text-red-800":l.status==="cancelled"}])},r(l.status),3)]),e("div",Kt,[l.product_name?(u(),p("div",Yt,"Product: "+r(l.product_name),1)):f("",!0),e("div",null,"Qty: "+r(l.quantity_refunded),1),e("div",null,"Amount: "+r(y(l.refund_amount)),1),e("div",Gt,"Date: "+r(l.created_at),1)])]))),128))])]),_:1})]),_:1})):f("",!0),o(S,null,{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[46]||(t[46]=[m("Customer Information")])),_:1,__:[46]})]),_:1}),o($,null,{default:i(()=>[e("div",Zt,[e("div",es,[o(ae,{class:"size-12"},{default:i(()=>[R(n.invoice.customer)?(u(),b(ue,{key:0,src:R(n.invoice.customer),alt:n.invoice.customer.name},null,8,["src","alt"])):(u(),b(me,{key:1},{default:i(()=>[m(r(g(n.invoice.customer)),1)]),_:1}))]),_:1}),e("div",null,[t[47]||(t[47]=e("label",{class:"text-sm font-medium text-gray-500"},"Name",-1)),e("p",ts,r(n.invoice.customer.name),1)])]),n.invoice.customer.company_name?(u(),p("div",ss,[t[48]||(t[48]=e("label",{class:"text-sm font-medium text-gray-500"},"Company",-1)),e("p",null,r(n.invoice.customer.company_name),1)])):f("",!0),e("div",null,[t[49]||(t[49]=e("label",{class:"text-sm font-medium text-gray-500"},"Email",-1)),e("p",null,r(n.invoice.customer.email),1)]),n.invoice.customer.phone?(u(),p("div",ns,[t[50]||(t[50]=e("label",{class:"text-sm font-medium text-gray-500"},"Phone",-1)),e("p",null,r(n.invoice.customer.phone),1)])):f("",!0),n.invoice.customer.address?(u(),p("div",os,[t[51]||(t[51]=e("label",{class:"text-sm font-medium text-gray-500"},"Address",-1)),e("p",ls,r(n.invoice.customer.address),1)])):f("",!0)])]),_:1})]),_:1}),o(S,null,{default:i(()=>[o(M,null,{default:i(()=>[o(B,null,{default:i(()=>t[52]||(t[52]=[m("Created By")])),_:1,__:[52]})]),_:1}),o($,null,{default:i(()=>[e("div",null,[t[53]||(t[53]=e("label",{class:"text-sm font-medium text-gray-500"},"User",-1)),e("p",null,r(n.invoice.user.name),1)]),e("div",is,[t[54]||(t[54]=e("label",{class:"text-sm font-medium text-gray-500"},"Last Updated",-1)),e("p",rs,r(_(n.invoice.updated_at)),1)])]),_:1})]),_:1})])]),n.customers?(u(),b(Se,{key:1,open:J.value,"onUpdate:open":t[1]||(t[1]=l=>J.value=l),invoice:n.invoice,customers:n.customers},null,8,["open","invoice","customers"])):f("",!0)]),_:1}))}});export{Us as default};
