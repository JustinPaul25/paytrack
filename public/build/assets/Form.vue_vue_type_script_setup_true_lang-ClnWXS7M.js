import{d as C,D as S,f as V,o as h,b as o,a as l,w as r,e as m,u as a,A as B,B as F,h as $,k as j,t as D,q as M}from"./app-Cwu7HoSd.js";import{_ as u}from"./InputError.vue_vue_type_script_setup_true_lang-BULHRL9y.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-BMHPrx55.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-B7Gi-sP6.js";import{_ as L}from"./index-BdY75aZ2.js";import{_ as W}from"./CardFooter.vue_vue_type_script_setup_true_lang-Da1iX7RO.js";import{L as k}from"./LocationInput-Bnwli0r1.js";const A={class:"flex gap-4"},G={class:"flex-1"},T={class:"flex gap-4"},q={class:"flex-1"},z={class:"flex gap-4"},J={class:"flex-1"},E={class:"flex gap-4"},O={class:"flex-1"},H={class:"flex gap-4"},K={class:"flex-1"},Q={class:"flex gap-4"},R={class:"flex-1"},Y={class:"flex gap-4"},Z={class:"flex-1"},ee={key:0,class:"mt-2"},te=["src"],me=C({__name:"Form",props:{customer:Object,profileImageUrl:String},setup(g){var c,_,x,X,v,y;const n=g,b=()=>{var i;if((i=n.customer)!=null&&i.location){const e=n.customer.location;if(typeof e=="string")try{return JSON.parse(e)}catch{return{lat:0,lng:0}}else if(typeof e=="object"&&e!==null){const t=parseFloat(e.lat),p=parseFloat(e.lng);if(!isNaN(t)&&!isNaN(p))return{lat:t,lng:p}}}return{lat:0,lng:0}},s=S({name:((c=n.customer)==null?void 0:c.name)||"",company_name:((_=n.customer)==null?void 0:_.company_name)||"",email:((x=n.customer)==null?void 0:x.email)||"",phone:((X=n.customer)==null?void 0:X.phone)||"",address:((v=n.customer)==null?void 0:v.address)||"",profile_image:null,customerId:((y=n.customer)==null?void 0:y.id)||null,location:b()});function I(i){const e=i.target;if(e.files&&e.files.length>0){const t=e.files[0],p=["image/jpeg","image/png"].includes(t.type),P=t.size<=2*1024*1024;if(!p||!P){s.profile_image=null,e.value="";const U=p?"File is too large. Max size is 2MB.":"Please select a JPG or PNG image.";window.alert(U);return}s.profile_image=t}else s.profile_image=null}function N(i){const e=i.target;let t=e.value;t=t.replace(/[^0-9+]/g,""),t.startsWith("+")?(t.length>1&&!t.startsWith("+63")&&(t="+63"+t.substring(1).replace(/[^0-9]/g,"")),t.length>13&&(t=t.substring(0,13))):(t.length>0&&t[0]==="0"&&t.length>1&&t[1]!=="9"&&(t="09"+t.substring(2).replace(/[^0-9]/g,"")),t.startsWith("63")&&(t="+"+t),t.length>11&&!t.startsWith("+")&&(t=t.substring(0,11))),t!==e.value&&(e.value=t),s.phone=t}function w(){s.customerId?s.post(route("customers.update",s.customerId),{forceFormData:!0,onSuccess:()=>s.reset("profile_image")}):s.post(route("customers.store"),{forceFormData:!0,onSuccess:()=>s.reset("profile_image")})}return(i,e)=>(h(),V("form",{onSubmit:M(w,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[o("div",A,[o("div",G,[l(d,{for:"name"},{default:r(()=>e[6]||(e[6]=[m("Full name")])),_:1,__:[6]}),l(f,{id:"name",modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).name=t),placeholder:"e.g., Aisha Bello",required:""},null,8,["modelValue"]),e[7]||(e[7]=o("p",{class:"text-xs text-muted-foreground mt-1"},"This is the customer’s name.",-1)),l(u,{message:a(s).errors.name},null,8,["message"])])]),o("div",T,[o("div",q,[l(d,{for:"company_name"},{default:r(()=>e[8]||(e[8]=[m("Company (optional)")])),_:1,__:[8]}),l(f,{id:"company_name",modelValue:a(s).company_name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).company_name=t),placeholder:"e.g., Bright Ventures Ltd."},null,8,["modelValue"]),e[9]||(e[9]=o("p",{class:"text-xs text-muted-foreground mt-1"},"Add if this customer represents a company.",-1)),l(u,{message:a(s).errors.company_name},null,8,["message"])])]),o("div",z,[o("div",J,[l(d,{for:"email"},{default:r(()=>e[10]||(e[10]=[m("Email address")])),_:1,__:[10]}),l(f,{id:"email",modelValue:a(s).email,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).email=t),type:"email",placeholder:"name@company.com",required:""},null,8,["modelValue"]),e[11]||(e[11]=o("p",{class:"text-xs text-muted-foreground mt-1"},"We’ll use this to send receipts.",-1)),l(u,{message:a(s).errors.email},null,8,["message"])])]),o("div",E,[o("div",O,[l(d,{for:"phone"},{default:r(()=>e[12]||(e[12]=[m("Phone number (optional)")])),_:1,__:[12]}),l(f,{id:"phone",modelValue:a(s).phone,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).phone=t),placeholder:"09XXXXXXXXX or +639XXXXXXXXX",inputmode:"tel",pattern:"^(?:\\+?63|0)9\\d{9}$",maxlength:"13",onInput:N},null,8,["modelValue"]),e[13]||(e[13]=o("p",{class:"text-xs text-muted-foreground mt-1"},"Philippine mobile number format only (09XXXXXXXXX or +639XXXXXXXXX).",-1)),l(u,{message:a(s).errors.phone},null,8,["message"])])]),o("div",H,[o("div",K,[l(d,{for:"address"},{default:r(()=>e[14]||(e[14]=[m("Address")])),_:1,__:[14]}),B(o("textarea",{id:"address","onUpdate:modelValue":e[4]||(e[4]=t=>a(s).address=t),placeholder:"Street, city, state",class:"w-full rounded border px-3 py-2 mt-1",rows:"3"},null,512),[[F,a(s).address]]),e[15]||(e[15]=o("p",{class:"text-xs text-muted-foreground mt-1"},"Helps with delivery and invoices.",-1)),l(u,{message:a(s).errors.address},null,8,["message"])])]),o("div",Q,[o("div",R,[l(d,{for:"location"},{default:r(()=>e[16]||(e[16]=[m("Location")])),_:1,__:[16]}),l(k,{modelValue:a(s).location,"onUpdate:modelValue":e[5]||(e[5]=t=>a(s).location=t)},null,8,["modelValue"])])]),o("div",Y,[o("div",Z,[l(d,{for:"profile_image"},{default:r(()=>e[17]||(e[17]=[m("Profile picture (optional)")])),_:1,__:[17]}),l(f,{id:"profile_image",type:"file",accept:"image/jpeg,image/png",onChange:I}),e[18]||(e[18]=o("p",{class:"text-xs text-muted-foreground mt-1"},"Max 2MB, JPG or PNG.",-1)),l(u,{message:a(s).errors.profile_image},null,8,["message"]),g.profileImageUrl?(h(),V("div",ee,[o("img",{src:g.profileImageUrl,alt:"Profile Image",class:"w-24 h-24 object-cover rounded-full"},null,8,te)])):$("",!0)])]),l(W,{class:"flex gap-2 justify-end"},{default:r(()=>[l(a(L),{type:"submit",variant:"default"},{default:r(()=>[m(D(a(s).customerId?"Update Customer":"Create Customer"),1)]),_:1}),j(i.$slots,"footer")]),_:3})],32))}});export{me as _};
